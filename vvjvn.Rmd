---
title: ''
author: ''
date: ''
output:
  pdf_document:
    latex_engine: xelatex
    toc: false
    toc_depth: 3
    number_sections: false
    fig_caption: true
    keep_tex: true
  html_document: default
  word_document:
    toc: false
    toc_depth: '3'
header-includes:
- \renewcommand{\contentsname}{Má»¤C Lá»¤C}
- \usepackage{graphicx}
- \usepackage{fontspec}
- \usepackage{tikz}
- \usepackage{geometry}
- \geometry{a4paper, margin=2.5cm}
- \setmainfont{Times New Roman}
- \usetikzlibrary{calc}
- \usepackage{caption}
- \captionsetup[figure]{name=HÃ¬nh}
bibliography: osds.bib
csl: ieee.csl
---
```{=latex}
\begin{titlepage}
\begin{center}

\vspace*{-2cm}

\begin{tikzpicture}[remember picture, overlay]
  \draw[line width=0.8pt]
    ($(current page.north west) + (1.5cm,-1.5cm)$)
    rectangle
    ($(current page.south east) + (-1.5cm,1.5cm)$);
\end{tikzpicture}


\noindent
\begin{minipage}{0.3\textwidth}
\includegraphics[width=\linewidth]{images/logo_final.png}
\end{minipage}
\hfill
\begin{minipage}{0.65\textwidth}
\centering
\textbf{Bá»˜ GIÃO Dá»¤C VÃ€ ÄÃ€O Táº O}\\[0.2cm]
\textbf{TRÆ¯á»œNG Äáº I Há»ŒC CÃ”NG NGHá»† TP.HCM}
\end{minipage}

\vfill 


\begin{center}

\textbf{\Large Äá»’ ÃN MÃ”N Há»ŒC}\\[1cm]

\textbf{\large \uppercase{á»¨NG Dá»¤NG RFM, K-MEANS VÃ€ DBSCAN TRONG}}\\
\textbf{\large \uppercase{PHÃ‚N KHÃšC KHÃCH HÃ€NG VÃ€ Tá»I Æ¯U DOANH THU}}\\[1.2cm]

\begin{flushleft}
\textbf{NgÃ nh:} \textbf{KHOA Há»ŒC Dá»® LIá»†U}\\
\textbf{MÃ´n há»c:} \textbf{PHÃ‚N TÃCH VÃ€ TRá»°C QUAN Dá»® LIá»†U}\\[1cm]

\textbf{Giáº£ng viÃªn hÆ°á»›ng dáº«n:} \textbf{LÃŠ NHáº¬T TÃ™NG}\\
\textbf{Sinh viÃªn thá»±c hiá»‡n:}
\end{flushleft}

\vspace{0.3cm}

\begin{tabular}{ll}
Nguyá»…n Nháº­t Nam      & MSSV: 2286400019 \\
HoÃ ng Quang Minh     & MSSV: 2286400017 \\
HÃ  Tháº¿ Anh           & MSSV: 2286400002 \\
\end{tabular}

\vspace{0.5cm}

\textbf{Lá»›p:} \textbf{22DKHA1}

\end{center}

\vfill


\begin{center}
TP. Há»“ ChÃ­ Minh, 2025
\end{center}

\end{center}
\end{titlepage}
```

\newpage
\tableofcontents
\newpage


\newpage

\section*{Lá»œI CAM ÄOAN}

ChÃºng tÃ´i, HoÃ ng Quang Minh, Nguyá»…n Nháº­t Nam vÃ  HÃ  Tháº¿ Anh xin cam Ä‘oan ráº±ng:

Má»i thÃ´ng tin vÃ  nghiÃªn cá»©u Ä‘Æ°á»£c trÃ¬nh bÃ y trong bÃ i bÃ¡o cÃ¡o nÃ y lÃ  trung thá»±c vÃ  khÃ¡ch quan Ä‘Æ°á»£c thu tháº­p vÃ  phÃ¢n tÃ­ch má»™t cÃ¡ch cáº©n tháº­n dá»±a trÃªn cÃ¡c nguá»“n chÃ­nh thá»‘ng vÃ  Ä‘Ã¡ng tin cáº­y.

Báº¥t ká»³ thÃ´ng tin hoáº·c Ã½ kiáº¿n nÃ o Ä‘Æ°á»£c trÃ­ch dáº«n tá»« cÃ¡c nguá»“n khÃ¡c Ä‘á»u Ä‘Æ°á»£c nÃªu rÃµ nguá»“n gá»‘c vÃ  Ä‘Æ°á»£c trÃ­ch dáº«n theo Ä‘Ãºng quy Ä‘á»‹nh. ChÃºng tÃ´i xin cam Ä‘oan ráº±ng khÃ´ng cÃ³ báº¥t ká»³ sá»± sao chÃ©p hoáº·c sá»­ dá»¥ng thÃ´ng tin khÃ´ng Ä‘Ãºng Ä‘áº¯n nÃ o tá»« cÃ¡c nguá»“n khÃ¡c.

BÃ i bÃ¡o cÃ¡o nÃ y lÃ  cÃ´ng trÃ¬nh nghiÃªn cá»©u Ä‘á»™c láº­p cá»§a chÃºng tÃ´i chÆ°a tá»«ng Ä‘Æ°á»£c cÃ´ng bá»‘ á»Ÿ báº¥t ká»³ nÆ¡i nÃ o khÃ¡c. TÃ´i cam Ä‘oan ráº±ng Ä‘Ã£ tuÃ¢n thá»§ Ä‘áº§y Ä‘á»§ cÃ¡c quy táº¯c vÃ  quy Ä‘á»‹nh cá»§a mÃ´n há»c bao gá»“m cáº£ viá»‡c tham kháº£o vÃ  sá»­ dá»¥ng cÃ´ng cá»¥ nghiÃªn cá»©u.

TÃ´i hy vá»ng ráº±ng bÃ i bÃ¡o cÃ¡o nÃ y sáº½ cung cáº¥p má»™t cÃ¡i nhÃ¬n tá»•ng quan rÃµ rÃ ng vÃ  toÃ n diá»‡n vá» chá»§ Ä‘á» â€œá»¨ng dá»¥ng RFM,K - Means vÃ  DBSCAN trong phÃ¢n khÃºc khÃ¡ch hÃ ng vÃ  tá»‘i Æ°u hÃ³a doanh thu" vÃ  sáº½ Ä‘Ã³ng gÃ³p má»™t pháº§n nhá» vÃ o lÄ©nh vá»±c nghiÃªn cá»©u nÃ y.

\vspace{1.5cm}

\begin{flushright}
TP. Há»“ ChÃ­ Minh, ngÃ y 15 thÃ¡ng 4 nÄƒm 2025\\[0.3cm]
Sinh viÃªn\\[0.8cm]
HoÃ ng Quang Minh\\
Nguyá»…n Nháº­t Nam\\
HÃ  Tháº¿ Anh
\end{flushright}



\newpage
 
# **CHÆ¯Æ NG 1: Tá»”NG QUAN**

## 1.1. Giá»›i thiá»‡u Ä‘á» tÃ i

Trong bá»‘i cáº£nh cáº¡nh tranh ngÃ y cÃ ng khá»‘c liá»‡t, viá»‡c tháº¥u hiá»ƒu khÃ¡ch hÃ ng trá»Ÿ thÃ nh yáº¿u tá»‘ then chá»‘t giÃºp doanh nghiá»‡p duy trÃ¬ vÃ  phÃ¡t triá»ƒn má»‘i quan há»‡ lÃ¢u dÃ i. Má»™t trong nhá»¯ng cÃ´ng cá»¥ hiá»‡u quáº£ Ä‘á»ƒ thá»±c hiá»‡n Ä‘iá»u nÃ y lÃ  mÃ´ hÃ¬nh RFM â€“ viáº¿t táº¯t cá»§a Recency (Gáº§n Ä‘Ã¢y), Frequency (Táº§n suáº¥t), vÃ  Monetary (GiÃ¡ trá»‹ chi tiÃªu). MÃ´ hÃ¬nh RFM cho phÃ©p doanh nghiá»‡p Ä‘Ã¡nh giÃ¡ hÃ nh vi tiÃªu dÃ¹ng cá»§a khÃ¡ch hÃ ng dá»±a trÃªn ba yáº¿u tá»‘ cá»‘t lÃµi, tá»« Ä‘Ã³ thá»±c hiá»‡n phÃ¢n khÃºc khÃ¡ch hÃ ng má»™t cÃ¡ch trá»±c quan vÃ  cÃ³ cÄƒn cá»© dá»¯ liá»‡u.

Trong Ä‘á» tÃ i nÃ y, chÃºng tÃ´i á»©ng dá»¥ng mÃ´ hÃ¬nh RFM káº¿t há»£p vá»›i thuáº­t toÃ¡n phÃ¢n cá»¥m K-Means Ä‘á»ƒ phÃ¢n nhÃ³m khÃ¡ch hÃ ng trÃªn mÃ´i trÆ°á»ng ngÃ´n ngá»¯ R. Viá»‡c nÃ y khÃ´ng chá»‰ há»— trá»£ doanh nghiá»‡p xÃ¡c Ä‘á»‹nh nhÃ³m khÃ¡ch hÃ ng má»¥c tiÃªu mÃ  cÃ²n tá»‘i Æ°u hÃ³a chiáº¿n lÆ°á»£c tiáº¿p thá»‹, giá»¯ chÃ¢n khÃ¡ch hÃ ng vÃ  tÄƒng trÆ°á»Ÿng doanh thu. BÃ¡o cÃ¡o Ä‘Æ°á»£c thá»±c hiá»‡n trÃªn bá»™ dá»¯ liá»‡u giao dá»‹ch thá»±c táº¿, minh há»a quy trÃ¬nh tá»« tiá»n xá»­ lÃ½ dá»¯ liá»‡u, xÃ¢y dá»±ng thang Ä‘o RFM, Ä‘áº¿n trá»±c quan hÃ³a vÃ  phÃ¢n tÃ­ch káº¿t quáº£ phÃ¢n cá»¥m.

## 1.2. Nhiá»‡m vá»¥ cá»§a Ä‘á»“ Ã¡n

- **KhÃ¡m phÃ¡ vÃ  hiá»ƒu dá»¯ liá»‡u:**

  - Äá»c dá»¯ liá»‡u giao dá»‹ch tá»« file Excel.
  
  - TÃ¬m hiá»ƒu cáº¥u trÃºc dá»¯ liá»‡u, mÃ´ táº£ cÃ¡c biáº¿n vÃ  kiá»ƒm tra dá»¯ liá»‡u thiáº¿u.

- **Tiá»n xá»­ lÃ½ dá»¯ liá»‡u:**

  - LÃ m sáº¡ch dá»¯ liá»‡u: loáº¡i bá» báº£n ghi thiáº¿u mÃ£ khÃ¡ch hÃ ng hoáº·c sá»‘ lÆ°á»£ng Ã¢m.
  
  - Táº¡o biáº¿n má»›i nhÆ° "Tá»•ng chi tiÃªu" Ä‘á»ƒ phá»¥c vá»¥ cho bÆ°á»›c tÃ­nh RFM.

- **XÃ¢y dá»±ng mÃ´ hÃ¬nh RFM:**

  - TÃ­nh toÃ¡n ba chá»‰ sá»‘ RFM cho tá»«ng khÃ¡ch hÃ ng:
  
    - Recency: Sá»‘ ngÃ y ká»ƒ tá»« giao dá»‹ch gáº§n nháº¥t.
    
    - Frequency: Sá»‘ láº§n giao dá»‹ch.
    
    - Monetary: Tá»•ng giÃ¡ trá»‹ chi tiÃªu.
    
  - Táº¡o báº£ng tá»•ng há»£p RFM cho toÃ n bá»™ khÃ¡ch hÃ ng.

- **Chuáº©n hÃ³a dá»¯ liá»‡u vÃ  phÃ¢n cá»¥m:**

  - Chuáº©n hÃ³a cÃ¡c giÃ¡ trá»‹ RFM Ä‘á»ƒ Ä‘Æ°a vá» cÃ¹ng thang Ä‘o.
  
  - XÃ¡c Ä‘á»‹nh sá»‘ cá»¥m tá»‘i Æ°u báº±ng Elbow method vÃ  Silhouette score.
  
  - Ãp dá»¥ng thuáº­t toÃ¡n K-Means vÃ  DBScan Ä‘á»ƒ phÃ¢n cá»¥m khÃ¡ch hÃ ng.

- **Trá»±c quan hÃ³a vÃ  phÃ¢n tÃ­ch káº¿t quáº£:**

  - Váº½ biá»ƒu Ä‘á»“ Ä‘á»ƒ quan sÃ¡t sá»± phÃ¢n bá»‘ khÃ¡ch hÃ ng theo cá»¥m.
  
  - PhÃ¢n tÃ­ch Ä‘áº·c Ä‘iá»ƒm tá»«ng cá»¥m dá»±a trÃªn giÃ¡ trá»‹ trung bÃ¬nh cá»§a cÃ¡c chá»‰ sá»‘ RFM.
  
## 1.3. TÃ­nh cáº¥p thiáº¿t cá»§a Ä‘á» tÃ i

Trong bá»‘i cáº£nh thá»‹ trÆ°á»ng cáº¡nh tranh ngÃ y cÃ ng khá»‘c liá»‡t, viá»‡c tháº¥u hiá»ƒu hÃ nh vi khÃ¡ch hÃ ng khÃ´ng chá»‰ lÃ  lá»£i tháº¿ mÃ  cÃ²n lÃ  Ä‘iá»u kiá»‡n sá»‘ng cÃ²n Ä‘á»ƒ doanh nghiá»‡p duy trÃ¬ vÃ  phÃ¡t triá»ƒn. Thay vÃ¬ Ã¡p dá»¥ng cÃ¡c chiáº¿n lÆ°á»£c tiáº¿p thá»‹ Ä‘áº¡i trÃ , doanh nghiá»‡p hiá»‡n nay cÃ³ xu hÆ°á»›ng cÃ¡ nhÃ¢n hÃ³a tráº£i nghiá»‡m nháº±m tÄƒng má»©c Ä‘á»™ gáº¯n bÃ³ vÃ  giÃ¡ trá»‹ vÃ²ng Ä‘á»i khÃ¡ch hÃ ng.

Tuy nhiÃªn, khá»‘i lÆ°á»£ng dá»¯ liá»‡u khÃ¡ch hÃ ng ngÃ y cÃ ng lá»›n, Ä‘a dáº¡ng vÃ  phá»©c táº¡p, khiáº¿n cho cÃ¡c phÆ°Æ¡ng phÃ¡p phÃ¢n tÃ­ch truyá»n thá»‘ng khÃ´ng cÃ²n Ä‘Ã¡p á»©ng Ä‘Æ°á»£c nhu cáº§u khai thÃ¡c sÃ¢u. Viá»‡c á»©ng dá»¥ng mÃ´ hÃ¬nh RFM (Recency - Frequency - Monetary) káº¿t há»£p vá»›i thuáº­t toÃ¡n phÃ¢n cá»¥m K-Means vÃ  DBScan lÃ  má»™t giáº£i phÃ¡p phÃ¹ há»£p, giÃºp doanh nghiá»‡p phÃ¢n khÃºc khÃ¡ch hÃ ng má»™t cÃ¡ch khoa há»c vÃ  dá»±a trÃªn dá»¯ liá»‡u thá»±c tiá»…n.

Viá»‡c triá»ƒn khai Ä‘á» tÃ i trÃªn ná»n táº£ng R khÃ´ng chá»‰ táº­n dá»¥ng sá»©c máº¡nh phÃ¢n tÃ­ch dá»¯ liá»‡u vÃ  trá»±c quan hÃ³a mÃ  cÃ²n rÃ¨n luyá»‡n ká»¹ nÄƒng khai phÃ¡ dá»¯ liá»‡u â€“ má»™t nÄƒng lá»±c quan trá»ng trong thá»i Ä‘áº¡i chuyá»ƒn Ä‘á»•i sá»‘. Do Ä‘Ã³, viá»‡c thá»±c hiá»‡n Ä‘á» tÃ i "á»¨ng dá»¥ng RFM trong phÃ¢n khÃºc khÃ¡ch hÃ ng" mang tÃ­nh cáº¥p thiáº¿t vÃ  cÃ³ Ã½ nghÄ©a thá»±c tiá»…n cao trong hoáº¡t Ä‘á»™ng marketing hiá»‡n Ä‘áº¡i.

## 1.4. Má»¥c tiÃªu cá»§a Ä‘á» tÃ i

Äá» tÃ i hÆ°á»›ng Ä‘áº¿n viá»‡c á»©ng dá»¥ng mÃ´ hÃ¬nh RFM káº¿t há»£p vá»›i cÃ¡c thuáº­t toÃ¡n phÃ¢n cá»¥m Ä‘á»ƒ phÃ¢n loáº¡i khÃ¡ch hÃ ng dá»±a trÃªn hÃ nh vi mua sáº¯m, tá»« Ä‘Ã³ há»— trá»£ doanh nghiá»‡p trong viá»‡c xÃ¢y dá»±ng chiáº¿n lÆ°á»£c tiáº¿p thá»‹ hiá»‡u quáº£ hÆ¡n. Cá»¥ thá»ƒ, Ä‘á» tÃ i táº­p trung vÃ o cÃ¡c má»¥c tiÃªu sau:

- **XÃ¢y dá»±ng há»‡ thá»‘ng Ä‘Ã¡nh giÃ¡ hÃ nh vi khÃ¡ch hÃ ng** thÃ´ng qua ba chá»‰ sá»‘ RFM: Recency (gáº§n Ä‘Ã¢y), Frequency (táº§n suáº¥t), vÃ  Monetary (giÃ¡ trá»‹ chi tiÃªu).

- **PhÃ¢n cá»¥m khÃ¡ch hÃ ng má»™t cÃ¡ch khoa há»c** báº±ng thuáº­t toÃ¡n **K-Means** dá»±a trÃªn dá»¯ liá»‡u RFM Ä‘Ã£ Ä‘Æ°á»£c chuáº©n hÃ³a.
- **PhÃ¢n cá»¥m khÃ¡ch hÃ ng báº±ng thuáº­t toÃ¡n DBSCAN**, nháº±m khÃ¡m phÃ¡ cÃ¡c cá»¥m cÃ³ hÃ¬nh dáº¡ng báº¥t quy táº¯c vÃ  phÃ¡t hiá»‡n cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u báº¥t thÆ°á»ng (outlier) mÃ  K-Means cÃ³ thá»ƒ bá» sÃ³t.

- **So sÃ¡nh káº¿t quáº£ phÃ¢n cá»¥m giá»¯a K-Means vÃ  DBSCAN**, phÃ¢n tÃ­ch Ä‘iá»ƒm máº¡nh â€“ Ä‘iá»ƒm yáº¿u cá»§a tá»«ng phÆ°Æ¡ng phÃ¡p trong ngá»¯ cáº£nh dá»¯ liá»‡u RFM.

- **PhÃ¢n tÃ­ch Ä‘áº·c Ä‘iá»ƒm tá»«ng nhÃ³m khÃ¡ch hÃ ng**, tá»« Ä‘Ã³ rÃºt ra nháº­n Ä‘á»‹nh vá» giÃ¡ trá»‹ vÃ  hÃ nh vi cá»§a má»—i nhÃ³m.
- **Äá» xuáº¥t Ä‘á»‹nh hÆ°á»›ng á»©ng dá»¥ng káº¿t quáº£ phÃ¢n cá»¥m** vÃ o cÃ¡c hoáº¡t Ä‘á»™ng tiáº¿p thá»‹, chÄƒm sÃ³c vÃ  giá»¯ chÃ¢n khÃ¡ch hÃ ng, nhÆ° thiáº¿t káº¿ chÆ°Æ¡ng trÃ¬nh Æ°u Ä‘Ã£i cÃ¡ nhÃ¢n hÃ³a hoáº·c Æ°u tiÃªn táº­p trung vÃ o nhÃ³m khÃ¡ch hÃ ng cÃ³ giÃ¡ trá»‹ cao.

ThÃ´ng qua viá»‡c káº¿t há»£p cáº£ hai phÆ°Æ¡ng phÃ¡p, Ä‘á» tÃ i khÃ´ng chá»‰ khai thÃ¡c toÃ n diá»‡n tiá»m nÄƒng tá»« dá»¯ liá»‡u hÃ nh vi khÃ¡ch
hÃ ng mÃ  cÃ²n má»Ÿ rá»™ng gÃ³c nhÃ¬n so sÃ¡nh trong viá»‡c á»©ng dá»¥ng cÃ¡c thuáº­t toÃ¡n há»c mÃ¡y trong thá»±c tiá»…n kinh doanh.

# **CHÆ¯Æ NG 2: CÆ  Sá» LÃ THUYáº¾T**

## **2.1. Thuáº­t toÃ¡n phÃ¢n cá»¥m K â€“ Means**

### 2.1.1. KhÃ¡i niá»‡m vá» K â€“ Means

Thuáº­t toÃ¡n K-means lÃ  má»™t ká»¹ thuáº­t há»c khÃ´ng giÃ¡m sÃ¡t ná»•i báº­t, Ä‘Æ°á»£c á»©ng dá»¥ng rá»™ng rÃ£i trong phÃ¢n tÃ­ch dá»¯ liá»‡u nháº±m chia táº­p dá»¯ liá»‡u chÆ°a gÃ¡n nhÃ£n thÃ nh cÃ¡c nhÃ³m (cá»¥m) sao cho cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u trong cÃ¹ng má»™t cá»¥m cÃ³ má»©c Ä‘á»™ tÆ°Æ¡ng Ä‘á»“ng cao, trong khi sá»± khÃ¡c biá»‡t giá»¯a cÃ¡c cá»¥m lÃ  tá»‘i Ä‘a. NguyÃªn lÃ½ hoáº¡t Ä‘á»™ng cá»§a K-means dá»±a trÃªn viá»‡c tá»‘i thiá»ƒu hÃ³a tá»•ng bÃ¬nh phÆ°Æ¡ng khoáº£ng cÃ¡ch giá»¯a cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u vÃ  tÃ¢m cá»¥m mÃ  chÃºng Ä‘Æ°á»£c gÃ¡n vÃ o. Má»—i Ä‘iá»ƒm sáº½ Ä‘Æ°á»£c phÃ¢n vÃ o cá»¥m cÃ³ trung tÃ¢m gáº§n nháº¥t, vÃ  cÃ¡c tÃ¢m cá»¥m Ä‘Æ°á»£c cáº­p nháº­t liÃªn tá»¥c cho Ä‘áº¿n khi Ä‘áº¡t Ä‘Æ°á»£c tráº¡ng thÃ¡i há»™i tá»¥.[@son_k_nodate]



```{r step1, echo=FALSE, fig.align='center', out.width='50%', fig.cap="Minh há»a vá» K - Means"}
knitr::include_graphics("images/kmeans_step1.png")
```



Má»¥c tiÃªu chÃ­nh cá»§a K-Means lÃ  giáº£m thiá»ƒu tá»•ng bÃ¬nh phÆ°Æ¡ng khoáº£ng cÃ¡ch giá»¯a cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u vÃ  trung tÃ¢m cá»¥m cá»§a chÃºng, Ä‘Æ°á»£c gá»i lÃ  Within-Cluster Sum of Squares (WCSS):

$$WCSS = \sum_{i=1}^{K} \sum_{x \in C_i} \| x - \mu_i \|^2$$
Trong Ä‘Ã³:

- $K$: LÃ  sá»‘ lÆ°á»£ng cá»¥m  
- $C_i$: LÃ  táº­p há»£p cÃ¡c Ä‘iá»ƒm thuá»™c cá»¥m thá»© $i$  
- $\mu_i$: LÃ  trung tÃ¢m (tÃ¢m cá»¥m) cá»§a cá»¥m thá»© $i$  
- $\|x - \mu_i\|^2$: LÃ  bÃ¬nh phÆ°Æ¡ng khoáº£ng cÃ¡ch Euclidean giá»¯a Ä‘iá»ƒm $x$ vÃ  tÃ¢m cá»¥m $\mu_i$

### 2.1.2. CÃ¡ch hoáº¡t Ä‘á»™ng cá»§a K-Means

BÆ°á»›c 1: Chá»n sá»‘ lÆ°á»£ng cá»¥m

  - XÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng cá»¥m $K$ mÃ  ta sáº½ nhÃ³m dá»¯ liá»‡u. VÃ­ dá»¥ chá»n $K = 3$.
  
BÆ°á»›c 2: Khá»Ÿi táº¡o tÃ¢m cá»¥m ban Ä‘áº§u

  -	Do vá»‹ trÃ­ chÃ­nh xÃ¡c cá»§a cÃ¡c tÃ¢m cá»¥m chÆ°a Ä‘Æ°á»£c biáº¿t, nÃªn á»Ÿ giai Ä‘oáº¡n khá»Ÿi táº¡o, thuáº­t toÃ¡n sáº½ chá»n ngáº«u nhiÃªn K Ä‘iá»ƒm tá»« táº­p dá»¯ liá»‡u vÃ  coi Ä‘Ã³ lÃ  cÃ¡c tÃ¢m cá»¥m ban Ä‘áº§u.

```{r step2, echo=FALSE, fig.align='center', out.width='30%', fig.cap="VÃ­ dá»¥ minh há»a vá» khá»Ÿi táº¡o tÃ¢m cá»¥m"}
knitr::include_graphics("images/kmeans_step2.png")
```


BÆ°á»›c 3: GÃ¡n Ä‘iá»ƒm dá»¯ liá»‡u cho cá»¥m gáº§n nháº¥t
  -	Sau khi Ä‘Ã£ cÃ³ tÃ¢m cá»¥m ban Ä‘áº§u, má»—i Ä‘iá»ƒm dá»¯ liá»‡u sáº½ Ä‘Æ°á»£c gÃ¡n vÃ o cá»¥m cÃ³ tÃ¢m gáº§n nháº¥t. Khoáº£ng cÃ¡ch giá»¯a Ä‘iá»ƒm dá»¯ liá»‡u vÃ  tÃ¢m cá»¥m thÆ°á»ng Ä‘Æ°á»£c Ä‘o báº±ng khoáº£ng cÃ¡ch Euclidean. Äiá»ƒm dá»¯ liá»‡u sáº½ thuá»™c vá» cá»¥m cÃ³ tÃ¢m mÃ  nÃ³ cÃ³ khoáº£ng cÃ¡ch Euclidean ngáº¯n nháº¥t.

```{r step3, echo=FALSE, fig.align='center', out.width='40%', fig.cap="VÃ­ dá»¥ vá» gÃ¡n Ä‘iá»ƒm dá»¯ liá»‡u cho cá»¥m cáº§n nháº¥t"}
knitr::include_graphics("images/kmeans_step3.png")
```

  - Äo khoáº£ng cÃ¡ch tá»« cÃ¡c Ä‘iá»ƒm tá»›i tÃ¢m cá»¥m báº±ng phÃ©p Ä‘o khoáº£ng cÃ¡ch Euclidean.

$$d(x, y) = \sqrt{ \sum_{i=1}^{n} (x_i - y_i)^2 }$$

  - Sau Ä‘Ã³ chá»n cá»¥m cho dá»¯ liá»‡u cÃ³ khoáº£ng cÃ¡ch giá»¯a cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u vÃ  tÃ¢m nhá» nháº¥t.

```{r step4, echo=FALSE, fig.align='center', out.width='40%', fig.cap="Sau khi Ä‘o khoáº£ng cÃ¡ch tÃ¢m tá»›i Ä‘iá»ƒm dá»¯ liá»‡u"}
knitr::include_graphics("images/kmeans_step4.png")
```
  


BÆ°á»›c 4: Khá»Ÿi táº¡o láº¡i tÃ¢m cá»¥m

  - Khá»Ÿi táº¡o láº¡i trá»ng tÃ¢m báº±ng cÃ¡ch tÃ­nh toÃ¡n giÃ¡ trá»‹ trung bÃ¬nh cá»§a táº¥t cáº£ cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u cá»§a cá»¥m Ä‘Ã³.
  
$$C_i = \frac{1}{|N_i|} \sum x_i$$

Trong Ä‘Ã³:

- $C_i$: lÃ  tÃ¢m cá»¥m thá»© $i$ (centroid cá»§a cá»¥m $i$)  

- $N_i$: lÃ  táº­p cÃ¡c Ä‘iá»ƒm thuá»™c cá»¥m $i$  

- $|N_i|$: lÃ  sá»‘ lÆ°á»£ng Ä‘iá»ƒm trong cá»¥m $i$ (kÃ­ch thÆ°á»›c cá»¥m)  

- $\sum x_i$: lÃ  tá»•ng cÃ¡c vector dá»¯ liá»‡u $x_i$ trong cá»¥m $i$

  
```{r step5, fig.align='center', echo=FALSE, out.width='40%',fig.cap="Sau khi khá»Ÿi táº¡o láº¡i tÃ¢m cá»¥m"}
knitr::include_graphics("images/kmeans_step5.png")
```

BÆ°á»›c 5: Láº·p láº¡i 

  -	Tiáº¿n hÃ nh láº·p láº¡i bÆ°á»›c 3 vÃ  bÆ°á»›c 4 cho Ä‘áº¿n khi cÃ³ Ä‘Æ°á»£c trá»ng tÃ¢m tá»‘i Æ°u vÃ  viá»‡c chá»‰ Ä‘á»‹nh cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u cho cÃ¡c cá»¥m chÃ­nh xÃ¡c khÃ´ng cÃ²n thay Ä‘á»•i.[@sharma_k-means_2022]

```{r step6, echo=FALSE, fig.align='center', out.width='40%', fig.cap="HoÃ n thÃ nh quÃ¡ trÃ¬nh phÃ¢n cá»¥m"}
knitr::include_graphics("images/kmeans_step6.png")
```

### 2.1.3. Lá»±a chá»n K cho K â€“ Means

Má»™t trong nhá»¯ng thÃ¡ch thá»©c lá»›n nháº¥t khi sá»­ dá»¥ng K-Means lÃ  xÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng cá»¥m K phÃ¹ há»£p. KhÃ´ng cÃ³ má»™t giÃ¡ trá»‹ K tá»‘i Æ°u duy nháº¥t cho má»i bá»™ dá»¯ liá»‡u, vÃ  viá»‡c chá»n K phá»¥ thuá»™c vÃ o Ä‘áº·c Ä‘iá»ƒm cá»§a dá»¯ liá»‡u vÃ  má»¥c tiÃªu phÃ¢n tÃ­ch. DÆ°á»›i Ä‘Ã¢y lÃ  nhá»¯ng phÆ°Æ¡ng phÃ¡p chá»n K cho tá»‘i Æ°u:

**PhÆ°Æ¡ng phÃ¡p Elbow (Khuá»·u tay)**: TÃ¬m sá»‘ lÆ°á»£ng cá»¥m sao cho tá»•ng phÆ°Æ¡ng sai trong cá»¥m (WSS â€“ within-cluster sum of squares) lÃ  nhá» nháº¥t, nhÆ°ng khÃ´ng giáº£m quÃ¡ nhiá»u khi tÄƒng thÃªm cá»¥m. CÃ´ng thá»©c WCSS:

$$
WCSS = \sum_{i=1}^{K} \sum_{x \in C_i} \| x - \mu_i \|^2
$$

  -	**CÃ¡ch thá»±c hiá»‡n:**
  
    1.  Thá»±c hiá»‡n phÃ¢n cá»¥m vá»›i cÃ¡c giÃ¡ trá»‹ K khÃ¡c nhau (vÃ­ dá»¥ tá»« 1 Ä‘áº¿n 10).
    
    2.  TÃ­nh tá»•ng WSS cho má»—i K.
    
    3.  Váº½ biá»ƒu Ä‘á»“ WSS theo sá»‘ cá»¥m K.
    
    4.  Äiá»ƒm "gáº¥p khÃºc" (elbow) trÃªn Ä‘á»“ thá»‹ thÆ°á»ng lÃ  nÆ¡i phÃ¹ há»£p Ä‘á»ƒ chá»n K.
    
    
**PhÆ°Æ¡ng phÃ¡p Silhouette**: ÄÃ¡nh giÃ¡ má»©c Ä‘á»™ phÃ¹ há»£p cá»§a tá»«ng Ä‘iá»ƒm dá»¯ liá»‡u vá»›i cá»¥m cá»§a nÃ³. GiÃ¡ trá»‹ Silhouette cÃ ng gáº§n 1 cho tháº¥y Ä‘iá»ƒm Ä‘Ã³ náº±m â€œÄ‘Ãºngâ€ trong cá»¥m hÆ¡n.

  - **CÃ¡ch thá»±c hiá»‡n:**
  
    1.  PhÃ¢n cá»¥m dá»¯ liá»‡u vá»›i cÃ¡c giÃ¡ trá»‹ khÃ¡c nhau.
    
    2.  TÃ­nh Ä‘á»™ rá»™ng silhouette trung bÃ¬nh cho má»—i giÃ¡ trá»‹ K.
    
    3.  Váº½ Ä‘á»“ thá»‹ silhouette theo K.
    
    4.  Chá»n K táº¡i vá»‹ trÃ­ cÃ³ giÃ¡ trá»‹ silhouette trung bÃ¬nh lá»›n nháº¥t.
    
  **CÃ´ng thá»©c Silhouette**:

$$
s(i) = \frac{b(i) - a(i)}{\max(a(i),\ b(i))}
$$

Trong Ä‘Ã³:

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *\( a(i) \)*: Khoáº£ng cÃ¡ch trung bÃ¬nh tá»« Ä‘iá»ƒm *i* Ä‘áº¿n táº¥t cáº£ cÃ¡c Ä‘iá»ƒm khÃ¡c trong **cÃ¹ng cá»¥m**.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *\( b(i) \)*: Khoáº£ng cÃ¡ch trung bÃ¬nh nhá» nháº¥t tá»« Ä‘iá»ƒm *i* Ä‘áº¿n cÃ¡c Ä‘iá»ƒm trong **cá»¥m khÃ¡c gáº§n nháº¥t**.


- **Káº¿t quáº£ Silhouette tráº£ vá» náº±m trong khoáº£ng** \([-1, 1]\):

  - Gáº§n **1**: Äiá»ƒm dá»¯ liá»‡u Ä‘Æ°á»£c phÃ¢n cá»¥m **ráº¥t tá»‘t**.
  
  - Gáº§n **0**: Äiá»ƒm dá»¯ liá»‡u náº±m á»Ÿ **ranh giá»›i giá»¯a hai cá»¥m**.
  
  - Gáº§n **-1**: Äiá»ƒm dá»¯ liá»‡u cÃ³ thá»ƒ bá»‹ **phÃ¢n cá»¥m sai hoÃ n toÃ n**.

- **ÄÃ¡nh giÃ¡ cháº¥t lÆ°á»£ng phÃ¢n cá»¥m dá»±a trÃªn Silhouette trung bÃ¬nh**:

  - **0.71 â€“ 1.00**: Cáº¥u trÃºc phÃ¢n cá»¥m **máº¡nh**.
  
  - **0.51 â€“ 0.70**: Cáº¥u trÃºc phÃ¢n cá»¥m **há»£p lÃ½**.
  
  - **0.26 â€“ 0.50**: Cáº¥u trÃºc phÃ¢n cá»¥m **yáº¿u**, nÃªn **xem xÃ©t láº¡i**.
  
  - **â‰¤ 0.25**: **KhÃ´ng phÃ¡t hiá»‡n Ä‘Æ°á»£c** cáº¥u trÃºc phÃ¢n cá»¥m rÃµ rÃ ng.
  
**PhÆ°Æ¡ng phÃ¡p Gap Statistic:** Gap Statistic lÃ  má»™t ká»¹ thuáº­t thá»‘ng kÃª Ä‘Æ°á»£c Ä‘á» xuáº¥t bá»Ÿi Tibshirani vÃ  cá»™ng sá»± (2001), dÃ¹ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh sá»‘ cá»¥m tá»‘i Æ°u trong phÃ¢n cá»¥m dá»¯ liá»‡u. PhÆ°Æ¡ng phÃ¡p nÃ y Ä‘Ã¡nh giÃ¡ sá»± khÃ¡c biá»‡t giá»¯a Ä‘á»™ phÃ¢n tÃ¡n cá»§a dá»¯ liá»‡u thá»±c vÃ  dá»¯ liá»‡u ngáº«u nhiÃªn sinh ra tá»« phÃ¢n phá»‘i Ä‘á»“ng nháº¥t.

- **CÃ¡ch thá»±c hiá»‡n:**

  1. **Táº¡o dá»¯ liá»‡u tham chiáº¿u** báº±ng cÃ¡ch láº¥y máº«u ngáº«u nhiÃªn tá»« khÃ´ng gian cá»§a dá»¯ liá»‡u gá»‘c.
  
  2. **TÃ­nh vÃ  so sÃ¡nh má»©c Ä‘á»™ phÃ¢n tÃ¡n** giá»¯a dá»¯ liá»‡u thá»±c vÃ  dá»¯ liá»‡u tham chiáº¿u.
  
  3. **XÃ¡c Ä‘á»‹nh sá»‘ cá»¥m tá»‘i Æ°u** dá»±a trÃªn má»©c Ä‘á»™ chÃªnh lá»‡ch lá»›n nháº¥t giá»¯a hai má»©c phÃ¢n tÃ¡n.
  
- **CÃ´ng thá»©c Gap Statistic:**

$$
Gap(k) = E_n^*\left[ \log(W_k) \right] - \log(W_k)
$$
Trong Ä‘Ã³:

- \( W_k \): Tá»•ng phÆ°Æ¡ng sai trong cá»¥m khi phÃ¢n cá»¥m dá»¯ liá»‡u thá»±c vá»›i \( k \) cá»¥m.

- \( E_n^*\left[ \log(W_k) \right] \): GiÃ¡ trá»‹ ká»³ vá»ng cá»§a \( \log(W_k) \) tá»« dá»¯ liá»‡u ngáº«u nhiÃªn sinh ra \( n \) láº§n.

- \( n \): Sá»‘ láº§n sinh dá»¯ liá»‡u ngáº«u nhiÃªn Ä‘á»ƒ Æ°á»›c lÆ°á»£ng ká»³ vá»ng.

- **CÃ¡ch xÃ¡c Ä‘á»‹nh sá»‘ cá»¥m \( K \) tá»‘i Æ°u:**

  - TÃ­nh Gap Statistic cho nhiá»u giÃ¡ trá»‹ \( k \).

  - Chá»n giÃ¡ trá»‹ nhá» nháº¥t cá»§a \( k \) sao cho:

\[
Gap(k) \geq Gap(k+1) - s_{k+1}
\]

Trong Ä‘Ã³ \( s_{k+1} \) lÃ  sai sá»‘ chuáº©n cá»§a \( Gap(k+1) \).

- **PhÃ¢n tÃ­ch vÃ  Ä‘Ã¡nh giÃ¡:**

  - **Pháº¡m vi**: KhÃ´ng cÃ³ giÃ¡ trá»‹ cá»‘ Ä‘á»‹nh, nhÆ°ng Gap thÆ°á»ng lÃ  **sá»‘ dÆ°Æ¡ng**.
  
  - **GiÃ¡ trá»‹ Gap cao**: Cho tháº¥y dá»¯ liá»‡u cÃ³ **cáº¥u trÃºc phÃ¢n cá»¥m tá»‘t**.
  
  - **Cháº¥t lÆ°á»£ng phÃ¢n cá»¥m**: \( K \) tá»‘i Æ°u lÃ  Ä‘iá»ƒm mÃ  Gap báº¯t Ä‘áº§u **á»•n Ä‘á»‹nh hoáº·c giáº£m**.[@noauthor_determining_nodate]

### 2.1.4. Æ¯u Ä‘iá»ƒm vÃ  nhÆ°á»£c Ä‘iá»ƒm cá»§a K-Means

**Æ¯u Ä‘iá»ƒm:**

- **ÄÆ¡n giáº£n vÃ  dá»… triá»ƒn khai**: K-Means lÃ  má»™t trong nhá»¯ng thuáº­t toÃ¡n phÃ¢n cá»¥m phá»• biáº¿n vÃ  dá»… hiá»ƒu nháº¥t.

- **Tá»‘c Ä‘á»™ xá»­ lÃ½ nhanh**: Nhá» cáº¥u trÃºc tÃ­nh toÃ¡n hiá»‡u quáº£, K-Means cÃ³ thá»ƒ xá»­ lÃ½ nhanh vá»›i dá»¯ liá»‡u lá»›n vÃ  sá»‘ cá»¥m nhá».

- **Kháº£ nÄƒng má»Ÿ rá»™ng tá»‘t**: CÃ³ thá»ƒ Ã¡p dá»¥ng cho dá»¯ liá»‡u lá»›n hoáº·c phÃ¢n cá»¥m theo batch.

- **Linh hoáº¡t**: CÃ³ thá»ƒ Ã¡p dá»¥ng cho nhiá»u loáº¡i dá»¯ liá»‡u sau khi chuáº©n hÃ³a vÃ  chuyá»ƒn Ä‘á»•i thÃ­ch há»£p.

**NhÆ°á»£c Ä‘iá»ƒm:**

- **Pháº£i xÃ¡c Ä‘á»‹nh trÆ°á»›c sá»‘ cá»¥m \( K \)**: ÄÃ¢y lÃ  yÃªu cáº§u báº¯t buá»™c vÃ  gÃ¢y khÃ³ khÄƒn khi chÆ°a hiá»ƒu rÃµ dá»¯ liá»‡u.

- **Phá»¥ thuá»™c vÃ o khá»Ÿi táº¡o ban Ä‘áº§u**: Káº¿t quáº£ phÃ¢n cá»¥m bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi cÃ¡ch chá»n tÃ¢m cá»¥m ban Ä‘áº§u.

- **Giáº£ Ä‘á»‹nh cá»¥m hÃ¬nh cáº§u**: K-Means hoáº¡t Ä‘á»™ng tá»‘t khi cÃ¡c cá»¥m cÃ³ hÃ¬nh dáº¡ng Ä‘á»‘i xá»©ng, Ä‘á»“ng Ä‘á»u vÃ  khÃ´ng chá»“ng láº¥n.

- **Nháº¡y cáº£m vá»›i outliers**: CÃ¡c Ä‘iá»ƒm ngoáº¡i lai cÃ³ thá»ƒ lÃ m lá»‡ch tÃ¢m cá»¥m vÃ  áº£nh hÆ°á»Ÿng Ä‘Ã¡ng ká»ƒ Ä‘áº¿n káº¿t quáº£ phÃ¢n cá»¥m.[@admin_k-means_2024]

### 2.1.5. á»¨ng dá»¥ng cá»§a K-Means trong thá»±c táº¿

K-Means lÃ  má»™t trong nhá»¯ng thuáº­t toÃ¡n phÃ¢n cá»¥m phá»• biáº¿n nháº¥t hiá»‡n nay, Ä‘áº·c biá»‡t hiá»‡u quáº£ khi lÃ m viá»‡c vá»›i **dá»¯ liá»‡u sá»‘ vÃ  liÃªn tá»¥c**. Thuáº­t toÃ¡n Ä‘Æ°á»£c á»©ng dá»¥ng rá»™ng rÃ£i trong nhiá»u lÄ©nh vá»±c, bao gá»“m:

- **PhÃ¢n khÃºc khÃ¡ch hÃ ng**: GiÃºp doanh nghiá»‡p chia nhÃ³m khÃ¡ch hÃ ng theo hÃ nh vi mua sáº¯m hoáº·c Ä‘áº·c Ä‘iá»ƒm tiÃªu dÃ¹ng. Nhá» Ä‘Ã³, doanh nghiá»‡p cÃ³ thá»ƒ **cÃ¡ nhÃ¢n hÃ³a chiáº¿n lÆ°á»£c marketing** vÃ  cáº£i thiá»‡n dá»‹ch vá»¥ chÄƒm sÃ³c khÃ¡ch hÃ ng.

- **PhÃ¡t hiá»‡n gian láº­n**: K-Means há»— trá»£ **phÃ¡t hiá»‡n Ä‘iá»ƒm dá»¯ liá»‡u báº¥t thÆ°á»ng**, vÃ­ dá»¥ nhÆ° cÃ¡c giao dá»‹ch Ä‘Ã¡ng ngá» trong tÃ i chÃ­nh hoáº·c truy cáº­p trÃ¡i phÃ©p trong báº£o máº­t.

- **PhÃ¢n loáº¡i tÃ i liá»‡u**: Trong lÄ©nh vá»±c xá»­ lÃ½ ngÃ´n ngá»¯ tá»± nhiÃªn (NLP), K-Means Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ **nhÃ³m tÃ i liá»‡u theo chá»§ Ä‘á» tÆ°Æ¡ng tá»±**, dá»±a trÃªn biá»ƒu diá»…n vector vÃ  Ä‘áº·c trÆ°ng tá»« vá»±ng.

- **PhÃ¢n tÃ­ch dá»¯ liá»‡u khÃ´ng gian vÃ  hÃ¬nh áº£nh**: K-Means cÃ³ thá»ƒ **chia áº£nh thÃ nh cÃ¡c vÃ¹ng** dá»±a trÃªn mÃ u sáº¯c hoáº·c Ä‘á»™ sÃ¡ng. á»¨ng dá»¥ng nÃ y ráº¥t há»¯u Ã­ch trong **thá»‹ giÃ¡c mÃ¡y tÃ­nh** vÃ  **y táº¿**, cháº³ng háº¡n nhÆ° **cháº©n Ä‘oÃ¡n hÃ¬nh áº£nh y khoa**.[@sharma_k-means_2022-1]

##  **2.2. Thuáº­t toÃ¡n phÃ¢n cá»¥m Density-Based Spatial Clustering of Applications with Noise (DBSCAN)**

### 2.2.1. KhÃ¡i niá»‡m vá» DBSCAN

**DBSCAN** (Density-Based Spatial Clustering of Applications with Noise) lÃ  má»™t thuáº­t toÃ¡n phÃ¢n cá»¥m dá»±a trÃªn máº­t Ä‘á»™, Ä‘Æ°á»£c Ä‘á» xuáº¥t bá»Ÿi Ester, Kriegel, Sander vÃ  Xu vÃ o nÄƒm 1996.

Thuáº­t toÃ¡n nÃ y phÃ¢n nhÃ³m cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u náº±m gáº§n nhau trong vÃ¹ng cÃ³ máº­t Ä‘á»™ cao, Ä‘á»“ng thá»i nháº­n diá»‡n vÃ  loáº¡i bá» cÃ¡c Ä‘iá»ƒm náº±m riÃªng láº» á»Ÿ vÃ¹ng máº­t Ä‘á»™ tháº¥p nhÆ° lÃ  ngoáº¡i lá»‡ (nhiá»…u).

KhÃ¡c vá»›i K-means, DBSCAN khÃ´ng yÃªu cáº§u xÃ¡c Ä‘á»‹nh trÆ°á»›c sá»‘ cá»¥m, vÃ  Ä‘áº·c biá»‡t hiá»‡u quáº£ trong viá»‡c phÃ¡t hiá»‡n cÃ¡c cá»¥m cÃ³ hÃ¬nh dáº¡ng phá»©c táº¡p vÃ  chá»©a nhiá»…u. ÄÃ¢y lÃ  má»™t trong nhá»¯ng thuáº­t toÃ¡n phÃ¢n cá»¥m phá»• biáº¿n vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong há»c mÃ¡y khÃ´ng giÃ¡m sÃ¡t.[@noauthor_dbscan_2021]

```{r step7, echo=FALSE, fig.align='center', out.width='50%', fig.cap="Thuáº­t toÃ¡n DBSCAN"}
knitr::include_graphics("images/dbscan_step1.png")

```

**CÃ¡c khÃ¡i niá»‡m quan trá»ng trong DBSCAN:**

- **Epsilon (Îµ)** â€“ BÃ¡n kÃ­nh vÃ¹ng lÃ¢n cáº­n cá»§a má»™t Ä‘iá»ƒm dá»¯ liá»‡u.

$$
N_\varepsilon(p) = \{ q \in D \mid \text{dist}(p, q) \leq \varepsilon \}
$$

  * Trong Ä‘Ã³:
    - \( D \): LÃ  toÃ n bá»™ táº­p dá»¯ liá»‡u huáº¥n luyá»‡n.
    - \( \text{dist}(p, q) \): LÃ  khoáº£ng cÃ¡ch giá»¯a Ä‘iá»ƒm \( p \) vÃ  \( q \), thÆ°á»ng Ä‘Æ°á»£c tÃ­nh báº±ng khoáº£ng cÃ¡ch Euclidean.

- **MinPts** â€“ Sá»‘ lÆ°á»£ng Ä‘iá»ƒm tá»‘i thiá»ƒu cáº§n cÃ³ trong vÃ¹ng lÃ¢n cáº­n Îµ Ä‘á»ƒ Ä‘Æ°á»£c xem lÃ  vÃ¹ng cÃ³ máº­t Ä‘á»™ cao.

- **Äiá»ƒm lÃµi (Core Point)**: CÃ³ Ã­t nháº¥t *MinPts* Ä‘iá»ƒm trong vÃ¹ng lÃ¢n cáº­n Îµ (bao gá»“m cáº£ chÃ­nh nÃ³).

- **Äiá»ƒm biÃªn (Border Point)**: KhÃ´ng Ä‘á»§ *MinPts*, nhÆ°ng thuá»™c vÃ¹ng lÃ¢n cáº­n cá»§a má»™t Ä‘iá»ƒm lÃµi.  

- **Äiá»ƒm nhiá»…u (Noise / Outlier)**: KhÃ´ng pháº£i Ä‘iá»ƒm lÃµi, cÅ©ng khÃ´ng thuá»™c vÃ¹ng lÃ¢n cáº­n cá»§a báº¥t ká»³ Ä‘iá»ƒm lÃµi nÃ o.[@yehoshua_dbscan_2023]

### 2.2.2. CÃ¡ch xÃ¡c Ä‘á»‹nh tham sá»‘ cho DBSCAN

Má»™t trong nhá»¯ng thÃ¡ch thá»©c chÃ­nh khi sá»­ dá»¥ng DBSCAN lÃ  lá»±a chá»n hai tham sá»‘ cá»‘t lÃµi lÃ : Îµ (epsilon) vÃ  MinPts.

Äá»‘i vá»›i K â€“ Means thÃ¬ thuáº­t toÃ¡n cáº§n xÃ¡c Ä‘á»‹nh trÆ°á»›c sá»‘ cá»¥m K cÃ²n Ä‘á»‘i vá»›i DBSCAN cáº§n yÃªu cáº§u xÃ¡c Ä‘á»‹nh má»©c Ä‘á»™ dÃ y Ä‘áº·t cáº§n thiáº¿t Ä‘á»ƒ phÃ¢n thÃ nh cá»¥m thÃ´ng qua hai yáº¿u tá»‘i trÃªn:

- **Epsilon (Îµ)**: 

  - LÃ  tham sá»‘ xÃ¡c Ä‘á»‹nh bÃ¡n kÃ­nh vÃ¹ng lÃ¢n cáº­n cá»§a má»—i Ä‘iá»ƒm áº£nh hÆ°á»Ÿng trá»±c tiáº¿p Ä‘áº¿n káº¿t quáº£ phÃ¢n cá»¥m.
  
  - CÃ¡ch phá»• biáº¿n Ä‘á»ƒ xÃ¡c Ä‘á»‹nh Îµ lÃ  sá»­ dá»¥ng **Ä‘á»“ thá»‹ k-distance**:

    - Vá»›i má»—i Ä‘iá»ƒm trong táº­p dá»¯ liá»‡u, tÃ­nh khoáº£ng cÃ¡ch Ä‘áº¿n Ä‘iá»ƒm gáº§n nháº¥t thá»© \( k \). Trong Ä‘Ã³:

    $$
    k = \text{MinPts} - 1
    $$

    - Sáº¯p xáº¿p cÃ¡c khoáº£ng cÃ¡ch theo thá»© tá»± tÄƒng dáº§n.
    
    - Váº½ Ä‘á»“ thá»‹ khoáº£ng cÃ¡ch (trá»¥c hoÃ nh: sá»‘ Ä‘iá»ƒm, trá»¥c tung: khoáº£ng cÃ¡ch).
    
    - Quan sÃ¡t biá»ƒu Ä‘á»“ Ä‘á»ƒ tÃ¬m â€œ**Ä‘iá»ƒm gÃ£y**â€ (elbow point) â€” nÆ¡i Ä‘á»™ dá»‘c Ä‘Æ°á»ng cong thay Ä‘á»•i rÃµ rá»‡t.
    
    - **Chá»n Îµ tÆ°Æ¡ng á»©ng vá»›i Ä‘iá»ƒm gÃ£y cá»§a Ä‘á»“ thá»‹**.

- **MinPts**:

  - DÃ¹ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh sá»‘ Ä‘iá»ƒm tá»‘i thiá»ƒu cáº§n cÃ³ trong vÃ¹ng lÃ¢n cáº­n Îµ Ä‘á»ƒ má»™t Ä‘iá»ƒm Ä‘Æ°á»£c xem lÃ  Ä‘iá»ƒm lÃµi.
  
  - Gá»£i Ã½ chá»n:
$$
\text{MinPts} \geq D + 1
$$

    - Äá»‘i vá»›i dá»¯ liá»‡u 2 chiá»u: MinPts = 4.  
    
    - Dá»¯ liá»‡u cÃ³ nhiá»u chiá»u hoáº·c nhiá»…u: MinPts = 5â€“10.
    
  - MinPts cÃ ng lá»›n thÃ¬ thuáº©t toÃ¡n cÃ ng bá»n vá»¯ng nhÆ°ng cÃ³ thá»ƒ bá» qua nhá»¯ng cá»¥m nhá» hoáº·c thá»«a.
  
### 2.2.3. NguyÃªn lÃ½ hoáº¡t Ä‘á»™ng cá»§a DBSCAN

Thuáº­t toÃ¡n DBSCAN thá»±c hiá»‡n phÃ¢n cá»¥m theo máº­t Ä‘á»™ qua cÃ¡c bÆ°á»›c sau:

- **BÆ°á»›c 1: Chá»n má»™t Ä‘iá»ƒm báº¥t ká»³** 

  * ChÆ°a Ä‘Æ°á»£c gÃ¡n nhÃ£n trÃªn táº­p dá»¯ liá»‡u.  
  
  * Váº½ má»™t vÃ²ng trÃ²n xung quanh Ä‘Ã³ vá»›i bÃ¡n kÃ­nh \( \varepsilon \) (epsilon), Ä‘Ã¢y lÃ  vÃ¹ng lÃ¢n cáº­n.

```{r step8, echo=FALSE, fig.align='center', out.width='40%', fig.cap="Chá»n má»™t cá»¥m xung quanh Ä‘iá»ƒm dá»¯ liá»‡u"}
knitr::include_graphics("images/dbscan_step2.png")

```

- **BÆ°á»›c 2: Kiá»ƒm tra sá»‘ lÆ°á»£ng trong vÃ¹ng \( \varepsilon \)**  
  * Äáº¿m sá»‘ Ä‘iá»ƒm náº±m trong \( \varepsilon \)  
  
  * Náº¿u sá»‘ Ä‘iá»ƒm lá»›n hÆ¡n hoáº·c báº±ng *MinPts* thÃ¬ Ä‘Æ°á»£c coi lÃ  Ä‘iá»ƒm lÃµi.  
  
  * Náº¿u Ã­t hÆ¡n, Ä‘iá»ƒm Ä‘Ã³ cÃ³ thá»ƒ lÃ  biÃªn hoáº·c nhiá»…u tÃ¹y thuá»™c vÃ o nhá»¯ng bÆ°á»›c tiáº¿p theo.

```{r step9, echo=FALSE, fig.align='center', out.width='40%', fig.cap="Chá»n má»™t cá»¥m xung quanh Ä‘iá»ƒm dá»¯ liá»‡u"}
knitr::include_graphics("images/dbscan_step3.png")

```

- **BÆ°á»›c 3: XÃ¡c Ä‘á»‹nh Ä‘iá»ƒm lÃµi vÃ  má»Ÿ rá»™ng cá»¥m**  

  * Vá»›i Ä‘iá»ƒm lÃµi vá»«a tÃ¬m Ä‘Æ°á»£c, báº¯t Ä‘áº§u táº¡o ra cá»¥m má»›i. 
  
  * ThÃªm táº¥t cáº£ cÃ¡c Ä‘iá»ƒm trong vÃ¹ng \( \varepsilon \) cá»§a Ä‘iá»ƒm lÃµi vÃ o cá»¥m Ä‘Ã³.  
  
  * Náº¿u trong sá»‘ cÃ¡c Ä‘iá»ƒm má»›i thÃªm vÃ o cÃ³ Ä‘iá»ƒm nÃ o cÅ©ng lÃ  Ä‘iá»ƒm lÃµi thÃ¬ tiáº¿p tá»¥c má»Ÿ rá»™ng cá»¥m tá»« Ä‘iá»ƒm Ä‘Ã³.

```{r step10, echo=FALSE, fig.align='center', out.width='40%', fig.cap="XÃ¡c Ä‘á»‹nh bá»‘n Ä‘iá»ƒm lÃµi mÃ u tÃ­m vÃ  má»™t Ä‘iá»ƒm ngoáº¡i lá»‡ mÃ u vÃ ng"}
knitr::include_graphics("images/dbscan_step4.png")

```

- **BÆ°á»›c 4: Xá»­ lÃ½ Ä‘iá»ƒm biÃªn vÃ  nhiá»…u** 

  * Nhá»¯ng Ä‘iá»ƒm khÃ´ng Ä‘á»§ Ä‘iá»u kiá»‡n lÃ m Ä‘iá»ƒm lÃµi nhÆ°ng náº±m trong vÃ¹ng lÃ¢n cáº­n cá»§a má»™t Ä‘iá»ƒm lÃµi sáº½ Ä‘Æ°á»£c gÃ¡n vÃ o cá»¥m Ä‘Ã³ vÃ  Ä‘Æ°á»£c gá»i lÃ  Ä‘iá»ƒm biÃªn.  
  
  * Nhá»¯ng Ä‘iá»ƒm khÃ´ng náº±m trong cÃ¡c vÃ¹ng lÃ¢n cáº­n cá»§a báº¥t ká»³ Ä‘iá»ƒm lÃµi nÃ o Ä‘Æ°á»£c coi lÃ  Ä‘iá»ƒm nhiá»…u.

```{r step11, echo=FALSE, fig.align='center', out.width='40%', fig.cap="Táº¥t cáº£ cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u lÃµi cÃ³ mÃ u tÃ­mn"}
knitr::include_graphics("images/dbscan_step5.png")

```

- **BÆ°á»›c 5: Tiáº¿p tá»¥c vá»›i cÃ¡c Ä‘iá»ƒm chÆ°a xÃ©t**  

  * Chá»n má»™t Ä‘iá»ƒm lÃµi khÃ¡c chÆ°a Ä‘Æ°á»£c gÃ¡n cá»¥m, láº·p láº¡i quÃ¡ trÃ¬nh má»Ÿ rá»™ng cá»¥m nhÆ° cÃ¡c bÆ°á»›c trÃªn.  
  
  * CÃ¡c cá»¥m má»›i sáº½ Ä‘Æ°á»£c hoÃ n thÃ nh tá»« cÃ¡c Ä‘iá»ƒm lÃµi cÃ²n láº¡i.

```{r step12, echo=FALSE, fig.align='center', out.width='40%', fig.cap="Äiá»ƒm lÃµi Ä‘Æ°á»£c chá»n ngáº«u nhiÃªn mÃ u xanh ngá»c"}
knitr::include_graphics("images/dbscan_step6.png")

```

- **BÆ°á»›c 6: Káº¿t thÃºc phÃ¢n cá»¥m**  

  * Sau khi xÃ©t háº¿t cÃ¡c Ä‘iá»ƒm: 
  
    * Táº¥t cáº£ Ä‘á»u Ä‘Æ°á»£c gÃ¡n cá»¥m.  
    
    * CÃ¡c cá»¥m Ä‘Æ°á»£c tÃ´ mÃ u khÃ¡c nhau.  
    
    * Äiá»ƒm nhiá»…u khÃ´ng thay Ä‘á»•i.

```{r step13, echo=FALSE, fig.align='center', out.width='40%', fig.cap="Káº¿t thÃºc phÃ¢n cá»¥m"}
knitr::include_graphics("images/dbscan_step7.png")

```

### 2.2.4. Æ¯u Ä‘iá»ƒm vÃ  nhÆ°á»£c Ä‘iá»ƒm cá»§a DBSCAN

**Æ¯u Ä‘iá»ƒm:** DBSCAN cÃ³ kháº£ nÄƒng phÃ¡t hiá»‡n cá»¥m vá»›i hÃ¬nh dáº¡ng báº¥t ká»³, khÃ´ng bá»‹ giá»›i háº¡n nhÆ° K-Means. Thuáº­t toÃ¡n xá»­ lÃ½ tá»‘t dá»¯ liá»‡u nhiá»…u báº±ng cÃ¡ch tá»± Ä‘á»™ng loáº¡i bá» cÃ¡c Ä‘iá»ƒm ngoÃ i cá»¥m. NgoÃ i ra, DBSCAN khÃ´ng yÃªu cáº§u xÃ¡c Ä‘á»‹nh trÆ°á»›c sá»‘ lÆ°á»£ng cá»¥m, phÃ¹ há»£p vá»›i dá»¯ liá»‡u chÆ°a rÃµ cáº¥u trÃºc.

**NhÆ°á»£c Ä‘iá»ƒm:** Káº¿t quáº£ phÃ¢n cá»¥m phá»¥ thuá»™c nhiá»u vÃ o lá»±a chá»n tham sá»‘ epsilon vÃ  min_samples. DBSCAN gáº·p khÃ³ khÄƒn khi dá»¯ liá»‡u cÃ³ máº­t Ä‘á»™ cá»¥m khÃ´ng Ä‘á»“ng Ä‘á»u vÃ  hoáº¡t Ä‘á»™ng kÃ©m hiá»‡u quáº£ vá»›i dá»¯ liá»‡u nhiá»u chiá»u do khoáº£ng cÃ¡ch giá»¯a cÃ¡c Ä‘iá»ƒm trá»Ÿ nÃªn khÃ´ng rÃµ rÃ ng.

### 2.2.5. á»¨ng dá»¥ng trong thá»±c táº¿ cá»§a DBSCAN
**DBSCAN** Ä‘Æ°á»£c sá»­ dá»¥ng hiá»‡u quáº£ trong cÃ¡c bÃ i toÃ¡n phÃ¢n cá»¥m phá»©c táº¡p, Ä‘áº·c biá»‡t khi dá»¯ liá»‡u khÃ´ng cÃ³ cáº¥u trÃºc rÃµ rÃ ng hoáº·c chá»©a nhiá»u nhiá»…u:

**PhÃ¢n cá»¥m khÃ´ng gian:** DBSCAN phÃ¹ há»£p vá»›i dá»¯ liá»‡u Ä‘á»‹a lÃ½ nhÆ° xÃ¡c Ä‘á»‹nh khu vá»±c cÃ³ máº­t Ä‘á»™ tá»™i pháº¡m cao, vÃ¹ng cÃ³ tá»· lá»‡ bá»‡nh báº¥t thÆ°á»ng hoáº·c Ä‘iá»ƒm nÃ³ng tai náº¡n giao thÃ´ng trong Ä‘Ã´ thá»‹.

**PhÃ¡t hiá»‡n báº¥t thÆ°á»ng:** MÃ´ hÃ¬nh cÃ³ thá»ƒ cÃ´ láº­p cÃ¡c Ä‘iá»ƒm láº» khÃ´ng thuá»™c cá»¥m, há»— trá»£ phÃ¡t hiá»‡n giao dá»‹ch gian láº­n, lá»—i cáº£m biáº¿n trong cÃ´ng nghiá»‡p hoáº·c dá»¯ liá»‡u báº¥t thÆ°á»ng trong há»‡ thá»‘ng.

**PhÃ¢n khÃºc khÃ¡ch hÃ ng:** DBSCAN cho phÃ©p nhÃ³m khÃ¡ch hÃ ng theo hÃ nh vi tiÃªu dÃ¹ng mÃ  khÃ´ng cáº§n xÃ¡c Ä‘á»‹nh trÆ°á»›c sá»‘ nhÃ³m, há»¯u Ã­ch cho phÃ¢n tÃ­ch mua sáº¯m vÃ  cÃ¡ nhÃ¢n hÃ³a chiáº¿n dá»‹ch tiáº¿p thá»‹.

**Xá»­ lÃ½ dá»¯ liá»‡u hÃ¬nh áº£nh vÃ  vÄƒn báº£n:** CÃ³ thá»ƒ á»©ng dá»¥ng vÃ o phÃ¢n loáº¡i áº£nh y khoa, thá»‹ giÃ¡c mÃ¡y tÃ­nh vÃ  nhÃ³m tÃ i liá»‡u theo chá»§ Ä‘á» hoáº·c biá»ƒu hiá»‡n sinh há»c, há»— trá»£ phÃ¢n tÃ­ch bá»‡nh lÃ½ hoáº·c nghiÃªn cá»©u chuyÃªn sÃ¢u.[@noauthor_dbscan_nodate-1]

## **2.3. RFM Analysis**

### 2.3.1. KhÃ¡i niá»‡m vá» RFM

**RFM** (Recency â€“ Frequency â€“ Monetary) lÃ  mÃ´ hÃ¬nh phÃ¢n tÃ­ch vÃ  phÃ¢n khÃºc khÃ¡ch hÃ ng dá»±a trÃªn hÃ nh vi tiÃªu dÃ¹ng, sá»­ dá»¥ng dá»¯ liá»‡u giao dá»‹ch lá»‹ch sá»­ Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ vÃ  phÃ¢n loáº¡i khÃ¡ch hÃ ng theo ba tiÃªu chÃ­ chÃ­nh:

- **Recency (R):** Khoáº£ng thá»i gian ká»ƒ tá»« láº§n mua hÃ ng gáº§n nháº¥t cá»§a khÃ¡ch hÃ ng.

- **Frequency (F):** Sá»‘ láº§n khÃ¡ch hÃ ng Ä‘Ã£ mua hÃ ng trong má»™t khoáº£ng thá»i gian.

- **Monetary (M):** Tá»•ng sá»‘ tiá»n khÃ¡ch hÃ ng Ä‘Ã£ chi tiÃªu.

PhÃ¢n tÃ­ch RFM giÃºp doanh nghiá»‡p hiá»ƒu rÃµ hÃ nh vi mua sáº¯m cá»§a khÃ¡ch hÃ ng, tá»« Ä‘Ã³ Ä‘Æ°a ra cÃ¡c chiáº¿n lÆ°á»£c tiáº¿p thá»‹ vÃ  chÄƒm sÃ³c khÃ¡ch hÃ ng phÃ¹ há»£p.

### 2.3.2. Ã nghÄ©a cá»§a tá»«ng yáº¿u tá»‘ RFM

| ThÃ nh pháº§n | Ã nghÄ©a | VÃ­ dá»¥ |
|------------|--------|-------|
| **Recency** | KhÃ¡ch hÃ ng mua hÃ ng gáº§n Ä‘Ã¢y thÆ°á»ng cÃ³ kháº£ nÄƒng quay láº¡i cao hÆ¡n. | Má»™t khÃ¡ch hÃ ng vá»«a mua cÃ¡ch Ä‘Ã¢y 3 ngÃ y cÃ³ giÃ¡ trá»‹ R cao hÆ¡n ngÆ°á»i mua cÃ¡ch Ä‘Ã¢y 3 thÃ¡ng. |
| **Frequency** | KhÃ¡ch hÃ ng mua hÃ ng nhiá»u láº§n lÃ  dáº¥u hiá»‡u cá»§a sá»± trung thÃ nh. | Má»™t khÃ¡ch hÃ ng mua 10 láº§n trong 3 thÃ¡ng cÃ³ F cao hÆ¡n ngÆ°á»i mua 1 láº§n. |
| **Monetary** | KhÃ¡ch hÃ ng chi tiÃªu nhiá»u thÆ°á»ng cÃ³ giÃ¡ trá»‹ kinh táº¿ cao hÆ¡n. | Má»™t ngÆ°á»i chi 10 triá»‡u cÃ³ M cao hÆ¡n ngÆ°á»i chi 500 nghÃ¬n. |

### 2.3.3. Táº¡i sao nÃªn sá»­ dá»¥ng phÃ¢n tÃ­ch RFM?

PhÃ¢n tÃ­ch RFM mang láº¡i nhiá»u lá»£i Ã­ch cho doanh nghiá»‡p:

- **Hiá»ƒu rÃµ hÃ nh vi khÃ¡ch hÃ ng:** Dá»±a trÃªn dá»¯ liá»‡u thá»±c táº¿, khÃ´ng phá»ng Ä‘oÃ¡n
.
- **Tá»‘i Æ°u hÃ³a chiáº¿n lÆ°á»£c marketing:** Gá»­i Ä‘Ãºng thÃ´ng Ä‘iá»‡p cho Ä‘Ãºng ngÆ°á»i vÃ o Ä‘Ãºng thá»i Ä‘iá»ƒm.

- **PhÃ¢n bá»• nguá»“n lá»±c hiá»‡u quáº£:** Æ¯u tiÃªn chÄƒm sÃ³c nhÃ³m khÃ¡ch hÃ ng cÃ³ giÃ¡ trá»‹ cao.

### 2.3.4. Lá»£i Ã­ch cá»§a mÃ´ hÃ¬nh RFM

| Lá»£i Ã­ch | Giáº£i thÃ­ch |
|--------|------------|
| ÄÆ¡n giáº£n, dá»… Ã¡p dá»¥ng | Chá»‰ cáº§n dá»¯ liá»‡u mua hÃ ng cÆ¡ báº£n, khÃ´ng cáº§n mÃ´ hÃ¬nh phá»©c táº¡p |
| Dá»±a trÃªn hÃ nh vi thá»±c táº¿ | ChÃ­nh xÃ¡c hÆ¡n so vá»›i chá»‰ phÃ¢n tÃ­ch nhÃ¢n kháº©u há»c |
| Dá»… phÃ¢n khÃºc | CÃ³ thá»ƒ chia khÃ¡ch hÃ ng thÃ nh cÃ¡c nhÃ³m nhá» Ä‘á»ƒ chÄƒm sÃ³c riÃªng |
| Dá»… má»Ÿ rá»™ng | CÃ³ thá»ƒ káº¿t há»£p thÃªm cÃ¡c yáº¿u tá»‘ khÃ¡c nhÆ° CLV, churn rate |

### 2.3.5. Quy trÃ¬nh phÃ¢n tÃ­ch RFM

* **BÆ°á»›c 1: Thu tháº­p dá»¯ liá»‡u**

    - Cáº§n cÃ¡c trÆ°á»ng thÃ´ng tin: Customer ID, ngÃ y giao dá»‹ch, giÃ¡ trá»‹ giao dá»‹ch.

* **BÆ°á»›c 2: TÃ­nh toÃ¡n chá»‰ sá»‘ RFM**

    - **Recency:** NgÃ y hiá»‡n táº¡i â€“ NgÃ y mua hÃ ng gáº§n nháº¥t
    
    - **Frequency:** Sá»‘ lÆ°á»£ng giao dá»‹ch
    
    - **Monetary:** Tá»•ng tiá»n chi tiÃªu

* **BÆ°á»›c 3: GÃ¡n Ä‘iá»ƒm RFM**

    - Chia má»—i chá»‰ sá»‘ thÃ nh 5 má»©c (1 = tháº¥p nháº¥t, 5 = cao nháº¥t), gÃ¡n Ä‘iá»ƒm cho tá»«ng khÃ¡ch hÃ ng.

* **BÆ°á»›c 4: PhÃ¢n khÃºc khÃ¡ch hÃ ng**

    - GÃ¡n mÃ£ RFM (vÃ­ dá»¥: R=5, F=4, M=2 â†’ RFM = 542). Tá»« Ä‘Ã³ chia thÃ nh cÃ¡c nhÃ³m hÃ nh vi.

* **BÆ°á»›c 5: á»¨ng dá»¥ng chiáº¿n lÆ°á»£c phÃ¹ há»£p**

| PhÃ¢n khÃºc           | Äáº·c Ä‘iá»ƒm chÃ­nh                                    | Chiáº¿n lÆ°á»£c Ä‘á» xuáº¥t                          |
|---------------------|----------------------------------------------------|--------------------------------------------|
| **VIP**             | R tháº¥p, F cao, M cao                               | ChÄƒm sÃ³c Ä‘áº·c biá»‡t, Æ°u Ä‘Ã£i cao              |
| **KhÃ¡ch trung thÃ nh** | R tháº¥p, F cao, M trung bÃ¬nh                       | Gá»­i thÃ´ng bÃ¡o thÆ°á»ng xuyÃªn, táº·ng thÆ°á»Ÿng    |
| **Má»›i Ä‘áº¿n**         | R ráº¥t tháº¥p, F tháº¥p, M tháº¥p                         | HÆ°á»›ng dáº«n, giá»›i thiá»‡u sáº£n pháº©m             |
| **Sáº¯p rá»i bá»**      | R cao, F cao, M cao                                | Gá»­i email khuyáº¿n mÃ£i giá»¯ chÃ¢n              |
| **Ngá»§ quÃªn**        | R ráº¥t cao, F tháº¥p, M tháº¥p                          | Gá»­i phiáº¿u giáº£m giÃ¡, Æ°u Ä‘Ã£i Ä‘Ã¡nh thá»©c nhu cáº§u |

### 2.3.6. Káº¿t luáº­n

RFM lÃ  má»™t cÃ´ng cá»¥ máº¡nh máº½ giÃºp doanh nghiá»‡p cÃ¡ nhÃ¢n hÃ³a marketing, tÄƒng hiá»‡u quáº£ bÃ¡n hÃ ng vÃ  duy trÃ¬ má»‘i quan há»‡ vá»›i khÃ¡ch hÃ ng. Vá»›i chi phÃ­ triá»ƒn khai tháº¥p vÃ  kháº£ nÄƒng á»©ng dá»¥ng rá»™ng rÃ£i, phÃ¢n tÃ­ch RFM lÃ  má»™t trong nhá»¯ng phÆ°Æ¡ng phÃ¡p khÃ´ng thá»ƒ thiáº¿u trong kho vÅ© khÃ­ marketing hiá»‡n Ä‘áº¡i.[@noauthor_phan_2023]

# **CHÆ¯Æ NG 3: Káº¾T QUáº¢ THá»°C NGHIá»†M**

## **3.1. Giá»›i thiá»‡u vá» bá»™ dá»¯ liá»‡u** 

Bá»™ dá»¯ liá»‡u **Online Retail** Ä‘Æ°á»£c thu tháº­p tá»« má»™t doanh nghiá»‡p bÃ¡n láº» trá»±c tuyáº¿n táº¡i VÆ°Æ¡ng quá»‘c Anh trong khoáº£ng thá»i gian tá»« thÃ¡ng 12/2010 Ä‘áº¿n thÃ¡ng 12/2011. ÄÃ¢y lÃ  má»™t táº­p dá»¯ liá»‡u giao dá»‹ch thá»±c táº¿ gá»“m hÆ¡n **500.000 dÃ²ng**, pháº£n Ã¡nh cÃ¡c hÃ³a Ä‘Æ¡n mua hÃ ng tá»« khÃ¡ch hÃ ng trÃªn toÃ n tháº¿ giá»›i. Bá»™ dá»¯ liá»‡u Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong cÃ¡c bÃ i toÃ¡n khai phÃ¡ dá»¯ liá»‡u, phÃ¢n tÃ­ch hÃ nh vi khÃ¡ch hÃ ng, vÃ  xÃ¢y dá»±ng mÃ´ hÃ¬nh phÃ¢n khÃºc.

**Má»¥c tiÃªu phÃ¢n tÃ­ch:**

- PhÃ¢n tÃ­ch hÃ nh vi mua hÃ ng cá»§a tá»«ng khÃ¡ch hÃ ng dá»±a trÃªn thá»i gian mua hÃ ng gáº§n nháº¥t, sá»‘ láº§n mua vÃ  giÃ¡ trá»‹ mua.

- XÃ¢y dá»±ng mÃ´ hÃ¬nh RFM (Recency - Frequency - Monetary) Ä‘á»ƒ phÃ¢n khÃºc khÃ¡ch hÃ ng.

- Ãp dá»¥ng thuáº­t toÃ¡n phÃ¢n cá»¥m K-Means vÃ  DBSCAN Ä‘á»ƒ khÃ¡m phÃ¡ cÃ¡c nhÃ³m khÃ¡ch hÃ ng tiá»m nÄƒng.

- Gá»£i Ã½ chiáº¿n lÆ°á»£c marketing phÃ¹ há»£p vá»›i tá»«ng nhÃ³m khÃ¡ch hÃ ng nháº±m tá»‘i Æ°u hÃ³a doanh thu.

**Tá»•ng quan vá» dá»¯ liá»‡u:**

| TÃªn biáº¿n     | Giáº£i thÃ­ch                             | Kiá»ƒu dá»¯ liá»‡u |
|--------------|------------------------------------------|--------------|
| InvoiceNo    | MÃ£ Ä‘Æ¡n hÃ ng (hÃ³a Ä‘Æ¡n)                    | KÃ½ tá»±        |
| StockCode    | MÃ£ sáº£n pháº©m                              | KÃ½ tá»±        |
| Description  | MÃ´ táº£ sáº£n pháº©m                           | KÃ½ tá»±        |
| Quantity     | Sá»‘ lÆ°á»£ng sáº£n pháº©m                        | Sá»‘ nguyÃªn    |
| InvoiceDate  | NgÃ y giao dá»‹ch                           | NgÃ y giá»     |
| UnitPrice    | GiÃ¡ cá»§a má»™t Ä‘Æ¡n vá»‹ sáº£n pháº©m              | Sá»‘ thá»±c      |
| CustomerID   | MÃ£ khÃ¡ch hÃ ng                            | Sá»‘ nguyÃªn    |
| Country      | Quá»‘c gia cá»§a khÃ¡ch hÃ ng                  | KÃ½ tá»±        |

**Äáº·c Ä‘iá»ƒm cá»§a bÃ i toÃ¡n:**

- LÃ  bÃ i toÃ¡n phÃ¢n tÃ­ch hÃ nh vi khÃ¡ch hÃ ng khÃ´ng giÃ¡m sÃ¡t.
- Káº¿t há»£p nhiá»u biáº¿n Ä‘á»‹nh tÃ­nh vÃ  Ä‘á»‹nh lÆ°á»£ng.
- YÃªu cáº§u tiá»n xá»­ lÃ½ dá»¯ liá»‡u ká»¹ lÆ°á»¡ng.

```{r echo=FALSE,results='hide', message=FALSE, warning=FALSE, paged.print=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
# Äáº·t locale Ä‘á»ƒ há»— trá»£ tiáº¿ng Viá»‡t trong Ä‘á»“ thá»‹
Sys.setlocale("LC_ALL", "Vietnamese")
```

```{r echo=FALSE,results='hide', message=FALSE, warning=FALSE, paged.print=FALSE}
library(tidyverse)
library(cluster)
library(factoextra)
library(lubridate)
library(scales)
library(psych)
library(readxl)
library(dplyr)
library(ggplot2)
library(plotly)
library(gridExtra)
```


***Äá»c vÃ  khÃ¡m phÃ¡ dá»¯ liá»‡u***

```{r}
# Äá»c dá»¯ liá»‡u
df <- read_excel("Online Retail.xlsx")
head(df, width = Inf)  



```
Nháº­n xÃ©t:

  - Bá»™ dá»¯ liá»‡u cÃ³ cáº¥u trÃºc há»£p lÃ½ vá»›i 8 cá»™t cÆ¡ báº£n, má»—i dÃ²ng tÆ°Æ¡ng á»©ng vá»›i má»™t dÃ²ng sáº£n pháº©m trong hÃ³a Ä‘Æ¡n.
  
- ÄÃ¢y lÃ  dá»¯ liá»‡u pháº£n Ã¡nh hÃ nh vi mua hÃ ng trá»±c tiáº¿p tá»« khÃ¡ch hÃ ng, ráº¥t phÃ¹ há»£p Ä‘á»ƒ Ã¡p dá»¥ng mÃ´ hÃ¬nh RFM.

- CÃ¡c biáº¿n `Quantity`, `UnitPrice`, vÃ  `CustomerID` lÃ  cÆ¡ sá»Ÿ Ä‘á»ƒ tÃ­nh toÃ¡n cÃ¡c chá»‰ sá»‘ giÃ¡ trá»‹ (Monetary), táº§n suáº¥t (Frequency) vÃ  gáº§n Ä‘Ã¢y (Recency).

- Viá»‡c cÃ³ cáº£ biáº¿n mÃ´ táº£ sáº£n pháº©m vÃ  Ä‘á»‹a lÃ½ (`Country`) cho phÃ©p má»Ÿ rá»™ng phÃ¢n tÃ­ch hÃ nh vi theo khu vá»±c vÃ  theo loáº¡i hÃ ng hÃ³a.

```{r}
#Kiá»ƒm tra kiá»ƒu dá»¯ liá»‡u
str(df)
```
- Dá»¯ liá»‡u cÃ³ kiá»ƒu phÃ¹ há»£p, Ä‘áº·c biá»‡t lÃ  `InvoiceDate` cáº§n Ä‘Æ°á»£c Ä‘á»‹nh dáº¡ng láº¡i Ä‘Ãºng format, ráº¥t quan trá»ng khi tÃ­nh Recency.

- Má»™t sá»‘ trÆ°á»ng nhÆ° `InvoiceNo`, `StockCode` lÃ  chuá»—i, cáº§n chuáº©n hÃ³a vÃ¬ cÃ³ thá»ƒ chá»©a kÃ½ hiá»‡u Ä‘áº·c biá»‡t hoáº·c mÃ£ huá»· Ä‘Æ¡n.

- `Quantity`, `UnitPrice` cÃ³ dáº¡ng sá»‘, phÃ¹ há»£p cho cÃ¡c phÃ©p tÃ­nh toÃ¡n giÃ¡ trá»‹ chi tiÃªu nhÆ°ng cáº§n xem xÃ©t dá»¯ liá»‡u Ã¢m hoáº·c báº±ng 0.


```{r}
# thá»‘ng kÃª mÃ´ táº£ dá»¯ liá»‡u 
describe(df)
```
- PhÃ¡t hiá»‡n ra cÃ¡c giÃ¡ trá»‹ Ã¢m vÃ  báº±ng 0 á»Ÿ `Quantity` vÃ  `UnitPrice` cÃ³ thá»ƒ Ä‘áº¡i diá»‡n cho viá»‡c tráº£ hÃ ng hoáº·c lá»—i nháº­p liá»‡u.

- Sá»± tá»“n táº¡i cá»§a cÃ¡c giÃ¡ trá»‹ NA trong `CustomerID` lÃ  váº¥n Ä‘á» lá»›n vÃ¬ phÃ¢n tÃ­ch RFM yÃªu cáº§u Ä‘á»‹nh danh khÃ¡ch hÃ ng rÃµ rÃ ng.

- Viá»‡c kiá»ƒm tra vÃ  loáº¡i bá» hoáº·c xá»­ lÃ½ phÃ¹ há»£p cÃ¡c dá»¯ liá»‡u nÃ y lÃ  bÆ°á»›c khÃ´ng thá»ƒ thiáº¿u trÆ°á»›c khi Ä‘i vÃ o phÃ¢n cá»¥m.

```{r}
# Thá»‘ng kÃª data object 
summary(df[, sapply(df, is.character)])
```
- `InvoiceNo` vÃ  `StockCode` cÃ³ sá»‘ lÆ°á»£ng giÃ¡ trá»‹ duy nháº¥t lá»›n, xÃ¡c nháº­n ráº±ng má»—i hÃ³a Ä‘Æ¡n vÃ  mÃ£ sáº£n pháº©m gáº§n nhÆ° lÃ  riÃªng biá»‡t.

- CÃ³ thá»ƒ tá»“n táº¡i `InvoiceNo` báº¯t Ä‘áº§u báº±ng chá»¯ "C" â€“ Ä‘áº¡i diá»‡n cho Ä‘Æ¡n huá»·, cáº§n loáº¡i bá» Ä‘á»ƒ khÃ´ng lÃ m sai lá»‡ch phÃ¢n tÃ­ch.

- `Country` lÃ  trÆ°á»ng quan trá»ng Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ hÃ nh vi theo quá»‘c gia cÃ³ thá»ƒ má»Ÿ rá»™ng phÃ¢n khÃºc theo Ä‘á»‹a lÃ½ náº¿u cáº§n.

```{r}
#kiá»ƒm tra dá»¯ liá»‡u thiáº¿u 
colSums(is.na(df))
```
- `CustomerID` cÃ³ sá»‘ lÆ°á»£ng giÃ¡ trá»‹ thiáº¿u lá»›n (trÃªn 100.000 dÃ²ng), áº£nh hÆ°á»Ÿng trá»±c tiáº¿p Ä‘áº¿n viá»‡c tÃ­nh toÃ¡n chá»‰ sá»‘ RFM.

- Cáº§n xÃ¡c Ä‘á»‹nh xem cÃ¡c dÃ²ng thiáº¿u ID cÃ³ pháº£i lÃ  giao dá»‹ch tháº­t hay chá»‰ lÃ  ghi nháº­n ná»™i bá»™, tá»« Ä‘Ã³ quyáº¿t Ä‘á»‹nh loáº¡i bá» hay gÃ¡n ID thay tháº¿.

- NhÃ¬n chung, viá»‡c lÃ m sáº¡ch dá»¯ liá»‡u lÃ  bÆ°á»›c báº¯t buá»™c Ä‘á»ƒ Ä‘áº£m báº£o Ä‘á»™ tin cáº­y cho cÃ¡c phÃ¢n tÃ­ch vÃ  mÃ´ hÃ¬nh tiáº¿p theo.



```{r echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE, results='hide'}
# Kiá»ƒm tra giÃ¡ trá»‹ thiáº¿u cá»§a CustomerID
df_na <- df[is.na(df$CustomerID), ]
print(df_na[sample(nrow(df_na), 10), ], width = Inf)
```

```{r}
# Chuyá»ƒn 'InvoiceNo' vá» kiá»ƒu chuá»—i
df$InvoiceNo <- as.character(df$InvoiceNo)
#Lá»c ra nhá»¯ng dÃ²ng KHÃ”NG cÃ³ InvoiceNo Ä‘Ãºng 6 chá»¯ sá»‘
df[!grepl("^\\d{6}$", df$InvoiceNo), ]
#Kiá»ƒm tra kÃ­ tá»± khÃ¡c trong cá»™t InvoiceNo 
unique(gsub("[0-9]", "", df$InvoiceNo))
# kiá»ƒm tra col 'InvoiceNo' cÃ³ giÃ¡ trá»‹ nÃ o báº¯t Ä‘áº§u báº±ng kÃ­ tá»± 'A' ko
df[grepl("^A", df$InvoiceNo), ]

```
- CÃ³ nhiá»u InvoiceNo khÃ´ng tuÃ¢n thá»§ Ä‘á»‹nh dáº¡ng chuáº©n 6 chá»¯ sá»‘, vÃ­ dá»¥: "C536379", "A563185"...

- Viá»‡c gáº¯n thÃªm kÃ½ tá»± Ä‘áº§u dÃ²ng lÃ  cÃ³ chá»§ Ä‘Ã­ch tá»« há»‡ thá»‘ng nghiá»‡p vá»¥:

  - **"C"** thÆ°á»ng Ä‘áº¡i diá»‡n cho Cancelled Invoice â€“ tá»©c lÃ  hÃ³a Ä‘Æ¡n bá»‹ há»§y sau khi xuáº¥t.

  - **"A"** lÃ  viáº¿t táº¯t cá»§a Adjustment / Adjust bad debt â€“ hÃ³a Ä‘Æ¡n Ä‘iá»u chá»‰nh cho cÃ¡c khoáº£n ná»£ khÃ´ng thu há»“i Ä‘Æ°á»£c.

- Nhá»¯ng hÃ³a Ä‘Æ¡n nÃ y khÃ´ng Ä‘áº¡i diá»‡n cho hÃ nh vi mua bÃ¡n thÃ´ng thÆ°á»ng vÃ  cÃ³ thá»ƒ gÃ¢y sai lá»‡ch khi phÃ¢n tÃ­ch Recency, Frequency, Monetary náº¿u khÃ´ng xá»­ lÃ½.

- Náº¿u má»¥c tiÃªu lÃ  phÃ¢n tÃ­ch khÃ¡ch hÃ ng tÃ­ch cá»±c, **loáº¡i bá» chÃºng** trÆ°á»›c khi tÃ­nh RFM.



```{r}
# Äáº£m báº£o 'StockCode' lÃ  kiá»ƒu chuá»—i
df$StockCode <- as.character(df$StockCode)
# Lá»c nhá»¯ng dÃ²ng KHÃ”NG pháº£i 5 chá»¯ sá»‘ hoáº·c 5 chá»¯ sá»‘ + chá»¯ cÃ¡i
mask <- !(grepl("^\\d{5}$", df$StockCode) | grepl("^\\d{5}[a-zA-Z]+$", df$StockCode))
# Láº¥y cÃ¡c StockCode sai Ä‘á»‹nh dáº¡ng vÃ  loáº¡i trÃ¹ng
invalid_stockcodes <- unique(df$StockCode[mask])
# Hiá»ƒn thá»‹ káº¿t quáº£
print(invalid_stockcodes)
# Lá»c nhá»¯ng dÃ²ng cÃ³ chá»©a chuá»—i 'DOT'
df_with_DOT <- df[grepl("DOT", df$StockCode), ]
# Hiá»ƒn thá»‹ káº¿t quáº£
print(df_with_DOT)
```

**Nháº­n xÃ©t:**

- Nhiá»u mÃ£ StockCode nhÆ° "POST", "DOT", "BANK CHARGES" hay "gift_000x" khÃ´ng pháº£n Ã¡nh sáº£n pháº©m thá»±c táº¿ mÃ  lÃ  phÃ­ váº­n chuyá»ƒn, khuyáº¿n mÃ£i hoáº·c mÃ£ há»‡ thá»‘ng.

- NhÃ³m cÃ³ mÃ£ "DOT" gá»“m 710 dÃ²ng, mÃ´ táº£ lÃ  "DOTCOM POSTAGE" â†’ chá»‰ lÃ  phÃ­ váº­n chuyá»ƒn, khÃ´ng nÃªn tÃ­nh vÃ o RFM.

- Viá»‡c giá»¯ láº¡i cÃ¡c dÃ²ng nÃ y sáº½ lÃ m sai lá»‡ch chá»‰ sá»‘ Frequency vÃ  Monetary, áº£nh hÆ°á»Ÿng Ä‘áº¿n phÃ¢n cá»¥m.

- **Äá» xuáº¥t:** NÃªn kiá»ƒm tra vÃ  loáº¡i bá» cÃ¡c mÃ£ báº¥t thÆ°á»ng trÆ°á»›c khi tÃ­nh RFM Ä‘á»ƒ káº¿t quáº£ pháº£n Ã¡nh Ä‘Ãºng hÃ nh vi mua sáº¯m thá»±c cá»§a khÃ¡ch hÃ ng.

 **Stock Code**

- **Include** ğŸŸ¢ â†’ Giá»¯ láº¡i Ä‘á»ƒ phÃ¢n tÃ­ch hoáº·c clustering.  
- **Exclude** âŒ â†’ Loáº¡i bá» hoÃ n toÃ n, khÃ´ng dÃ¹ng Ä‘á»ƒ phÃ¢n tÃ­ch.  
- **Exclude from clustering** ğŸš« â†’ KhÃ´ng dÃ¹ng Ä‘á»ƒ phÃ¢n nhÃ³m nhÆ°ng cÃ³ thá»ƒ tham kháº£o.  
- **Exclude for now** â³ â†’ Táº¡m loáº¡i bá», cÃ³ thá»ƒ xem xÃ©t láº¡i sau. 

- **StockCode** is meant to follow the pattern `[0-9]{5}` but seems to have legit values for `[0-9]{5}[a-zA-Z]+`.  
&nbsp;&nbsp;&nbsp;&nbsp; **Also contains other values:** 



| Code             | Description                                                                 | Action                      |
|------------------|-----------------------------------------------------------------------------|-----------------------------|
| POST            | Not listed previously, likely a postage-related transaction               | Exclude for now             |
| D               | Looks valid, represents discount values                                    | Exclude from clustering     |
| C2              | Carriage transaction - not sure what this means                           | Exclude from clustering     |
| DOT             | Looks valid, represents postage charges                                   | Exclude from clustering     |
| M or m          | Looks valid, represents manual transactions                               | Exclude from clustering     |
| BANK CHARGES or B | Bank charges                                                           | Exclude from clustering     |
| S               | Samples sent to customer                                                 | Exclude from clustering     |
| AMAZONFEE       | Looks like fees for Amazon shipping or something                         | Exclude for now             |
| DCGS0076        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| DCGS0003        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| gift_0001_40    | Purchases with gift cards, might be interesting for another analysis, but no customer data | Exclude |
| DCGS0070        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| m               | Looks valid, represents manual transactions                              | Exclude from clustering     |
| gift_0001_50    | Purchases with gift cards, might be interesting for another analysis, but no customer data | Exclude |
| gift_0001_30    | Purchases with gift cards, might be interesting for another analysis, but no customer data | Exclude |
| gift_0001_20    | Purchases with gift cards, might be interesting for another analysis, but no customer data | Exclude |
| DCGS0055        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| DCGS0072        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| DCGS0074        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| DCGS0069        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| DCGS0057        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| DCGSSBOY        | Possible category or bundle-related code                                 | Exclude for now             |
| DCGSSGIRL       | Possible category or bundle-related code                                 | Exclude for now             |
| gift_0001_10    | Purchases with gift cards, might be interesting for another analysis, but no customer data | Exclude |
| PADS            | Looks like a legit stock code for padding                                | Include                     |
| DCGS0004        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| DCGS0073        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| DCGS0071        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| DCGS0068        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| DCGS0067        | Variant of DCGS, likely falls under the same category                    | Exclude from clustering     |
| DCGS0066P       | Variant of DCGS, possibly a special category                            | Exclude from clustering     |
| B               | Bank charges                                                             | Exclude from clustering     |
| CRUK            | Unknown, possibly a charity-related code                                | Exclude for now             |


## **3.2 Tiá»n xá»­ lÃ½ dá»¯ liá»‡u**
```{r}
# Chuyá»ƒn InvoiceDate thÃ nh kiá»ƒu Date
df$InvoiceDate <- as.Date(df$InvoiceDate)
str(df)
```

- ÄÃ£ chuáº©n cá»™t `InvoiceDate` hÃ³a thÃ nh kiá»ƒu Date, ráº¥t quan trá»ng Ä‘á»ƒ tÃ­nh Recency. Hiá»ƒn thá»‹ Ä‘Ãºng format yyyy-mm-dd.

```{r}
# 1. GÃ¡n láº¡i df gá»‘c
df_cleaned <- df
# Loáº¡i bá» toÃ n bá»™ dÃ²ng chá»©a báº¥t ká»³ kÃ½ tá»± KHÃ”NG PHáº¢I sá»‘ (0â€“9)
df_cleaned <- df_cleaned[grepl("^[0-9]+$", df_cleaned$InvoiceNo), ]

```

```{r}
# Kiá»ƒm tra cÃ²n chá»¯ cÃ¡i khÃ´ng?
any(grepl("[A-Za-z]", df_cleaned$InvoiceNo))  # Pháº£i tráº£ FALSE

# Kiá»ƒm tra cÃ²n kÃ½ tá»± Ä‘áº·c biá»‡t khÃ´ng?
any(grepl("[^0-9]", df_cleaned$InvoiceNo))    # Pháº£i tráº£ FALSE
```

- Äoáº¡n xá»­ lÃ½ nÃ y thá»ƒ hiá»‡n sá»± tháº­n trá»ng vÃ  hiá»ƒu rÃµ nghiá»‡p vá»¥ trong phÃ¢n tÃ­ch dá»¯ liá»‡u. Báº±ng cÃ¡ch loáº¡i bá» cÃ¡c hÃ³a Ä‘Æ¡n bá»‹ há»§y hoáº·c Ä‘iá»u chá»‰nh, nhÃ³m Ä‘Ã£ Ä‘áº£m báº£o ráº±ng táº­p dá»¯ liá»‡u Ä‘áº§u vÃ o cho phÃ¢n tÃ­ch RFM vÃ  phÃ¢n cá»¥m lÃ  sáº¡ch, chÃ­nh xÃ¡c vÃ  pháº£n Ã¡nh Ä‘Ãºng hÃ nh vi mua hÃ ng thá»±c táº¿. ÄÃ¢y lÃ  bÆ°á»›c báº¯t buá»™c vÃ  cá»±c ká»³ quan trá»ng trong toÃ n bá»™ quy trÃ¬nh phÃ¢n tÃ­ch khÃ¡ch hÃ ng.

```{r message=FALSE}
# Táº¡o Ä‘iá»u kiá»‡n giá»¯ láº¡i cÃ¡c StockCode há»£p lá»‡:
mask <- grepl("^\\d{5,6}$", df_cleaned$StockCode) |           # ToÃ n sá»‘, 5-6 chá»¯ sá»‘
        grepl("^\\d{5}[A-Za-z]$", df_cleaned$StockCode) |     # 5 sá»‘ + 1 chá»¯ cÃ¡i
        df_cleaned$StockCode == "APADSS"                      # MÃ£ Ä‘áº·c biá»‡t

# Ãp dá»¥ng lá»c
df_cleaned <- df_cleaned[mask, ]

df_cleaned
```
- Lá»c vÃ  giá»¯ láº¡i cÃ¡c mÃ£ StockCode cÃ³ Ä‘á»‹nh dáº¡ng há»£p lá»‡, loáº¡i bá» cÃ¡c mÃ£ há»‡ thá»‘ng khÃ´ng pháº£n Ã¡nh sáº£n pháº©m thá»±c táº¿ nhÆ°: phÃ­ ship, khuyáº¿n mÃ£i, Ä‘iá»u chá»‰nh,...

- Chi tiáº¿t:
  - ^\\d{5,6}$: Giá»¯ cÃ¡c mÃ£ toÃ n sá»‘, gá»“m 5 hoáº·c 6 chá»¯ sá»‘, vÃ­ dá»¥: "84029" hoáº·c "84563"

  - ^\\d{5}[A-Za-z]$: Giá»¯ mÃ£ cÃ³ 5 chá»¯ sá»‘ kÃ¨m 1 chá»¯ cÃ¡i, vÃ­ dá»¥: "85123A" â€“ cÃ¡c mÃ£ nÃ y váº«n cÃ³ thá»ƒ Ä‘áº¡i diá»‡n cho sáº£n pháº©m tháº­t.

  - == "APADSS": Má»™t mÃ£ sáº£n pháº©m Ä‘áº·c biá»‡t cÃ³ Ã½ nghÄ©a nghiá»‡p vá»¥, Ä‘Æ°á»£c giá»¯ láº¡i thá»§ cÃ´ng
  
```{r}
sum(is.na(df$CustomerID))  # Ä‘áº¿m sá»‘ dÃ²ng bá»‹ thiáº¿u
```

- Viá»‡c loáº¡i bá» 135,080 dÃ²ng thiáº¿u CustomerID lÃ  hoÃ n toÃ n cáº§n thiáº¿t vÃ  chÃ­nh xÃ¡c, giÃºp Ä‘áº£m báº£o Ä‘á»™ tin cáº­y vÃ  há»£p lá»‡ cho toÃ n bá»™ phÃ¢n tÃ­ch tiáº¿p theo.

```{r}
# XÃ³a cÃ¡c dÃ²ng cÃ³ NA á»Ÿ cá»™t CustomerID
df_cleaned <- df_cleaned[!is.na(df_cleaned$CustomerID), ]

nrow(df) - nrow(df_cleaned)  # sá»‘ dÃ²ng Ä‘Ã£ bá»‹ xÃ³a

colSums(is.na(df_cleaned))
```

- Sau khi tiáº¿n hÃ nh xÃ³a 145.830dÃ²ng vÃ  táº­p dá»¯ liá»‡u khÃ´ng cÃ²n giÃ¡ trá»‹ thiáº¿u lÃ  Ä‘á»§ lá»›n, phÃ¹ há»£p Ä‘á»ƒ tiáº¿n hÃ nh xÃ¢y dá»±ng mÃ´ hÃ¬nh RFM vÃ  phÃ¢n cá»¥m khÃ¡ch hÃ ng

```{r}
# thá»‘ng kÃª data sau khi drop na
summary(df_cleaned)

```

Nháº­n xÃ©t:

- Dá»¯ liá»‡u sau lÃ m sáº¡ch bao gá»“m 396,079 dÃ²ng giao dá»‹ch há»£p lá»‡, vá»›i 8 trÆ°á»ng thÃ´ng tin. Káº¿t quáº£ thá»‘ng kÃª mÃ´ táº£ cho tháº¥y:

- CÃ¡c cá»™t Ä‘á»‹nh danh nhÆ° InvoiceNo, StockCode, Description, Country Ä‘á»u cÃ³ kiá»ƒu dá»¯ liá»‡u phÃ¹ há»£p vÃ  khÃ´ng phÃ¡t hiá»‡n lá»—i Ä‘á»‹nh dáº¡ng.

- Thá»i gian giao dá»‹ch tráº£i dÃ i tá»« 01/12/2010 Ä‘áº¿n 09/12/2011, Ä‘á»§ Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ hÃ nh vi mua hÃ ng theo thá»i gian (Recency).

- CustomerID Ä‘Ã£ Ä‘Æ°á»£c loáº¡i bá» Ä‘áº§y Ä‘á»§ cÃ¡c giÃ¡ trá»‹ thiáº¿u (NA) vÃ  phÃ¢n bá»‘ há»£p lá»‡ tá»« 12,346 Ä‘áº¿n 18,287.

- UnitPrice cÃ³ giÃ¡ trá»‹ báº±ng 0, khÃ´ng há»£p lá»‡ trong phÃ¢n tÃ­ch chi tiÃªu (Monetary) â†’ nÃªn loáº¡i bá» hoáº·c xá»­ lÃ½ tÃ¹y ngá»¯ cáº£nh.


```{r}
# kiá»ƒm tra giÃ¡ trá»‹ báº±ng 0 cá»§a col 'UnitPrice'
sum(df_cleaned$UnitPrice == 0)
# chá»‰ láº¥y giÃ¡ trá»‹ khÃ¡c 0 
df_cleaned <- df_cleaned[df_cleaned$UnitPrice > 0, ]
#Kiá»ƒm tra 
summary(df_cleaned)

```

- Kiá»ƒm tra vÃ  loáº¡i bá» cÃ¡c dÃ²ng dá»¯ liá»‡u cÃ³ giÃ¡ trá»‹ UnitPrice = 0, vÃ¬ Ä‘Ã¢y khÃ´ng pháº£i lÃ  giao dá»‹ch mua bÃ¡n há»£p lá»‡ vÃ  cÃ³ thá»ƒ lÃ m sai lá»‡ch chá»‰ sá»‘ Monetary trong phÃ¢n tÃ­ch RFM.

- Káº¿t quáº£ kiá»ƒm tra:

  - Sá»‘ lÆ°á»£ng dÃ²ng cÃ³ UnitPrice = 0: 33 dÃ²ng

  - Sau khi lá»c, dá»¯ liá»‡u cÃ²n láº¡i: 396,046 dÃ²ng (giáº£m tá»« 396,079)
- Nháº­n xÃ©t: 

  - Máº·c dÃ¹ sá»‘ dÃ²ng bá»‹ loáº¡i khÃ¡ nhá» (< 0.01% tá»•ng dá»¯ liá»‡u), nhÆ°ng viá»‡c lá»c bá» lÃ  cáº§n thiáº¿t vÃ¬:

    - Nhá»¯ng dÃ²ng nÃ y khÃ´ng pháº£n Ã¡nh chi tiÃªu thá»±c táº¿.

    - GÃ¢y sai sá»‘ khi tÃ­nh tá»•ng chi tiÃªu (Monetary) vÃ  phÃ¢n cá»¥m theo giÃ¡ trá»‹ mua hÃ ng.



```{r}
#TÃ­nh tá»· lá»‡ pháº§n trÄƒm sá»‘ dÃ²ng cÃ²n láº¡i trong df_cleaned so vá»›i tá»•ng sá»‘ dÃ²ng ban Ä‘áº§u trong df.
sprintf("%.2f%%", nrow(df_cleaned) / nrow(df) * 100)
```

  - Vá»›i tá»· lá»‡ giá»¯ láº¡i hÆ¡n 73% dá»¯ liá»‡u gá»‘c, táº­p dá»¯ liá»‡u df_cleaned váº«n Ä‘á»§ lá»›n vÃ  Ä‘á»§ Ä‘a dáº¡ng Ä‘á»ƒ tiáº¿p tá»¥c phÃ¢n tÃ­ch khÃ¡ch hÃ ng má»™t cÃ¡ch tin cáº­y, Ä‘áº£m báº£o Ä‘áº§u vÃ o cháº¥t lÆ°á»£ng cho mÃ´ hÃ¬nh RFM â€“ KMeans â€“ DBSCAN.

```{r echo=FALSE}
## Truc quan hoa
# So dong ban dau va sau khi lam sach
total_rows <- nrow(df)
cleaned_rows <- nrow(df_cleaned)
removed_rows <- total_rows - cleaned_rows

# Tao dataframe de ve
summary_df <- data.frame(
  status = c("Giu lai", "Da loai"),
  quantity = c(cleaned_rows, removed_rows)
)

# Ve bieu do
barplot(
  summary_df$quantity,
  names.arg = summary_df$status,
  col = c("skyblue", "salmon"),
  main = "So sanh so dong truoc va sau khi lam sach",
  ylab = "So dong",
  ylim = c(0, max(summary_df$quantity) * 1.1)
)

# Hien thi so lieu tren cot
text(
  x = c(1, 2),
  y = summary_df$quantity,
  labels = summary_df$quantity,
  pos = 3,
  cex = 1.2
)

```

**Nháº­n xÃ©t tá»« biá»ƒu Ä‘á»“ so sÃ¡nh sá»‘ dÃ²ng trÆ°á»›c vÃ  sau khi lÃ m sáº¡ch:**

- Tá»•ng sá»‘ dÃ²ng ban Ä‘áº§u: 541,909 dÃ²ng

- Sá»‘ dÃ²ng giá»¯ láº¡i sau khi lÃ m sáº¡ch (df_cleaned): 396,046 dÃ²ng

- Sá»‘ dÃ²ng bá»‹ loáº¡i bá»: 145,863 dÃ²ng, chiáº¿m khoáº£ng 26.92%

*ÄÃ¡nh giÃ¡:*

- Tá»· lá»‡ dá»¯ liá»‡u bá»‹ loáº¡i khÃ¡ cao (~27%), chá»§ yáº¿u do:

  - Thiáº¿u mÃ£ khÃ¡ch hÃ ng (CustomerID)

  - Giao dá»‹ch cÃ³ Ä‘Æ¡n giÃ¡ báº±ng 0 (UnitPrice = 0)

  - MÃ£ hÃ³a Ä‘Æ¡n (InvoiceNo) hoáº·c mÃ£ sáº£n pháº©m (StockCode) khÃ´ng há»£p lá»‡

- viá»‡c loáº¡i bá» lÃ  cáº§n thiáº¿t Ä‘á»ƒ Ä‘áº£m báº£o:

  - Má»—i dÃ²ng giao dá»‹ch pháº£n Ã¡nh Ä‘Ãºng hÃ nh vi thá»±c cá»§a khÃ¡ch hÃ ng

  - MÃ´ hÃ¬nh RFM khÃ´ng bá»‹ sai lá»‡ch do dá»¯ liá»‡u nhiá»…u, lá»—i nháº­p liá»‡u

##  **3.3 PhÃ¢n tÃ­ch hÃ nh vi khÃ¡ch hÃ ng báº±ng mÃ´ hÃ¬nh RFM**


```{r}
# táº¡o cá»™t tá»•ng chi tiÃªu lÃ m Monetary (tá»•ng chi tiÃªu)
df_cleaned$SalesLineTotal <- df_cleaned$Quantity * df_cleaned$UnitPrice
# Hiá»ƒn thá»‹ káº¿t quáº£
print(df_cleaned, width = Inf)
```

Nháº­n xÃ©t - Táº¡o cá»™t chi tiÃªu (SalesLineTotal)

- Cá»™t SalesLineTotal Ä‘Æ°á»£c tÃ­nh báº±ng: Quantity * UnitPrice â†’ ÄÃ¢y lÃ  tá»•ng sá»‘ tiá»n cá»§a má»—i dÃ²ng giao dá»‹ch (1 dÃ²ng = 1 sáº£n pháº©m * sá»‘ lÆ°á»£ng trong 1 hÃ³a Ä‘Æ¡n).

- Biáº¿n má»›i SalesLineTotal Ä‘Ã£ Ä‘Æ°á»£c tÃ­nh chÃ­nh xÃ¡c vÃ  thÃªm vÃ o báº£ng df_cleaned.

Ã nghÄ©a:

- Cá»™t nÃ y sáº½ Ä‘Ã³ng vai trÃ² lÃ m biáº¿n Monetary trong mÃ´ hÃ¬nh RFM (tá»•ng chi tiÃªu cá»§a khÃ¡ch hÃ ng).

- ÄÃ¢y lÃ  bÆ°á»›c quan trá»ng Ä‘á»ƒ sau Ä‘Ã³ cÃ³ thá»ƒ tá»•ng há»£p tá»•ng chi tiÃªu theo tá»«ng CustomerID.


```{r}
aggregated_df <- summarise(
  group_by(df_cleaned, CustomerID),
  MonetaryValue = sum(SalesLineTotal, na.rm = TRUE),
  Frequency = n_distinct(InvoiceNo),
  LastInvoiceDate = max(InvoiceDate)
)
```

Nháº­n xÃ©t:

- group_by(df_cleaned, CustomerID): NhÃ³m dá»¯ liá»‡u theo tá»«ng khÃ¡ch hÃ ng (CustomerID) â€“ má»—i nhÃ³m tÆ°Æ¡ng á»©ng má»™t khÃ¡ch.

- summarise(...): TÃ­nh toÃ¡n cho tá»«ng nhÃ³m:

- MonetaryValue: Tá»•ng giÃ¡ trá»‹ Ä‘Æ¡n hÃ ng (SalesLineTotal) cá»§a khÃ¡ch. na.rm = TRUE giÃºp bá» qua giÃ¡ trá»‹ thiáº¿u.

- Frequency: Äáº¿m sá»‘ hÃ³a Ä‘Æ¡n khÃ¡c nhau (InvoiceNo) â€“ biá»ƒu hiá»‡n cho sá»‘ láº§n mua hÃ ng.

- LastInvoiceDate: NgÃ y mua hÃ ng cuá»‘i cÃ¹ng cá»§a khÃ¡ch (dÃ¹ng Ä‘á»ƒ tÃ­nh Recency)

```{r}
# TÃ­nh Recency
analysis_date <- as.Date(max(df_cleaned$InvoiceDate))
aggregated_df$Recency <- as.numeric(analysis_date - aggregated_df$LastInvoiceDate)

print(aggregated_df, width = Inf)

```
Nháº­n xÃ©t: 

Dá»¯ liá»‡u sau khi tá»•ng há»£p theo CustomerID Ä‘Ã£ tÃ­nh Ä‘Æ°á»£c Ä‘áº§y Ä‘á»§ 3 chá»‰ sá»‘ RFM:

- **MonetaryValue:** Tá»•ng sá»‘ tiá»n mÃ  má»—i khÃ¡ch hÃ ng Ä‘Ã£ chi tiÃªu, Ä‘Æ°á»£c tÃ­nh báº±ng tá»•ng cá»§a Quantity * UnitPrice. CÃ¡c giÃ¡ trá»‹ Monetary cho tháº¥y sá»± chÃªnh lá»‡ch rÃµ rá»‡t giá»¯a cÃ¡c khÃ¡ch hÃ ng. VÃ­ dá»¥, khÃ¡ch hÃ ng 12346 chá»‰ mua 1 láº§n nhÆ°ng chi Ä‘áº¿n 77,183.60, trong khi cÃ¡c khÃ¡ch hÃ ng khÃ¡c mua nhiá»u láº§n hÆ¡n nhÆ°ng giÃ¡ trá»‹ nhá» hÆ¡n.

- **Frequency:** Sá»‘ lÆ°á»£ng giao dá»‹ch khÃ¡c nhau (InvoiceNo) mÃ  má»—i khÃ¡ch hÃ ng Ä‘Ã£ thá»±c hiá»‡n. KhÃ¡ch hÃ ng 12347 cÃ³ táº§n suáº¥t mua hÃ ng cao (7 láº§n), cho tháº¥y má»©c Ä‘á»™ quay láº¡i cao vÃ  cÃ³ thá»ƒ lÃ  khÃ¡ch hÃ ng trung thÃ nh.

- **Recency:** Khoáº£ng cÃ¡ch ngÃ y giá»¯a láº§n mua gáº§n nháº¥t cá»§a khÃ¡ch hÃ ng vÃ  ngÃ y phÃ¢n tÃ­ch cuá»‘i cÃ¹ng (ngÃ y giao dá»‹ch gáº§n nháº¥t trong táº­p dá»¯ liá»‡u). KhÃ¡ch hÃ ng cÃ³ giÃ¡ trá»‹ Recency tháº¥p nhÆ° 12347 (Recency = 2) cÃ³ nghÄ©a lÃ  há» má»›i mua hÃ ng gáº§n Ä‘Ã¢y, trong khi nhá»¯ng ngÆ°á»i cÃ³ Recency cao nhÆ° 12346 (325 ngÃ y) cÃ³ thá»ƒ Ä‘Ã£ rá»i Ä‘i lÃ¢u.


```{r echo=FALSE}
# Thiáº¿t láº­p bá»‘ cá»¥c 1 hÃ ng 3 biá»ƒu Ä‘á»“
par(mfrow = c(1, 3), mar = c(4, 4, 3, 1))  # 1 dÃ²ng, 3 cá»™t

# Biá»ƒu Ä‘á»“ 1: Monetary Value
hist(aggregated_df$MonetaryValue,
     breaks = 10,
     col = "skyblue",
     border = "red",
     main = "Monetary Value Distribution",
     xlab = "Monetary Value",
     ylab = "Count")

# Biá»ƒu Ä‘á»“ 2: Frequency
hist(aggregated_df$Frequency,
     breaks = 10,
     col = "lightgreen",
     border = "red",
     main = "Frequency Distribution",
     xlab = "Frequency",
     ylab = "Count")

# Biá»ƒu Ä‘á»“ 3: Recency
hist(aggregated_df$Recency,
     breaks = 20,
     col = "yellow",
     border = "red",
     main = "Recency Distribution",
     xlab = "Recency",
     ylab = "Count")

# Reset layout vá» máº·c Ä‘á»‹nh (1 biá»ƒu Ä‘á»“/khung)
par(mfrow = c(1, 1))
```
**Nháº­n xÃ©t**

  - **Monetary Value Distribution (GiÃ¡ trá»‹ chi tiÃªu):**
  
      * PhÃ¢n bá»‘ ráº¥t lá»‡ch pháº£i (right-skewed).

      * Pháº§n lá»›n khÃ¡ch hÃ ng cÃ³ tá»•ng chi tiÃªu (Monetary) ráº¥t tháº¥p (Ä‘a sá»‘ < 10,000).

      * Chá»‰ má»™t sá»‘ Ã­t khÃ¡ch chi tiÃªu ráº¥t cao (cÃ³ giÃ¡ trá»‹ tá»›i 250,000+), táº¡o ra outlier ráº¥t máº¡nh.
      
  - **Káº¿t luáº­n:**
    
      * Táº­p khÃ¡ch hÃ ng cÃ³ sá»± khÃ¡c biá»‡t lá»›n vá» giÃ¡ trá»‹ â€“ phÃ¹ há»£p Ä‘á»ƒ phÃ¢n nhÃ³m (clustering).
    
      * NÃªn xem xÃ©t log-transform hoáº·c winsorizing trÆ°á»›c khi dÃ¹ng cho mÃ´ hÃ¬nh.
    
  - **Frequency Distribution (Táº§n suáº¥t mua hÃ ng):**

      * Cá»±c ká»³ lá»‡ch pháº£i: gáº§n nhÆ° táº¥t cáº£ khÃ¡ch chá»‰ mua 1â€“2 láº§n.

      * Ráº¥t Ã­t khÃ¡ch hÃ ng mua tá»« 10 láº§n trá»Ÿ lÃªn (hiáº¿m cÃ³ >50).

      * Má»™t vÃ i giÃ¡ trá»‹ lá»›n (outlier) váº«n tá»“n táº¡i.

  - **Káº¿t luáº­n:**
  
      * Pháº§n lá»›n khÃ¡ch hÃ ng khÃ´ng trung thÃ nh â†’ chá»‰ mua 1 láº§n.

      * Ráº¥t cáº§n phÃ¡t triá»ƒn nhÃ³m khÃ¡ch â€œfrequent buyersâ€ (náº¿u muá»‘n tÄƒng CLV).

      * CÃ³ thá»ƒ táº¡o chÃ­nh sÃ¡ch Æ°u Ä‘Ã£i táº§n suáº¥t cho nhÃ³m tiá»m nÄƒng.

  - **Recency Distribution (Khoáº£ng thá»i gian ká»ƒ tá»« láº§n mua gáº§n nháº¥t):**

      * PhÃ¢n bá»‘ cÅ©ng lá»‡ch trÃ¡i.

      * Nhiá»u khÃ¡ch hÃ ng má»›i mua gáº§n Ä‘Ã¢y (Recency tháº¥p) â†’ táº­p trung á»Ÿ khoáº£ng 0â€“50 ngÃ y.

      * CÃ ng xa (Recency cao), sá»‘ lÆ°á»£ng khÃ¡ch giáº£m dáº§n â†’ biá»ƒu hiá»‡n tá»‘t.

  - **Káº¿t luáº­n:**
  
      * CÃ³ nhiá»u khÃ¡ch hÃ ng má»›i hoáº¡t Ä‘á»™ng gáº§n Ä‘Ã¢y.

      * CÆ¡ há»™i ráº¥t tá»‘t Ä‘á»ƒ cháº¡y láº¡i remarketing hoáº·c tÃ¡i kÃ­ch hoáº¡t khÃ¡ch cÅ©.

      * Táº­p khÃ¡ch cÅ© (Recency > 250) cÃ³ thá»ƒ lÃ  khÃ¡ch rá»i bá».
      
**Kiá»ƒm tra outlier**

```{r }
data_outliers <- aggregated_df
```

```{r echo=FALSE}
# Äáº·t layout: 1 hÃ ng, 3 biá»ƒu Ä‘á»“
par(mfrow = c(1, 3), mar = c(4, 4, 3, 1))

# Boxplot 1: MonetaryValue
boxplot(aggregated_df$MonetaryValue,
        col = "skyblue",
        main = "Monetary Value Boxplot",
        xlab = "Monetary Value")

# Boxplot 2: Frequency
boxplot(aggregated_df$Frequency,
        col = "lightgreen",
        main = "Frequency Boxplot",
        xlab = "Frequency")

# Boxplot 3: Recency
boxplot(aggregated_df$Recency,
        col = "salmon",
        main = "Recency Boxplot",
        xlab = "Recency")

# Reset láº¡i layout vá» máº·c Ä‘á»‹nh (1 biá»ƒu Ä‘á»“)
par(mfrow = c(1, 1))
```

**Monetary Value Boxplot (Tá»•ng chi tiÃªu):**

- PhÃ¢n bá»‘ cÃ³ ráº¥t nhiá»u outlier (giÃ¡ trá»‹ ngoáº¡i lá»‡) vá»›i chi tiÃªu ráº¥t cao.

-  Háº§u háº¿t khÃ¡ch hÃ ng cÃ³ má»©c chi tiÃªu tháº¥p, trong khi má»™t sá»‘ Ã­t cÃ³ giÃ¡ trá»‹ chi tiÃªu vÆ°á»£t trá»™i, dá»… gÃ¢y áº£nh hÆ°á»Ÿng Ä‘áº¿n trung bÃ¬nh.

- Äiá»u nÃ y gá»£i Ã½ nÃªn cÃ¢n nháº¯c chuáº©n hÃ³a hoáº·c cáº¯t ngÆ°á»¡ng Ä‘á»ƒ giáº£m áº£nh hÆ°á»Ÿng cá»§a outlier trong phÃ¢n cá»¥m.

**Frequency Boxplot (Táº§n suáº¥t mua hÃ ng):**

- CÅ©ng cÃ³ nhiá»u outlier, vá»›i má»™t sá»‘ khÃ¡ch hÃ ng cÃ³ sá»‘ láº§n mua hÃ ng lÃªn Ä‘áº¿n hÆ¡n 200 láº§n.

- Tuy nhiÃªn, pháº§n lá»›n khÃ¡ch hÃ ng mua dÆ°á»›i 10 láº§n.

- TÃ¬nh tráº¡ng phÃ¢n bá»‘ khÃ´ng Ä‘á»u, cho tháº¥y cáº§n xá»­ lÃ½ outlier náº¿u dÃ¹ng mÃ´ hÃ¬nh phÃ¢n cá»¥m.

**Recency Boxplot (Khoáº£ng cÃ¡ch thá»i gian mua hÃ ng gáº§n nháº¥t):**

- Ãt outlier hÆ¡n so vá»›i 2 chá»‰ sá»‘ trÃªn.

- Trung vá»‹ Recency tháº¥p, cho tháº¥y nhiá»u khÃ¡ch hÃ ng váº«n hoáº¡t Ä‘á»™ng gáº§n Ä‘Ã¢y.

- Tuy váº­y, cÅ©ng cÃ³ má»™t sá»‘ khÃ¡ch hÃ ng khÃ´ng mua hÃ ng trong thá»i gian dÃ i.


```{r}
# TÃ­nh Q1, Q3 vÃ  IQR cho MonetaryValue
M_Q1 <- quantile(aggregated_df$MonetaryValue, 0.25)
M_Q3 <- quantile(aggregated_df$MonetaryValue, 0.75)
M_IQR <- M_Q3 - M_Q1

# Lá»c cÃ¡c dÃ²ng lÃ  outlier
monetary_outliers_df <- aggregated_df[
  aggregated_df$MonetaryValue < (M_Q1 - 1.5 * M_IQR) |
  aggregated_df$MonetaryValue > (M_Q3 + 1.5 * M_IQR),
]

# Xem mÃ´ táº£ dá»¯ liá»‡u outlier
summary(monetary_outliers_df)

```

**Dá»±a trÃªn báº£ng thá»‘ng kÃª cá»§a summary(monetary_outliers_df):**

- CÃ³ nhá»¯ng khÃ¡ch hÃ ng chi tiÃªu ráº¥t cao, MonetaryValue lÃªn tá»›i 279138, vÆ°á»£t xa giÃ¡ trá»‹ trung bÃ¬nh chung.

- Median chi tiÃªu cá»§a outlier lÃ  5888, trong khi min = 3615 â†’ outlier á»Ÿ Ä‘Ã¢y chá»§ yáº¿u lÃ  giÃ¡ trá»‹ chi tiÃªu cao.

- Táº§n suáº¥t mua hÃ ng (Frequency) váº«n á»Ÿ má»©c bÃ¬nh thÆ°á»ng, khÃ´ng cÃ³ giÃ¡ trá»‹ cá»±c Ä‘oan.

- Recency (gáº§n nháº¥t) cÅ©ng Ä‘a dáº¡ng: tá»« 0 Ä‘áº¿n 372 â†’ CÃ³ cáº£ khÃ¡ch hÃ ng má»›i vÃ  cÅ© trong nhÃ³m outlier.

```{r}
# TÃ­nh Q1, Q3 vÃ  IQR cho Frequency
F_Q1 <- quantile(aggregated_df$Frequency, 0.25)
F_Q3 <- quantile(aggregated_df$Frequency, 0.75)
F_IQR <- F_Q3 - F_Q1

# Lá»c cÃ¡c dÃ²ng lÃ  outlier theo Frequency
frequency_outliers_df <- aggregated_df[
  aggregated_df$Frequency < (F_Q1 - 1.5 * F_IQR) |
  aggregated_df$Frequency > (F_Q3 + 1.5 * F_IQR),
]

# Thá»‘ng kÃª dá»¯ liá»‡u outlier
summary(frequency_outliers_df)

```
**Nháº­n xÃ©t vá» Frequency Outliers**

- **Má»¥c tiÃªu Ä‘oáº¡n mÃ£:**

  - XÃ¡c Ä‘á»‹nh cÃ¡c Ä‘iá»ƒm ngoáº¡i lai (outliers) trong cá»™t Frequency báº±ng phÆ°Æ¡ng phÃ¡p IQR (Interquartile Range).

  - CÃ¡c khÃ¡ch hÃ ng cÃ³ sá»‘ lÆ°á»£ng giao dá»‹ch quÃ¡ cao so vá»›i má»©c phá»• biáº¿n sáº½ bá»‹ coi lÃ  outlier.

- **Káº¿t quáº£ lá»c:**

  - Dá»¯ liá»‡u sau khi lá»c chá»‰ cÃ²n nhá»¯ng khÃ¡ch hÃ ng cÃ³ sá»‘ giao dá»‹ch cao báº¥t thÆ°á»ng (tá»« 12 Ä‘áº¿n 206 láº§n).

  - Median Frequency = 17, 75% khÃ¡ch hÃ ng trong táº­p nÃ y cÃ³ Frequency â‰¤ 25.

  - Tuy nhiÃªn, sá»‘ lÆ°á»£ng khÃ¡ch hÃ ng nhÆ° váº­y khÃ´ng nhiá»u (chá»‰ lÃ  táº­p nhá» so vá»›i toÃ n bá»™ dá»¯ liá»‡u).

```{r}
# Loáº¡i bá» outlier báº±ng cÃ¡ch giá»¯ láº¡i cÃ¡c dÃ²ng KHÃ”NG náº±m trong monetary vÃ  frequency outliers

# Láº¥y chá»‰ sá»‘ hÃ ng (index) cáº§n loáº¡i bá»
outlier_indices <- union(
  which(aggregated_df$MonetaryValue < (M_Q1 - 1.5 * M_IQR) | aggregated_df$MonetaryValue > (M_Q3 + 1.5 * M_IQR)),
  which(aggregated_df$Frequency < (F_Q1 - 1.5 * F_IQR) | aggregated_df$Frequency > (F_Q3 + 1.5 * F_IQR))
)

# Giá»¯ láº¡i cÃ¡c dÃ²ng khÃ´ng náº±m trong chá»‰ sá»‘ outlier
non_outliers_df <- aggregated_df[-outlier_indices, ]

# Kiá»ƒm tra láº¡i
summary(non_outliers_df)

```

**Giáº£i thÃ­ch:**
 
- M_Q1, M_Q3, M_IQR: láº§n lÆ°á»£t lÃ  Q1, Q3 vÃ  khoáº£ng IQR cá»§a biáº¿n MonetaryValue (tÃ­nh trÆ°á»›c Ä‘Ã³).

- F_Q1, F_Q3, F_IQR: lÃ  Q1, Q3, IQR cá»§a biáº¿n Frequency.

- which(...): tráº£ vá» chá»‰ sá»‘ dÃ²ng (index) cá»§a cÃ¡c giÃ¡ trá»‹ lÃ  outlier.

- union(...): há»£p nháº¥t chá»‰ sá»‘ outlier cá»§a cáº£ hai biáº¿n MonetaryValue vÃ  Frequency Ä‘á»ƒ trÃ¡nh trÃ¹ng láº·p vÃ  táº¡o 1 danh sÃ¡ch duy nháº¥t cÃ¡c dÃ²ng cáº§n loáº¡i bá».

- Äiá»u kiá»‡n outlier theo IQR:

  - Báº¥t ká»³ giÃ¡ trá»‹ nÃ o < Q1 - 1.5 * IQR hoáº·c > Q3 + 1.5 * IQR Ä‘Æ°á»£c coi lÃ  outlier.
  
**Nháº­n xÃ©t:**

- **MonetaryValue:**

  - Min: 3.75, Max: 3613.63 â†’ loáº¡i bá» hoÃ n toÃ n cÃ¡c khÃ¡ch hÃ ng chi tiÃªu quÃ¡ tháº¥p hoáº·c quÃ¡ cao.

  - Mean vÃ  Median khÃ¡ gáº§n nhau â†’ phÃ¢n phá»‘i cÃ¢n báº±ng hÆ¡n sau khi loáº¡i outlier.

- **Frequency:**

  - Min: 1, Max: 11 â†’ táº§n suáº¥t mua hÃ ng khÃ´ng cÃ²n giÃ¡ trá»‹ cá»±c Ä‘áº¡i nhÆ° trÆ°á»›c (trÆ°á»›c Ä‘Ã³ lÃ  206).

- **Recency:**

  - Váº«n giá»¯ Ä‘Æ°á»£c giÃ¡ trá»‹ phÃ¢n tÃ¡n rá»™ng tá»« 0 Ä‘áº¿n 373 â†’ khÃ´ng bá»‹ loáº¡i bá» trong bÆ°á»›c nÃ y vÃ¬ khÃ´ng xá»­ lÃ½ outlier cho Recency.

```{r echo=FALSE}
# Trá»±c quan sau khi loáº¡i bá» 
# Chia khung hÃ¬nh ra 1 dÃ²ng 3 biá»ƒu Ä‘á»“
par(mfrow = c(1, 3), mar = c(4, 4, 3, 1))

# Boxplot 1: Monetary Value
boxplot(non_outliers_df$MonetaryValue,
        col = "skyblue",
        main = "Monetary Value Boxplot",
        xlab = "Monetary Value")

# Boxplot 2: Frequency
boxplot(non_outliers_df$Frequency,
        col = "lightgreen",
        main = "Frequency Boxplot",
        xlab = "Frequency")

# Boxplot 3: Recency
boxplot(non_outliers_df$Recency,
        col = "salmon",
        main = "Recency Boxplot",
        xlab = "Recency")

# Reset láº¡i layout vá» máº·c Ä‘á»‹nh
par(mfrow = c(1, 1))
```

**Nháº­n xÃ©t Boxplot sau khi loáº¡i bá» outlier:**

- **Monetary Value (GiÃ¡ trá»‹ chi tiÃªu):**

  - Sau khi loáº¡i bá» outlier, dá»¯ liá»‡u táº­p trung pháº§n lá»›n á»Ÿ khoáº£ng dÆ°á»›i 1000.

  - Tuy váº«n cÃ²n má»™t vÃ i giÃ¡ trá»‹ cao náº±m gáº§n ngÆ°á»¡ng cáº¯t trÃªn, nhÆ°ng khÃ´ng cÃ²n cá»±c trá»‹ quÃ¡ lá»›n (trÃªn 250,000 nhÆ° trÆ°á»›c Ä‘Ã³).

- **Frequency (Táº§n suáº¥t mua hÃ ng):**

  - Äa sá»‘ khÃ¡ch hÃ ng cÃ³ sá»‘ láº§n giao dá»‹ch tá»« 1 Ä‘áº¿n 4.

  - Má»™t vÃ i Ä‘iá»ƒm nhá» (váº«n lÃ  mild outliers) náº±m ngoÃ i whiskers nhÆ°ng ráº¥t Ã­t, cho tháº¥y dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c lÃ m sáº¡ch tÆ°Æ¡ng Ä‘á»‘i tá»‘t.

  - Median = 2 cho tháº¥y pháº§n lá»›n khÃ¡ch hÃ ng mua 1-2 láº§n.

- **Recency (Sá»‘ ngÃ y ká»ƒ tá»« láº§n mua cuá»‘i):**

  - PhÃ¢n bá»‘ tÆ°Æ¡ng Ä‘á»‘i Ä‘á»u hÆ¡n so vá»›i trÆ°á»›c, tuy nhiÃªn váº«n cÃ²n giÃ¡ trá»‹ cao trÃªn 300.

  - Pháº§n lá»›n khÃ¡ch hÃ ng mua trong vÃ²ng 100 ngÃ y gáº§n Ä‘Ã¢y.

  - Median khoáº£ng 59, tá»©c lÃ  má»™t ná»­a sá»‘ khÃ¡ch hÃ ng mua hÃ ng láº§n cuá»‘i cÃ¡ch thá»i Ä‘iá»ƒm phÃ¢n tÃ­ch 2 thÃ¡ng trá»Ÿ láº¡i.
<!-- # ```{r} -->
<!-- #  # Váº½ scatter plot 3D -->
<!-- #  plot_ly(non_outliers_df, -->
<!-- #          x = ~MonetaryValue, -->
<!-- #          y = ~Frequency, -->
<!-- #          z = ~Recency, -->
<!-- #          type = 'scatter3d', -->
<!-- #          mode = 'markers', -->
<!-- #          marker = list(size = 2, color = 'blue')) %>% -->
<!-- #    layout( -->
<!-- #      title = list(text = "3D Scatter Plot of Customer Data"), -->
<!-- #      scene = list( -->
<!-- #        xaxis = list(title = "Monetary"), -->
<!-- #        yaxis = list(title = "Frequency"), -->
<!-- #        zaxis = list(title = "Recency") -->
<!-- #      ) -->
<!-- #    ) -->
<!-- # -->
<!-- # ``` -->

```{r step14, echo=FALSE, fig.align='center', out.width='60%', fig.cap="3D Scatter Plot of Customer Data"}
knitr::include_graphics("images/newplot.png")

```

**Nháº­n xÃ©t biá»ƒu Ä‘á»“ 3D Scatter Plot of Customer Data:**

Biá»ƒu Ä‘á»“ thá»ƒ hiá»‡n phÃ¢n bá»‘ ba chá»‰ sá»‘ RFM (Recency â€“ Frequency â€“ Monetary) cá»§a táº­p khÃ¡ch hÃ ng sau khi loáº¡i bá» outlier:

- **Monetary (Trá»¥c X):**

  - Äa sá»‘ khÃ¡ch hÃ ng cÃ³ Monetary dÆ°á»›i 1000 (tá»©c lÃ  chi tiÃªu tháº¥p).

  - CÃ³ má»™t sá»‘ Ä‘iá»ƒm ráº£i rÃ¡c Ä‘áº¿n má»©c gáº§n 3500, tuy nhiÃªn khÃ´ng nhiá»u â†’ PhÃ¢n bá»‘ lá»‡ch pháº£i (skewed right).

- **Frequency (Trá»¥c Y):**

  - Háº§u háº¿t khÃ¡ch hÃ ng cÃ³ táº§n suáº¥t mua hÃ ng tháº¥p, chá»§ yáº¿u tá»« 1â€“4 láº§n.

  - Má»™t sá»‘ khÃ¡ch hÃ ng mua nhiá»u láº§n (tá»›i 10+), nhÆ°ng ráº¥t Ã­t â†’ TÆ°Æ¡ng tá»± lÃ  lá»‡ch pháº£i.

- **Recency (Trá»¥c Z):**

  - CÃ³ xu hÆ°á»›ng phÃ¢n tÃ¡n dá»c theo trá»¥c Recency.

  - KhÃ¡ch hÃ ng gáº§n Ä‘Ã¢y (Recency tháº¥p) táº­p trung nhiá»u hÆ¡n á»Ÿ vÃ¹ng gáº§n Monetary cao.

  - Nhá»¯ng ngÆ°á»i mua hÃ ng tá»« lÃ¢u (Recency cao, gáº§n 350 ngÃ y) cÃ³ xu hÆ°á»›ng chi tiÃªu Ã­t hÆ¡n.

```{r}
# Chuáº©n hÃ³a cÃ¡c cá»™t MonetaryValue, Frequency, Recency
scaled_data <- scale(non_outliers_df[, c("MonetaryValue", "Frequency", "Recency")])
```

**Má»¥c tiÃªu**

- Chuáº©n hÃ³a ba chá»‰ sá»‘ RFM (`MonetaryValue`, `Frequency`, `Recency`) báº±ng phÆ°Æ¡ng phÃ¡p z-score Ä‘á»ƒ Ä‘Æ°a vá» cÃ¹ng Ä‘Æ¡n vá»‹ thang Ä‘o, phá»¥c vá»¥ cho bÆ°á»›c phÃ¢n cá»¥m vÃ  giáº£m chiá»u sau Ä‘Ã³.

```{r}
# # Chuyá»ƒn matrix chuáº©n hÃ³a vá» data.frame
 scaled_data_df <- as.data.frame(scaled_data)
# 
# # Äáº·t láº¡i tÃªn cá»™t
colnames(scaled_data_df) <- c("MonetaryValue", "Frequency", "Recency")
# 
# # GÃ¡n láº¡i rownames náº¿u cáº§n giá»¯ index
rownames(scaled_data_df) <- rownames(non_outliers_df)
# # Xem káº¿t quáº£
head(scaled_data_df)
```
**Nháº­n xÃ©t**

- Ba cá»™t MonetaryValue, Frequency vÃ  Recency Ä‘Ã£ Ä‘Æ°á»£c chuáº©n hÃ³a vá» trung bÃ¬nh 0, phÆ°Æ¡ng sai 1 báº±ng phÆ°Æ¡ng phÃ¡p z-score.

- Sau khi chuáº©n hÃ³a:

  - Nhá»¯ng khÃ¡ch hÃ ng cÃ³ giÃ¡ trá»‹ MonetaryValue dÆ°Æ¡ng â†’ cÃ³ tá»•ng chi tiÃªu cao hÆ¡n trung bÃ¬nh.

  - Nhá»¯ng khÃ¡ch hÃ ng cÃ³ Recency lá»›n (giÃ¡ trá»‹ z lá»›n) â†’ Ä‘Ã£ lÃ¢u khÃ´ng mua hÃ ng.

  - Táº§n suáº¥t Frequency tháº¥p thÆ°á»ng cÃ³ giÃ¡ trá»‹ Ã¢m, cho tháº¥y má»©c Ä‘á»™ tÆ°Æ¡ng tÃ¡c khÃ´ng thÆ°á»ng xuyÃªn.

- Dá»¯ liá»‡u sau chuáº©n hÃ³a phÃ¹ há»£p Ä‘á»ƒ thá»±c hiá»‡n phÃ¢n cá»¥m báº±ng cÃ¡c thuáº­t toÃ¡n nhÆ° K-Means hoáº·c DBSCAN, hoáº·c dÃ¹ng cho PCA Ä‘á»ƒ giáº£m chiá»u.

<!-- # ```{r} -->
<!-- #  plot_ly(scaled_data_df, -->
<!-- #           x = ~MonetaryValue, -->
<!-- #           y = ~Frequency, -->
<!-- #           z = ~Recency, -->
<!-- #           type = "scatter3d", -->
<!-- #           mode = "markers", -->
<!-- #           marker = list(size = 2, color = 'blue')) %>% -->
<!-- #     layout(title = "3D Scatter Plot of Scaled Customer Data") -->
<!-- # ``` -->

```{r step15, echo=FALSE, fig.align='center', out.width='60%', fig.cap="3D Scatter Plot of Scaled Customer Data"}
knitr::include_graphics("images/newplot1.png")

```

**Nháº­n xÃ©t biá»ƒu Ä‘á»“ 3D Scatter Plot cá»§a dá»¯ liá»‡u RFM Ä‘Ã£ chuáº©n hÃ³a:**

Biá»ƒu Ä‘á»“ thá»ƒ hiá»‡n má»‘i quan há»‡ giá»¯a 3 chá»‰ sá»‘ sau khi chuáº©n hÃ³a:

- **MonetaryValue** (trá»¥c X â€“ chi tiÃªu)

- **Frequency** (trá»¥c Y â€“ táº§n suáº¥t mua hÃ ng)

- **Recency** (trá»¥c Z â€“ Ä‘á»™ gáº§n láº§n mua cuá»‘i)

**CÃ¡c nháº­n xÃ©t chÃ­nh:**

- **Dá»¯ liá»‡u phÃ¢n bá»‘ chá»§ yáº¿u quanh gá»‘c tá»a Ä‘á»™ (0, 0, 0):**

  - Do Ä‘Ã£ chuáº©n hÃ³a báº±ng z-score, pháº§n lá»›n khÃ¡ch hÃ ng cÃ³ cÃ¡c chá»‰ sá»‘ gáº§n vá»›i trung bÃ¬nh cá»§a toÃ n bá»™ táº­p dá»¯ liá»‡u.

- **Dá»¯ liá»‡u cÃ³ hÃ¬nh thÃ¡p dÃ y Ä‘áº·c á»Ÿ trung tÃ¢m:**

  - Chá»©ng tá» Ä‘a sá»‘ khÃ¡ch hÃ ng cÃ³ hÃ nh vi "trung bÃ¬nh" â€“ mua hÃ ng vá»›i táº§n suáº¥t, chi tiÃªu vÃ  Ä‘á»™ gáº§n á»Ÿ má»©c phá»• biáº¿n.

- **CÃ³ má»™t sá»‘ Ä‘iá»ƒm náº±m ráº£i rÃ¡c xa tÃ¢m:**

  - ÄÃ¢y cÃ³ thá»ƒ lÃ  cÃ¡c khÃ¡ch hÃ ng tiá»m nÄƒng (chi tiÃªu cao, mua gáº§n Ä‘Ã¢y) hoáº·c ngÆ°á»£c láº¡i (mua tá»« lÃ¢u, Ã­t chi tiÃªu), cáº§n Ä‘Æ°á»£c phÃ¢n cá»¥m riÃªng biá»‡t trong bÆ°á»›c tiáº¿p theo.

- **KhÃ´ng cÃ³ outlier rÃµ rÃ ng:**

  - VÃ¬ Ä‘Ã£ loáº¡i bá» ngoáº¡i lá»‡ tá»« trÆ°á»›c, biá»ƒu Ä‘á»“ khÃ´ng cÃ²n cÃ¡c Ä‘iá»ƒm quÃ¡ lá»‡ch so vá»›i cá»¥m chÃ­nh.
  
- Biá»ƒu Ä‘á»“ nÃ y cho tháº¥y dá»¯ liá»‡u Ä‘Ã£ **sáºµn sÃ ng Ä‘á»ƒ:** PhÃ¢n cá»¥m báº±ng **K-Means, DBSCAN**.


## **3.4  PhÃ¢n cá»¥m khÃ¡ch hÃ ng báº±ng thuáº­t toÃ¡n K-Means**

Thuáº­t toÃ¡n **K-Means** lÃ  má»™t trong nhá»¯ng phÆ°Æ¡ng phÃ¡p phÃ¢n cá»¥m phá»• biáº¿n, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ chia cÃ¡c khÃ¡ch hÃ ng thÃ nh cÃ¡c nhÃ³m Ä‘á»“ng nháº¥t dá»±a trÃªn Ä‘áº·c Ä‘iá»ƒm hÃ nh vi mua hÃ ng. Trong pháº§n nÃ y, chÃºng tÃ´i Ã¡p dá»¥ng thuáº­t toÃ¡n K-Means lÃªn dá»¯ liá»‡u Ä‘Ã£ chuáº©n hÃ³a tá»« mÃ´ hÃ¬nh RFM.


```{r}

# Thiáº¿t láº­p
max_k <- 15
k_values <- 2:max_k

inertia <- numeric(length(k_values))
silhouette_scores <- numeric(length(k_values))

for (i in seq_along(k_values)) {
  k <- k_values[i]
  set.seed(42)
  kmeans_model <- kmeans(scaled_data_df, centers = k, nstart = 25, iter.max = 1000)

  # inertia
  inertia[i] <- kmeans_model$tot.withinss

  # silhouette
  sil <- silhouette(kmeans_model$cluster, dist(scaled_data_df))
  silhouette_scores[i] <- mean(sil[, 3])
}

# Táº¡o dataframe cho ggplot
plot_df <- data.frame(
  k = k_values,
  Inertia = inertia,
  Silhouette = silhouette_scores
)

# Biá»ƒu Ä‘á»“ Elbow
p1 <- ggplot(plot_df, aes(x = k, y = Inertia)) +
  geom_line() +
  geom_point() +
  labs(title = "KMeans Inertia for Different Values of k",
       x = "Number of Clusters (k)", y = "Inertia") +
  theme_minimal() +
  scale_x_continuous(breaks = k_values)

# Biá»ƒu Ä‘á»“ Silhouette
p2 <- ggplot(plot_df, aes(x = k, y = Silhouette)) +
  geom_line(color = "orange") +
  geom_point(color = "orange") +
  labs(title = "Silhouette Scores for Different Values of k",
       x = "Number of Clusters (k)", y = "Silhouette Score") +
  theme_minimal() +
  scale_x_continuous(breaks = k_values)

# Hiá»ƒn thá»‹ cáº£ hai biá»ƒu Ä‘á»“ cáº¡nh nhau
grid.arrange(p1, p2, ncol = 2)

```

**Nháº­n xÃ©t:**

  - **Biá»ƒu Ä‘á»“ bÃªn trÃ¡i â€“ Elbow Method (Inertia):**
  
      * GiÃ¡ trá»‹ Inertia giáº£m máº¡nh tá»« k = 2 Ä‘áº¿n k = 4, sau Ä‘Ã³ báº¯t Ä‘áº§u giáº£m cháº­m láº¡i
      táº¡o thÃ nh má»™t â€œkhuá»·u tayâ€ táº¡i k = 4.

      * ÄÃ¢y lÃ  dáº¥u hiá»‡u rÃµ rÃ ng cá»§a sá»‘ cá»¥m tá»‘i Æ°u, vÃ¬ táº¡i Ä‘iá»ƒm nÃ y mÃ´ hÃ¬nh Ä‘Ã£ gom        Ä‘Æ°á»£c pháº§n lá»›n thÃ´ng tin phÃ¢n tÃ¡n vÃ  viá»‡c tÄƒng thÃªm cá»¥m sau Ä‘Ã³ khÃ´ng lÃ m giáº£m       Inertia Ä‘Ã¡ng ká»ƒ ná»¯a.
    
  - **Biá»ƒu Ä‘á»“ bÃªn pháº£i â€“ Silhouette Score:**
    
      * Silhouette Ä‘áº¡t giÃ¡ trá»‹ cao nháº¥t á»Ÿ k = 2 vÃ  k = 3 (~0.45), sau Ä‘Ã³ giáº£m dáº§n.

      * Tuy nhiÃªn, k = 4 váº«n duy trÃ¬ má»©c Silhouette há»£p lÃ½ (~0.40), cho tháº¥y phÃ¢n        cá»¥m váº«n Ä‘á»§ rÃµ nÃ©t mÃ  khÃ´ng quÃ¡ Ä‘Æ¡n giáº£n.

      * Viá»‡c chá»n k = 4 lÃ  sá»± cÃ¢n báº±ng giá»¯a Ä‘á»™ rÃµ rÃ ng vÃ  Ä‘á»™ chi tiáº¿t cá»§a cÃ¡c cá»¥m        khÃ¡ch hÃ ng.
      
**Káº¿t luáº­n:**

Dá»±a trÃªn cáº£ hai biá»ƒu Ä‘á»“, sá»‘ lÆ°á»£ng cá»¥m tá»‘i Æ°u Ä‘Æ°á»£c lá»±a chá»n lÃ  k = 4. ÄÃ¢y lÃ  lá»±a chá»n há»£p lÃ½ Ä‘á»ƒ tiáº¿n hÃ nh phÃ¢n cá»¥m K-Means trong bÆ°á»›c tiáº¿p theo, vá»«a Ä‘áº£m báº£o tÃ­nh phÃ¢n biá»‡t giá»¯a cÃ¡c cá»¥m, vá»«a trÃ¡nh tÃ¬nh tráº¡ng quÃ¡ phÃ¢n máº£nh hoáº·c Ä‘Æ¡n giáº£n hÃ³a mÃ´ hÃ¬nh.

```{r}
 library(scatterplot3d)  # váº½ 3D scatter

 # Huáº¥n luyá»‡n mÃ´ hÃ¬nh KMeans
 set.seed(42)
 kmeans_model <- kmeans(scaled_data_df, centers = 4, nstart = 25, iter.max = 1000)

# GÃ¡n nhÃ£n cá»¥m vÃ o non_outliers_df
 non_outliers_df$Cluster <- kmeans_model$cluster

 # MÃ u thá»§ cÃ´ng cho tá»«ng cá»¥m
 cluster_colors <- c("#1f77b4", "#ff7f0e", "#2ca02c", "#d62728")
 color_map <- cluster_colors[non_outliers_df$Cluster]

 # plot_ly(non_outliers_df,
 #         x = ~MonetaryValue,
 #         y = ~Frequency,
 #         z = ~Recency,
 #         color = ~factor(Cluster),
 #         colors = cluster_colors,
 #         type = 'scatter3d',
 #         mode = 'markers',
 #         marker = list(size = 2)) %>%
 #   layout(title = "3D Scatter Plot of Customer Data by Cluster")
```


```{r step16, echo=FALSE, fig.align='center', out.width='80%', fig.cap="3D Scatter Plot of Customer Data by Cluster"}
knitr::include_graphics("img/newplot2.png")


```
**Nháº­n xÃ©t:**

Biá»ƒu Ä‘á»“ 3D thá»ƒ hiá»‡n sá»± phÃ¢n bá»‘ cá»§a cÃ¡c khÃ¡ch hÃ ng theo 3 chiá»u **Recency**, **Frequency**, vÃ  **MonetaryValue**, Ä‘Æ°á»£c phÃ¢n cá»¥m báº±ng thuáº­t toÃ¡n K-Means vá»›i sá»‘ cá»¥m k = 4.

- NhÃ¬n chung, cÃ¡c cá»¥m Ä‘Æ°á»£c tÃ¡ch biá»‡t tÆ°Æ¡ng Ä‘á»‘i rÃµ, Ä‘áº·c biá»‡t lÃ  theo trá»¥c Monetary vÃ  Frequency.

- **Cá»¥m mÃ u Ä‘á»** (Cluster 4) táº­p trung á»Ÿ vÃ¹ng Recency cao, Frequency tháº¥p, Monetary tháº¥p -> ÄÃ¢y cÃ³ thá»ƒ lÃ  nhÃ³m khÃ¡ch hÃ ng khÃ´ng cÃ²n mua hÃ ng gáº§n Ä‘Ã¢y vÃ  giÃ¡ trá»‹ tháº¥p.

- **Cá»¥m mÃ u xanh lam** (Cluster 1) náº±m á»Ÿ Ä‘Ã¡y biá»ƒu Ä‘á»“, vá»›i Recency tháº¥p, Frequency cao vÃ  Monetary ráº¥t cao â†’ nhÃ³m khÃ¡ch hÃ ng trung thÃ nh vÃ  cÃ³ giÃ¡ trá»‹ lá»›n.

- CÃ¡c cá»¥m cÃ²n láº¡i náº±m xen giá»¯a, cho tháº¥y cÃ¡c nhÃ³m khÃ¡ch hÃ ng cÃ³ hÃ nh vi mua hÃ ng trung bÃ¬nh hoáº·c khÃ´ng Ä‘á»u Ä‘áº·n.

**Ã nghÄ©a:**

  - Viá»‡c trá»±c quan hÃ³a dá»¯ liá»‡u RFM theo khÃ´ng gian 3 chiá»u giÃºp kiá»ƒm chá»©ng láº¡i hiá»‡u   quáº£ phÃ¢n cá»¥m.

  - Doanh nghiá»‡p cÃ³ thá»ƒ dá»… dÃ ng xÃ¡c Ä‘á»‹nh nhÃ³m khÃ¡ch hÃ ng tiá»m nÄƒng Ä‘á»ƒ duy trÃ¬ vÃ    nhÃ³m khÃ´ng hiá»‡u quáº£ Ä‘á»ƒ tiáº¿t giáº£m chi phÃ­ tiáº¿p thá»‹.

  - ÄÃ¢y lÃ  bÆ°á»›c quan trá»ng trong cÃ¡c chiáº¿n lÆ°á»£c **phÃ¢n khÃºc thá»‹ trÆ°á»ng** vÃ  **giá»¯   chÃ¢n khÃ¡ch hÃ ng**.


```{r}
# Äáº£m báº£o Cluster lÃ  factor
non_outliers_df$Cluster <- as.factor(non_outliers_df$Cluster)

# Táº¡o báº£ng mÃ u tÆ°Æ¡ng á»©ng nhÆ° Python
cluster_colors <- c("0" = "#1f77b4", "1" = "#ff7f0e", "2" = "#2ca02c", "3" = "#d62728")

# Violin plot cho Recency
ggplot(non_outliers_df, aes(x = Cluster, y = Recency, fill = Cluster)) +
  geom_violin(trim = FALSE) +
  geom_boxplot(width = 0.1, color = "black", fill = "white") +
  labs(title = "Phan bo Recency theo cum", y = "Recency") +
  theme_minimal()

# Violin plot cho Frequency
ggplot(non_outliers_df, aes(x = Cluster, y = Frequency, fill = Cluster)) +
  geom_violin(trim = FALSE) +
  geom_boxplot(width = 0.1, color = "black", fill = "white") +
  labs(title = "Phan bo Frequency theo cum", y = "Frequency") +
  theme_minimal()

# TÆ°Æ¡ng tá»± cho Monetary
ggplot(non_outliers_df, aes(x = Cluster, y = MonetaryValue, fill = Cluster)) +
  geom_violin(trim = FALSE) +
  geom_boxplot(width = 0.1, color = "black", fill = "white") +
  labs(title = "Phan bo Monetary theo cum", y = "Monetary Value") +
  theme_minimal()
```

**Nháº­n xÃ©t: PhÃ¢n bá»‘ Recency**

  * Cá»¥m 1 (mÃ u Ä‘á»): CÃ³ giÃ¡ trá»‹ Recency ráº¥t tháº¥p, phÃ¢n bá»‘ táº­p trung quanh 10â€“30       ngÃ y, cho tháº¥y Ä‘Ã¢y lÃ  nhÃ³m khÃ¡ch hÃ ng vá»«a má»›i mua hÃ ng gáº§n Ä‘Ã¢y nháº¥t -> nhÃ³m
  ráº¥t tiá»m nÄƒng cáº§n Ä‘Æ°á»£c giá»¯ chÃ¢n.
      
  * Cá»¥m 2 (mÃ u xanh lÃ¡): Recency tráº£i rá»™ng tá»« tháº¥p Ä‘áº¿n khoáº£ng 100 ngÃ y, nhÆ°ng        pháº§n lá»›n táº­p trung dÆ°á»›i 50 -> nhÃ³m khÃ¡ch hÃ ng cÃ³ mua gáº§n Ä‘Ã¢y, nhÆ°ng khÃ´ng Ä‘á»u
  Ä‘áº·n báº±ng cá»¥m 1.

  * Cá»¥m 3 (mÃ u xanh dÆ°Æ¡ng): TÆ°Æ¡ng tá»± cá»¥m 1, nhÆ°ng phÃ¢n bá»‘ hÆ¡i rá»™ng hÆ¡n -> váº«n        lÃ  khÃ¡ch hÃ ng má»›i tÆ°Æ¡ng tÃ¡c gáº§n Ä‘Ã¢y, cÃ³ kháº£ nÄƒng mua láº¡i náº¿u chÄƒm sÃ³c tá»‘t.

  * Cá»¥m 4 (mÃ u tÃ­m): CÃ³ Recency ráº¥t cao, pháº§n lá»›n náº±m quanh 200â€“350 ngÃ y -> Ä‘Ã¢y      lÃ  nhÃ³m khÃ¡ch hÃ ng Ä‘Ã£ lÃ¢u khÃ´ng quay láº¡i, cÃ³ nguy cÆ¡ rá»i bá» thÆ°Æ¡ng hiá»‡u, cáº§n       cÃ³ chÃ­nh sÃ¡ch tÃ¡i tiáº¿p cáº­n hoáº·c remarketing.
      
**Ã nghÄ©a:**
  
  - Biá»ƒu Ä‘á»“ nÃ y giÃºp xÃ¡c Ä‘á»‹nh má»©c Ä‘á»™ â€œgáº§n Ä‘Ã¢yâ€ cá»§a cÃ¡c giao dá»‹ch theo tá»«ng nhÃ³m        khÃ¡ch hÃ ng. Qua Ä‘Ã³:

    * Cá»¥m 1 & 3 -> nÃªn Æ°u tiÃªn chÄƒm sÃ³c, upsell hoáº·c táº·ng Æ°u Ä‘Ã£i Ä‘áº·c biá»‡t.

    * Cá»¥m 4 -> cáº§n cÃ³ chiáº¿n dá»‹ch tÃ¡i tÆ°Æ¡ng tÃ¡c, khuyáº¿n mÃ£i â€œquay láº¡iâ€, email            marketing hoáº·c táº·ng mÃ£ giáº£m giÃ¡.

    * PhÃ¢n tÃ­ch Recency Ä‘Ã³ng vai trÃ² quan trá»ng trong viá»‡c dá»± Ä‘oÃ¡n hÃ nh vi mua         hÃ ng sáº¯p tá»›i.

**Nháº­n xÃ©t: PhÃ¢n bá»‘ Frequency:**

  * Cá»¥m 1 (mÃ u Ä‘á»): CÃ³ giÃ¡ trá»‹ Frequency cao nháº¥t trong cÃ¡c cá»¥m, pháº§n lá»›n dao Ä‘á»™ng
  tá»« 6 Ä‘áº¿n 9, tháº­m chÃ­ cÃ³ Ä‘iá»ƒm lÃªn Ä‘áº¿n 12.

  * ÄÃ¢y lÃ  nhÃ³m mua hÃ ng nhiá»u láº§n, thÆ°á»ng xuyÃªn quay láº¡i -> nhÃ³m trung thÃ nh, cÃ³
  má»©c Ä‘á»™ gáº¯n káº¿t cao vá»›i doanh nghiá»‡p.

  * Cá»¥m 2 (mÃ u xanh lÃ¡): Táº§n suáº¥t mua hÃ ng tháº¥p, háº§u háº¿t dao Ä‘á»™ng trong khoáº£ng 1
  Ä‘áº¿n 3 láº§n.

  * NhÃ³m nÃ y cÃ³ thá»ƒ lÃ  khÃ¡ch hÃ ng mua thá»­, hoáº·c chá»‰ tÆ°Æ¡ng tÃ¡c ngáº¯n háº¡n -> cáº§n Ä‘Æ°á»£c
  kÃ­ch thÃ­ch mua láº¡i.

  * Cá»¥m 3 (mÃ u xanh dÆ°Æ¡ng): CÃ³ Frequency á»Ÿ má»©c trung bÃ¬nh, phá»• biáº¿n trong khoáº£ng
  3â€“6 láº§n.

  * ÄÃ¢y lÃ  nhÃ³m tiá»m nÄƒng â€“ chÆ°a thá»±c sá»± trung thÃ nh, nhÆ°ng cÃ³ dáº¥u hiá»‡u mua láº·p láº¡i
  -> nÃªn Ä‘Æ°á»£c nuÃ´i dÆ°á»¡ng.

  * Cá»¥m 4 (mÃ u tÃ­m): CÃ³ Frequency ráº¥t tháº¥p, pháº§n lá»›n chá»‰ 1â€“2 láº§n mua.

  * Káº¿t há»£p vá»›i Recency cao (tá»« biá»ƒu Ä‘á»“ trÆ°á»›c) -> cÃ³ kháº£ nÄƒng lÃ  nhÃ³m mua má»™t láº§n
  rá»“i rá»i bá», Ã­t giÃ¡ trá»‹.
  
**Ã nghÄ©a:**

  - Biá»ƒu Ä‘á»“ giÃºp doanh nghiá»‡p dá»… dÃ ng nháº­n biáº¿t nhÃ³m khÃ¡ch nÃ o cÃ³ hÃ nh vi mua láº·p
  láº¡i cao Ä‘á»ƒ táº­p trung chÄƒm sÃ³c vÃ  giá»¯ chÃ¢n.

  - CÃ¡c cá»¥m cÃ³ Frequency tháº¥p nhÆ°ng Recency cÅ©ng tháº¥p (nhÆ° cá»¥m 2) â†’ cÃ³ thá»ƒ váº«n cÃ²n
  cÆ¡ há»™i chuyá»ƒn hÃ³a náº¿u tiáº¿p thá»‹ Ä‘Ãºng lÃºc.

  - Káº¿t há»£p phÃ¢n tÃ­ch Frequency vá»›i Recency sáº½ giÃºp xÃ¡c Ä‘á»‹nh tá»‡p khÃ¡ch hÃ ng trung
  thÃ nh vs khÃ¡ch â€œmá»™t láº§n rá»“i thÃ´iâ€, tá»« Ä‘Ã³ ra quyáº¿t Ä‘á»‹nh marketing hiá»‡u quáº£ hÆ¡n.

**Nháº­n xÃ©t: PhÃ¢n bá»‘ Monetary:**

  * Cá»¥m 1 (mÃ u Ä‘á»): ÄÃ¢y lÃ  nhÃ³m cÃ³ giÃ¡ trá»‹ Monetary cao nháº¥t, pháº§n lá»›n dao Ä‘á»™ng tá»«
  2.000 Ä‘áº¿n gáº§n 4.000.

  * ÄÃ¢y cháº¯c cháº¯n lÃ  nhÃ³m khÃ¡ch hÃ ng cÃ³ giÃ¡ trá»‹ lá»›n nháº¥t, thÆ°á»ng xuyÃªn chi tiÃªu
  cao, Ä‘Ã³ng gÃ³p nhiá»u cho doanh thu -> nhÃ³m VIP hoáº·c khÃ¡ch hÃ ng trung thÃ nh nháº¥t.

  * Cá»¥m 2 (mÃ u xanh lÃ¡): Monetary ráº¥t tháº¥p, pháº§n lá»›n chá»‰ á»Ÿ má»©c 200 â€“ 600.

  * ÄÃ¢y cÃ³ thá»ƒ lÃ  nhÃ³m khÃ¡ch Ã­t mua vÃ  mua vá»›i giÃ¡ trá»‹ tháº¥p, cÃ³ thá»ƒ lÃ  khÃ¡ch vÃ£ng
  lai hoáº·c má»›i mua thá»­.

  * Cá»¥m 3 (mÃ u xanh dÆ°Æ¡ng): CÃ³ má»©c chi tiÃªu á»Ÿ má»©c trung bÃ¬nh khÃ¡, tráº£i rá»™ng tá»«
  khoáº£ng 800 â€“ 2500, má»™t sá»‘ Ä‘iá»ƒm cÃ²n lÃªn cao hÆ¡n.

  * ÄÃ¢y lÃ  nhÃ³m khÃ¡ch cÃ³ tiá»m nÄƒng, náº¿u Ä‘Æ°á»£c thÃºc Ä‘áº©y Ä‘Ãºng cÃ¡ch cÃ³ thá»ƒ chuyá»ƒn hÃ³a
  thÃ nh khÃ¡ch hÃ ng trung thÃ nh.

  * Cá»¥m 4 (mÃ u tÃ­m):
  CÃ³ giÃ¡ trá»‹ Monetary tháº¥p nháº¥t trong táº¥t cáº£ cÃ¡c cá»¥m, pháº§n lá»›n dao Ä‘á»™ng tá»« dÆ°á»›i 500
  Ä‘áº¿n khoáº£ng 800.

  * Káº¿t há»£p vá»›i Recency cao vÃ  Frequency tháº¥p -> nhÃ³m Ä‘Ã£ lÃ¢u khÃ´ng quay láº¡i, mua
  Ã­t, khÃ´ng thu lá»£i cao.
  
**Ã nghÄ©a:**

  - Biá»ƒu Ä‘á»“ Monetary giÃºp doanh nghiá»‡p xÃ¡c Ä‘á»‹nh giÃ¡ trá»‹ tÃ i chÃ­nh cá»§a tá»«ng nhÃ³m
  khÃ¡ch hÃ ng.
  
  - Cá»¥m 1 nÃªn Ä‘Æ°á»£c xem lÃ  tá»‡p khÃ¡ch hÃ ng Æ°u tiÃªn cao nháº¥t, cÃ³ thá»ƒ Ã¡p dá»¥ng chiáº¿n
  lÆ°á»£c chÄƒm sÃ³c Ä‘áº·c biá»‡t nhÆ° VIP member, tháº» tÃ­ch Ä‘iá»ƒm, quÃ  táº·ng cÃ¡ nhÃ¢n,...

  - Cá»¥m 3 lÃ  nhÃ³m cÃ³ kháº£ nÄƒng phÃ¡t triá»ƒn, náº¿u Ä‘Æ°á»£c tiáº¿p thá»‹ vÃ  chÄƒm sÃ³c há»£p lÃ½.

  - cá»¥m 4 nÃªn Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ láº¡i chi phÃ­ giá»¯ chÃ¢n Ä‘á»ƒ trÃ¡nh lÃ£ng phÃ­ nguá»“n lá»±c.

**Káº¿t luáº­n:**

Sau khi phÃ¢n tÃ­ch trá»±c quan tá»«ng thÃ nh pháº§n cá»§a mÃ´ hÃ¬nh RFM theo tá»«ng cá»¥m khÃ¡ch hÃ ng, cÃ³ thá»ƒ rÃºt ra cÃ¡c nháº­n Ä‘á»‹nh quan trá»ng nhÆ° sau:

- Cá»¥m 1 (mÃ u Ä‘á»):
  * ÄÃ¢y lÃ  nhÃ³m khÃ¡ch hÃ ng tá»‘t nháº¥t:

  * Mua gáº§n Ä‘Ã¢y (Recency tháº¥p),

  * Mua nhiá»u láº§n (Frequency cao),

  * Chi tiÃªu lá»›n (Monetary cao).
  
-> ÄÃ¢y lÃ  nhÃ³m khÃ¡ch hÃ ng trung thÃ nh, cÃ³ giÃ¡ trá»‹ cao, cáº§n Ä‘Æ°á»£c Æ°u tiÃªn chÄƒm sÃ³c, giá»¯ chÃ¢n vÃ  táº¡o cÃ¡c chÆ°Æ¡ng trÃ¬nh khuyáº¿n khÃ­ch tÃ¡i mua.

- Cá»¥m 2 (mÃ u xanh lÃ¡):

  * CÃ³ táº§n suáº¥t mua tháº¥p, giÃ¡ trá»‹ Ä‘Æ¡n hÃ ng nhá» vÃ  thá»i gian mua gáº§n Ä‘Ã¢y tÆ°Æ¡ng Ä‘á»‘i
  á»•n.
  
-> NhÃ³m má»›i báº¯t Ä‘áº§u tÆ°Æ¡ng tÃ¡c hoáº·c khÃ¡ch hÃ ng mua thá»­. Doanh nghiá»‡p cÃ³ thá»ƒ táº­p trung nuÃ´i dÆ°á»¡ng nhÃ³m nÃ y báº±ng chÆ°Æ¡ng trÃ¬nh chÄƒm sÃ³c khuyáº¿n mÃ£i, Æ°u Ä‘Ã£i.

- Cá»¥m 3 (mÃ u xanh dÆ°Æ¡ng):

  * Mua khÃ´ng quÃ¡ thÆ°á»ng xuyÃªn nhÆ°ng cÃ³ chi tiÃªu trung bÃ¬nh khÃ¡ vÃ  mua tÆ°Æ¡ng Ä‘á»‘i
  gáº§n Ä‘Ã¢y.
  
-> LÃ  nhÃ³m khÃ¡ch hÃ ng tiá»m nÄƒng, cÃ³ thá»ƒ trá»Ÿ thÃ nh trung thÃ nh náº¿u Ä‘Æ°á»£c chÄƒm sÃ³c vÃ  cÃ³ cÃ¡c chiáº¿n lÆ°á»£c tiáº¿p thá»‹ phÃ¹ há»£p.

- Cá»¥m 4 (mÃ u tÃ­m):

  * Giao dá»‹ch Ä‘Ã£ lÃ¢u (Recency cao), táº§n suáº¥t mua ráº¥t tháº¥p vÃ  giÃ¡ trá»‹ chi tiÃªu nhá».
  
-> ÄÃ¢y lÃ  nhÃ³m khÃ¡ch hÃ ng khÃ´ng hoáº¡t Ä‘á»™ng, cÃ³ thá»ƒ Ä‘Ã£ rá»i bá» thÆ°Æ¡ng hiá»‡u. Cáº§n xem xÃ©t chiáº¿n lÆ°á»£c tiáº¿p cáº­n láº¡i hoáº·c loáº¡i khá»i cÃ¡c chiáº¿n dá»‹ch Æ°u tiÃªn Ä‘á»ƒ tiáº¿t kiá»‡m nguá»“n lá»±c.

```{r}
table(non_outliers_df$Cluster) #Sá»‘ lÆ°á»£ng khÃ¡ch hÃ ng tá»«ng cá»¥m
```

```{r}
# TÃ¬m chá»‰ sá»‘ giao nhau giá»¯a 2 táº­p outliers
overlap_indices <- intersect(rownames(monetary_outliers_df), rownames(frequency_outliers_df))

# Táº¡o táº­p chá»‰ lÃ  Monetary outliers
monetary_only_outliers <- monetary_outliers_df[!rownames(monetary_outliers_df) %in% overlap_indices, ]
monetary_only_outliers$Cluster <- -1

# Táº¡o táº­p chá»‰ lÃ  Frequency outliers
frequency_only_outliers <- frequency_outliers_df[!rownames(frequency_outliers_df) %in% overlap_indices, ]
frequency_only_outliers$Cluster <- -2

# Táº¡o táº­p lÃ  outliers cá»§a cáº£ hai
monetary_and_frequency_outliers <- monetary_outliers_df[rownames(monetary_outliers_df) %in% overlap_indices, ]
monetary_and_frequency_outliers$Cluster <- -3

# Gá»™p táº¥t cáº£ láº¡i
outlier_clusters_df <- rbind(
  monetary_only_outliers,
  frequency_only_outliers,
  monetary_and_frequency_outliers
)

# Káº¿t quáº£
head(outlier_clusters_df)

```

```{r}
# Kiá»ƒm tra
table(outlier_clusters_df$Cluster)
```


```{r}
# Chuyá»ƒn Cluster thÃ nh factor Ä‘á»ƒ dá»… gÃ¡n mÃ u
outlier_clusters_df$Cluster <- factor(outlier_clusters_df$Cluster)

# Táº¡o báº£ng mÃ u tÆ°Æ¡ng Ä‘Æ°Æ¡ng cluster_colors
cluster_colors <- c("-1" = "#9467bd", "-2" = "#8c564b", "-3" = "#e377c2")

# Violin plot: MonetaryValue
ggplot(outlier_clusters_df, aes(x = Cluster, y = MonetaryValue, fill = Cluster)) +
  geom_violin(trim = FALSE) +
  scale_fill_manual(values = cluster_colors) +
  labs(title = "Monetary Value by Cluster", y = "Monetary Value") +
  theme_minimal()

# Violin plot: Frequency
ggplot(outlier_clusters_df, aes(x = Cluster, y = Frequency, fill = Cluster)) +
  geom_violin(trim = FALSE) +
  scale_fill_manual(values = cluster_colors) +
  labs(title = "Frequency by Cluster", y = "Frequency") +
  theme_minimal()

# Violin plot: Recency
ggplot(outlier_clusters_df, aes(x = Cluster, y = Recency, fill = Cluster)) +
  geom_violin(trim = FALSE) +
  scale_fill_manual(values = cluster_colors) +
  labs(title = "Recency by Cluster", y = "Recency") +
  theme_minimal()

```
**Nháº­n xÃ©t: Recency cá»§a cÃ¡c nhÃ³m Outliers:**

  - Cáº£ hai cá»¥m Ä‘á»u cÃ³ giÃ¡ trá»‹ Recency tháº¥p, tá»©c lÃ  pháº§n lá»›n khÃ¡ch hÃ ng trong hai
  nhÃ³m nÃ y mua hÃ ng gáº§n Ä‘Ã¢y, thÆ°á»ng xuyÃªn quay láº¡i trong thá»i gian gáº§n phÃ¢n tÃ­ch
  (Recency ~ 0â€“50 ngÃ y lÃ  phá»• biáº¿n).

  - Cluster -3: Recency phÃ¢n bá»‘ cá»±c tháº¥p vÃ  nghiÃªng vá» phÃ­a 0 -> nhá»¯ng khÃ¡ch hÃ ng
  gáº§n nhÆ° vá»«a má»›i mua hÃ ng, káº¿t há»£p vá»›i táº§n suáº¥t cao vÃ  chi tiÃªu lá»›n -> Ä‘Ã¢y lÃ  tá»‡p
  khÃ¡ch hÃ ng siÃªu trung thÃ nh.

  - Cluster -1: CÅ©ng cÃ³ Recency khÃ¡ tháº¥p, nhÆ°ng phÃ¢n bá»‘ dÃ n rá»™ng hÆ¡n má»™t chÃºt ->
  má»™t sá»‘ khÃ¡ch tuy chi nhiá»u nhÆ°ng cÃ³ thá»ƒ Ä‘Ã£ khÃ´ng mua trong thá»i gian dÃ i.

**Ã nghÄ©a:**

  - Cluster -3: HoÃ n háº£o cho chÆ°Æ¡ng trÃ¬nh tri Ã¢n VIP hiá»‡n táº¡i.

  - Cluster -1: NÃªn Ä‘Æ°á»£c tiáº¿p cáº­n báº±ng chiáº¿n dá»‹ch kÃªu gá»i quay láº¡i nhÆ° Æ°u Ä‘Ã£i cho
  Ä‘Æ¡n hÃ ng tiáº¿p theo, voucher náº¿u mua láº¡i trong 7 ngÃ y,â€¦
  
**Nháº­n xÃ©t: Frequency cá»§a cÃ¡c nhÃ³m Outliers:**

  - Cluster -3: PhÃ¢n bá»‘ Frequency ráº¥t rá»™ng, cÃ³ nhiá»u Ä‘iá»ƒm lÃªn tá»›i trÃªn 200 lÆ°á»£t
  mua, pháº§n lá»›n táº­p trung tá»« 10â€“50 láº§n giao dá»‹ch.

  - ÄÃ¢y lÃ  nhÃ³m mua nhiá»u â€“ ráº¥t thÆ°á»ng xuyÃªn, káº¿t há»£p vá»›i giÃ¡ trá»‹ chi tiÃªu cao -> thá»ƒ hiá»‡n Ä‘áº·c trÆ°ng cá»§a khÃ¡ch hÃ ng trung thÃ nh lÃ¢u nÄƒm hoáº·c doanh nghiá»‡p mua sá»‰ Ä‘á»‹nh ká»³.

  - Cluster -1: Frequency tháº¥p hÆ¡n Ä‘Ã¡ng ká»ƒ, háº§u háº¿t khÃ¡ch hÃ ng chá»‰ mua khoáº£ng 5â€“20
  láº§n, ráº¥t Ã­t trÆ°á»ng há»£p vÆ°á»£t qua 50.

  - NhÃ³m nÃ y khÃ´ng mua thÆ°á»ng xuyÃªn, nhÆ°ng má»—i láº§n mua cÃ³ giÃ¡ trá»‹ cao -> kháº£ nÄƒng lÃ  khÃ¡ch mua Ã­t nhÆ°ng sáº£n pháº©m cÃ³ giÃ¡ trá»‹ lá»›n vÃ­ dá»¥: khÃ¡ch doanh nghiá»‡p, quÃ  táº·ng,...

**Ã nghÄ©a:**

  - Cluster -3 lÃ  nhÃ³m cá»±c ká»³ quan trá»ng Ä‘á»ƒ duy trÃ¬ lÃ¢u dÃ i. CÃ³ thá»ƒ Ã¡p dá»¥ng cÃ¡c chÆ°Æ¡ng trÃ¬nh nhÆ°:

    * Æ¯u Ä‘Ã£i theo cáº¥p báº­c (tÃ­ch Ä‘iá»ƒm)

    * Táº·ng thÃªm sáº£n pháº©m

    * Æ¯u tiÃªn há»— trá»£

  - Cluster -1 cÃ³ thá»ƒ kÃ­ch hoáº¡t tÄƒng táº§n suáº¥t mua báº±ng:

    * Gá»£i Ã½ sáº£n pháº©m liÃªn quan

    * Æ¯u Ä‘Ã£i cho Ä‘Æ¡n tiáº¿p theo trong thá»i gian ngáº¯n

    * Æ¯u Ä‘Ã£i combo/quÃ  táº·ng khi mua láº¡i trong 30 ngÃ y

**Nháº­n xÃ©t: Monetary cá»§a cÃ¡c nhÃ³m Outliers:**

  - Cáº£ hai cá»¥m Ä‘á»u cÃ³ Monetary Value ráº¥t cao, vá»›i má»™t sá»‘ khÃ¡ch hÃ ng tháº­m chÃ­ chi
  tiÃªu lÃªn tá»›i trÃªn 200.000 Ä‘Æ¡n vá»‹ tiá»n tá»‡ â€“ Ä‘Ã¢y lÃ  nhá»¯ng ngoáº¡i lá»‡ thá»±c sá»± trong
  táº­p khÃ¡ch hÃ ng.

  - Cluster -3:

    * Máº­t Ä‘á»™ phÃ¢n bá»‘ rá»™ng vÃ  dÃ y hÆ¡n quanh má»©c tá»« 0 Ä‘áº¿n 20.000, cho tháº¥y nhÃ³m nÃ y
    cÃ³ giÃ¡ trá»‹ Ä‘Æ¡n hÃ ng cao.

    * DÃ¹ cÃ³ nhiá»u Ä‘iá»ƒm outlier máº¡nh, nhÆ°ng pháº§n lá»›n khÃ¡ch váº«n táº­p trung á»Ÿ khoáº£ng tá»«
    5.000â€“10.000.

  - Cluster -1:

    * PhÃ¢n bá»‘ háº¹p hÆ¡n má»™t chÃºt so vá»›i cluster -3, nhÆ°ng váº«n cÃ³ má»™t vÃ i khÃ¡ch chi
    tiÃªu ráº¥t lá»›n.

    * Äáº·c trÆ°ng lÃ  mua Ã­t láº§n nhÆ°ng má»—i láº§n chi cá»±c nhiá»u (vÃ­ dá»¥ doanh nghiá»‡p,...).
    
**Ã nghÄ©a:**

  - Cluster -3: ÄÃ¢y lÃ  khÃ¡ch hÃ ng vÃ ng, ráº¥t trung thÃ nh vÃ  cÃ³ giÃ¡ trá»‹ lÃ¢u dÃ i ->
  xá»©ng Ä‘Ã¡ng nháº­n cÃ¡c Æ°u Ä‘Ã£i Ä‘áº·c biá»‡t.

  - Cluster -1: DÃ¹ khÃ´ng thÆ°á»ng xuyÃªn mua nhÆ°ng má»—i láº§n mua láº¡i chi tiÃªu cá»±c lá»›n ->
  nÃªn cÃ³ cÃ¡c chiáº¿n lÆ°á»£c khuyáº¿n khÃ­ch mua Ä‘á»‹nh ká»³, Æ°u Ä‘Ã£i Ä‘áº·c biá»‡t theo má»—i Ä‘Æ¡n lá»›n.

**Káº¿t luáº­n:**

Dá»±a trÃªn ba biá»ƒu Ä‘á»“ phÃ¢n tÃ­ch Recency â€“ Frequency â€“ Monetary Value, cÃ³ thá»ƒ Ä‘Æ°a ra káº¿t luáº­n sau:

  - Cluster -3 (cÃ³ cáº£ Outliers theo Monetary vÃ  Frequency cao):
  
    * LÃ  nhÃ³m khÃ¡ch hÃ ng vá»«a chi tiÃªu lá»›n, vá»«a mua thÆ°á»ng xuyÃªn, vÃ  pháº§n lá»›n Ä‘á»u cÃ³     Recency tháº¥p (mua gáº§n Ä‘Ã¢y).

    * CÃ³ giÃ¡ trá»‹ vÆ°á»£t trá»™i rÃµ rá»‡t trong cáº£ ba chiá»u -> nhÃ³m khÃ¡ch hÃ ng VIP,
    Ä‘Ã³ng vai trÃ² ráº¥t quan trá»ng vá»›i doanh thu.

  - Cluster -1 (chá»‰ outlier theo Monetary):
  
    * NhÃ³m khÃ¡ch hÃ ng mua khÃ´ng nhiá»u láº§n, nhÆ°ng má»—i láº§n Ä‘á»u chi ráº¥t máº¡nh tay.

    * Recency cÃ³ thá»ƒ khÃ´ng quÃ¡ tháº¥p -> má»™t sá»‘ khÃ¡ch Ä‘Ã£ lÃ¢u khÃ´ng quay láº¡i, cáº§n
    chiáº¿n lÆ°á»£c phÃ¹ há»£p.

    * PhÃ¹ há»£p vá»›i cÃ¡c chÆ°Æ¡ng trÃ¬nh Æ°u Ä‘Ã£i Ä‘Æ¡n hÃ ng lá»›n, táº·ng voucher cho láº§n mua
    tiáº¿p theo, hoáº·c chÄƒm sÃ³c cÃ¡ nhÃ¢n hoÃ¡ theo giÃ¡ trá»‹ giao dá»‹ch.


```{r}
# Táº¡o vector gÃ¡n nhÃ£n cluster
cluster_labels <- c(
  "0" = "RETAIN",       # Giá»¯ chÃ¢n khÃ¡ch hÃ ng hiá»‡n táº¡i
  "1" = "RE-ENGAGE",    # TÆ°Æ¡ng tÃ¡c láº¡i vá»›i khÃ¡ch hÃ ng Ä‘Ã£ rá»i Ä‘i
  "2" = "NURTURE",      # ChÄƒm sÃ³c khÃ¡ch hÃ ng tiá»m nÄƒng
  "3" = "REWARD",       # ThÆ°á»Ÿng cho khÃ¡ch hÃ ng trung thÃ nh
  "4" = "EXPLORE",      # NhÃ³m khÃ¡ch hÃ ng chÆ°a cÃ³ hÃ nh vi ná»•i báº­t rÃµ rÃ ng
  "-1" = "PAMPER",      # Chiá»u chuá»™ng khÃ¡ch hÃ ng VIP
  "-2" = "UPSELL",      # Äá» xuáº¥t mua thÃªm
  "-3" = "DELIGHT"      # Tráº£i nghiá»‡m xuáº¥t sáº¯c
)
```

```{r}
# Gá»™p 2 dataframe láº¡i theo hÃ ng (giá»‘ng pd.concat)
full_clustering_df <- rbind(non_outliers_df, outlier_clusters_df)
full_clustering_df$ClusterLabel <- cluster_labels[as.character(full_clustering_df$Cluster)]
# Xem káº¿t quáº£
head(full_clustering_df)

```

```{r}
# Kiá»ƒm tra sá»‘ hÃ ng
nrow(full_clustering_df)

# Kiá»ƒm tra cÃ¡c nhÃ³m trong Cluster
table(full_clustering_df$Cluster)

# Kiá»ƒm tra náº¿u cÃ³ cá»™t ClusterLabel Ä‘Ã£ gÃ¡n
table(full_clustering_df$ClusterLabel)

```

```{r}
# GÃ¡n nhÃ£n cá»¥m báº±ng named vector cluster_labels
full_clustering_df$ClusterLabel <- cluster_labels[as.character(full_clustering_df$Cluster)]

# Xem ngáº«u nhiÃªn 10 dÃ²ng
full_clustering_df[sample(nrow(full_clustering_df), 10), ]

```

```{r}
# TÃ­nh sá»‘ lÆ°á»£ng khÃ¡ch má»—i cá»¥m
cluster_counts <- full_clustering_df %>%
  count(ClusterLabel, name = "CustomerCount")
```

```{r}
# TÃ­nh trung bÃ¬nh cÃ¡c biáº¿n
feature_means <- full_clustering_df %>%
  mutate(MonetaryValuePer100 = MonetaryValue / 100) %>%
  group_by(ClusterLabel) %>%
  summarise(
    Recency = mean(Recency, na.rm = TRUE),
    Frequency = mean(Frequency, na.rm = TRUE),
    `MonetaryValue per 100` = mean(MonetaryValuePer100, na.rm = TRUE)
  ) %>%
  pivot_longer(cols = c("Recency", "Frequency", "MonetaryValue per 100"),
               names_to = "Feature", values_to = "MeanValue")
```

```{r}
# Merge láº¡i vÃ  sáº¯p xáº¿p giáº£m dáº§n theo CustomerCount
plot_df <- left_join(feature_means, cluster_counts, by = "ClusterLabel") %>%
  mutate(ClusterLabel = factor(ClusterLabel, levels = cluster_counts %>%
                                 arrange(desc(CustomerCount)) %>%
                                 pull(ClusterLabel)))
```

```{r}
# Váº½ biá»ƒu Ä‘á»“ káº¿t há»£p
library(viridis)
plot_df$Feature <- factor(plot_df$Feature, levels = c("Recency", "Frequency", "MonetaryValue per 100"))

ggplot(plot_df, aes(x = ClusterLabel)) +
  # Biá»ƒu Ä‘á»“ cá»™t sá»‘ lÆ°á»£ng KH vá»›i viridis
  geom_col(aes(y = CustomerCount, fill = ClusterLabel), width = 0.6) +
  scale_fill_viridis(discrete = TRUE, option = "D") +
  scale_y_continuous(
    name = "Number of Customers",
    sec.axis = sec_axis(~., name = "Average Feature Values")
  ) +
  # Biá»ƒu Ä‘á»“ Ä‘Æ°á»ng trung bÃ¬nh cÃ¡c feature
  geom_line(aes(y = MeanValue, color = Feature, group = Feature), size = 1.2) +
  geom_point(aes(y = MeanValue, color = Feature), size = 2) +
  labs(
    title = "Cluster Distribution with Average Feature Values",
    x = "Cluster Label"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    axis.title.y.left = element_text(color = "black"),
    axis.title.y.right = element_text(color = "darkgreen"),
    legend.title = element_blank()
  )
```

**Nháº­n xÃ©t: NhÃ³m NURTURE:**

  - Sá»‘ lÆ°á»£ng nhiá»u nháº¥t (~5000), Recency cao, Frequency tháº¥p, Monetary tháº¥p

**Ã nghÄ©a:**

  - NhÃ³m khÃ¡ch lÃ¢u khÃ´ng quay láº¡i, Ã­t mua vÃ  chi Ã­t â†’ cáº§n chiáº¿n dá»‹ch khuyáº¿n mÃ£i
  quay láº¡i, kÃ­ch hoáº¡t láº¡i tá»‡p ngá»§ quÃªn.

**Nháº­n xÃ©t: NhÃ³m EXPLORE:**

  - Recency trung bÃ¬nh, Frequency tÄƒng nháº¹, Monetary tÄƒng
  
**Ã nghÄ©a:**

  - NhÃ³m Ä‘ang cÃ³ dáº¥u hiá»‡u báº¯t Ä‘áº§u mua láº¡i, cáº§n Ä‘Æ°á»£c thá»­ nghiá»‡m Æ°u Ä‘Ã£i vÃ  khuyáº¿n
  khÃ­ch Ä‘á»ƒ nÃ¢ng cáº¥p hÃ nh vi mua.

**Nháº­n xÃ©t: NhÃ³m REWARD:**

  - Recency tháº¥p, Frequency cao, Monetary tÄƒng rÃµ

**Ã nghÄ©a:**

  - NhÃ³m cÃ³ hÃ nh vi tá»‘t dáº§n lÃªn -> cÃ³ thá»ƒ táº·ng thÃªm voucher, Æ°u Ä‘Ã£i,...
  
**Nháº­n xÃ©t: NhÃ³m RE-ENGAGE:** 

  - Recency cao, nhÆ°ng Frequency vÃ  Monetary trÆ°á»›c Ä‘Ã³ cao	
  
**Ã nghÄ©a:**

  - NhÃ³m tá»«ng tá»‘t, nay Ä‘Ã£ rá»i bá» -> Ä‘áº·c biá»‡t quan trá»ng Ä‘á»ƒ thu hÃºt trá»Ÿ láº¡i

**Nháº­n xÃ©t: NhÃ³m DELIGHT:**

  - Recency tháº¥p, Frequency á»•n, Monetary cao	

**Ã nghÄ©a:**

  - NhÃ³m Ä‘ang cÃ³ tráº£i nghiá»‡m ráº¥t tá»‘t, cÃ³ thá»ƒ biáº¿n thÃ nh khÃ¡ch trung thÃ nh
  VIP náº¿u cÃ³ chiáº¿n lÆ°á»£c phÃ¹ há»£p.
  
**Nháº­n xÃ©t: NhÃ³m PAMPER :**  

  - Recency tháº¥p nháº¥t, Frequency ráº¥t tháº¥p, Monetary cao nháº¥t	

**Ã nghÄ©a:**

  - NhÃ³m Ã­t mua nhÆ°ng chi ráº¥t máº¡nh tay má»—i láº§n mua -> cáº§n dá»‹ch vá»¥ chÄƒm sÃ³c cÃ¡ nhÃ¢n hÃ³a, quÃ  táº·ng Ä‘áº·c biá»‡t,...





## **3.5  PhÃ¢n cá»¥m khÃ¡ch hÃ ng báº±ng thuáº­t toÃ¡n DBSCAN**

Thuáº­t toÃ¡n **DBSCAN (Density-Based Spatial Clustering of Applications with Noise)** lÃ  má»™t phÆ°Æ¡ng phÃ¡p phÃ¢n cá»¥m dá»±a trÃªn máº­t Ä‘á»™ Ä‘iá»ƒm dá»¯ liá»‡u, cÃ³ kháº£ nÄƒng xÃ¡c Ä‘á»‹nh cÃ¡c cá»¥m cÃ³ hÃ¬nh dáº¡ng báº¥t ká»³ vÃ  xá»­ lÃ½ tá»‘t cÃ¡c Ä‘iá»ƒm nhiá»…u (outliers). ÄÃ¢y lÃ  má»™t phÆ°Æ¡ng phÃ¡p phÃ¹ há»£p khi dá»¯ liá»‡u cÃ³ phÃ¢n bá»‘ khÃ´ng Ä‘á»“ng Ä‘á»u vÃ  khÃ´ng thá»ƒ xÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng cá»¥m tá»« trÆ°á»›c


```{r message=FALSE, warning=FALSE, fig.cap="Äá»“ thá»‹ xÃ¡c Ä‘á»‹nh Eps xá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p k-distance graph"}
# CÃ i Ä‘áº·t vÃ  náº¡p cÃ¡c gÃ³i cáº§n thiáº¿t
library(dbscan)  # Cho thuáº­t toÃ¡n DBSCAN
library(factoextra)  # Cho trá»±c quan hÃ³a
library(fpc)  # Cho Ä‘Ã¡nh giÃ¡ phÃ¢n cá»¥m
library(ggplot2)  # Cho váº½ biá»ƒu Ä‘á»“
library(cluster)  # Cho hÃ m silhouette


scaled_data_DB <- scale(non_outliers_df[, c("MonetaryValue", "Frequency", "Recency")])

# TÃ­nh khoáº£ng cÃ¡ch k-nearest neighbors
k=3
knn_dists <- kNNdist(scaled_data_DB, k = k)

# Sáº¯p xáº¿p khoáº£ng cÃ¡ch vÃ  váº½ Ä‘á»“ thá»‹
eps_candidates <- sort(knn_dists)
plot(eps_candidates, type = "l", 
     xlab = "Diem du lieu (da sap xep)",
     ylab = paste("Khoang cach den diem thu", k, "gan nhat"),
     main = "Phuong phap k-distance")

# TÃ¬m vá»‹ trÃ­ cá»§a Ä‘iá»ƒm gáº©y thá»§ cÃ´ng (khoáº£ng 0.5)
eps_value <- 0.4
eps_index <- which.min(abs(eps_candidates - eps_value))

# ÄÃ¡nh dáº¥u Ä‘iá»ƒm gáº©y
points(eps_index, eps_candidates[eps_index], col = "red", pch = 19)
text(eps_index, eps_candidates[eps_index], 
     labels = paste("Îµ â‰ˆ", round(eps_candidates[eps_index], 2)), 
     pos = 4, col = "red")

# Váº½ Ä‘Æ°á»ng tháº³ng táº¡i Ä‘iá»ƒm gáº©y (thá»§ cÃ´ng á»Ÿ má»©c 0.5)
abline(h = eps_value, col = "red", lty = 2)
```

Nháº­n xÃ©t:

- Biá»ƒu Ä‘á»“ thá»ƒ hiá»‡n khoáº£ng cÃ¡ch Ä‘áº¿n Ä‘iá»ƒm thá»© k gáº§n nháº¥t (á»Ÿ Ä‘Ã¢y lÃ  k = 3) Ä‘Ã£ Ä‘Æ°á»£c **sáº¯p xáº¿p tÄƒng dáº§n.**

- **HÃ¬nh dáº¡ng biá»ƒu Ä‘á»“ cÃ³ â€œgÃ³c gÃ£yâ€ rÃµ rÃ ng**, xuáº¥t hiá»‡n khoáº£ng sau Ä‘iá»ƒm thá»© 3000 trÃªn trá»¥c x.

- **Má»©c ngÆ°á»¡ng epsilon = 0.4** Ä‘Æ°á»£c chá»n khÃ¡ há»£p lÃ½, vÃ¬ náº±m gáº§n vá»‹ trÃ­ báº¯t Ä‘áº§u cÃ³ sá»± tÄƒng vá»t vá» khoáº£ng cÃ¡ch **Ä‘Ã¢y lÃ  Ä‘iá»ƒm gÃ£y** giÃºp phÃ¢n tÃ¡ch rÃµ rÃ ng giá»¯a vÃ¹ng lÃµi (dense region) vÃ  vÃ¹ng nhiá»…u (noise).

- **ÄÆ°á»ng ngang mÃ u Ä‘á»** Ä‘Ã¡nh dáº¥u ngÆ°á»¡ng eps = 0.4, há»— trá»£ xÃ¡c Ä‘á»‹nh sá»‘ lÆ°á»£ng hÃ ng xÃ³m cáº§n thiáº¿t Ä‘á»ƒ má»Ÿ rá»™ng cá»¥m.

```{r}
# Ãp dá»¥ng DBSCAN vá»›i tham sá»‘ phÃ¹ há»£p
db_result <- dbscan(scaled_data_DB, eps = 0.4, MinPts = 4)
non_noise <- which(db_result$cluster > 0)

# Náº¿u sá»‘ lÆ°á»£ng cá»¥m há»£p lá»‡ > 1 thÃ¬ má»›i tÃ­nh Silhouette
if (length(unique(db_result$cluster[non_noise])) > 1) {
  
  # TÃ­nh silhouette
  sil <- silhouette(db_result$cluster[non_noise], dist(scaled_data_DB[non_noise, ]))
  
  # TÃ­nh Ä‘iá»ƒm silhouette trung bÃ¬nh toÃ n bá»™
  avg_sil <- mean(sil[, 3], na.rm = TRUE)
  cat("Äiem Silhouette trung binh:", avg_sil, "\n")
  
  # Táº¡o dataframe tá»« silhouette object
  sil_df <- as.data.frame(sil)
  
  # TÃ­nh Silhouette trung bÃ¬nh theo tá»«ng cá»¥m
  avg_sil_by_cluster <- sil_df %>%
    group_by(cluster) %>%
    summarise(avg_sil_width = mean(sil_width))
  
  # Váº½ biá»ƒu Ä‘á»“ cá»™t
  dev.new(width = 10, height = 8)
  ggplot(avg_sil_by_cluster, aes(x = factor(cluster), y = avg_sil_width)) +
    geom_col(fill = "steelblue") +
    labs(title = "Silhouette Score theo tung cum",
         x = "Cum",
         y = "Silhouette Score trong tung cum") +
    theme_minimal()
  
} else {
  cat("Khong du so cum de tinh Silhouette Score.\n")
}
```
Nháº­n xÃ©t:

- **GiÃ¡ trá»‹ Silhouette trung bÃ¬nh tháº¥p (~0.05)** cho tháº¥y cáº¥u trÃºc cá»¥m khÃ´ng rÃµ rÃ ng. CÃ¡c khÃ¡ch hÃ ng trong cÃ¹ng má»™t cá»¥m chÆ°a thá»±c sá»± tÆ°Æ¡ng Ä‘á»“ng, vÃ  ranh giá»›i giá»¯a cÃ¡c cá»¥m chÆ°a tÃ¡ch biá»‡t tá»‘t.

- Má»™t sá»‘ cá»¥m nhÆ° **cá»¥m sá»‘ 6 vÃ  8** cÃ³ **Silhouette Ã¢m**, Ä‘iá»u nÃ y cho tháº¥y cÃ¡c Ä‘iá»ƒm trong nhá»¯ng cá»¥m nÃ y cÃ³ thá»ƒ bá»‹ gÃ¡n nháº§m â€“ chÃºng gáº§n cá»¥m khÃ¡c hÆ¡n cá»¥m mÃ  chÃºng Ä‘ang náº±m trong.

- NgÆ°á»£c láº¡i, cá»¥m sá»‘ 11 cÃ³ Silhouette khÃ¡ cao (~0.24), cho tháº¥y Ä‘Ã¢y lÃ  má»™t cá»¥m khÃ¡ "cháº·t cháº½", cÃ³ cáº¥u trÃºc rÃµ rÃ ng vÃ  Ä‘Æ°á»£c tÃ¡ch biá»‡t tá»‘t khá»i cÃ¡c cá»¥m cÃ²n láº¡i.

```{r}
# TÃ­nh tá»· lá»‡ nhiá»…u
noise_ratio <- sum(db_result$cluster == 0) / length(db_result$cluster)
cat("Ty le nhieu:", noise_ratio, "\n")
```

- **GiÃ¡ trá»‹ tá»· lá»‡ nhiá»…u** lÃ : 0.02096816 (tÆ°Æ¡ng Ä‘Æ°Æ¡ng khoáº£ng 2.10%).

- Äiá»u nÃ y cÃ³ nghÄ©a lÃ  chá»‰ khoáº£ng 2% dá»¯ liá»‡u bá»‹ DBSCAN gÃ¡n lÃ  nhiá»…u (outlier)  tá»©c lÃ  khÃ´ng thuá»™c báº¥t ká»³ cá»¥m nÃ o.

```{r echo = FALSE}
noise_count <- sum(db_result$cluster == 0)
clustered_count <- sum(db_result$cluster != 0)

# Dá»¯ liá»‡u cho biá»ƒu Ä‘á»“ trÃ²n
pie_data <- data.frame(
  category = c("Nhieu", "Phan cum"),
  count = c(noise_count, clustered_count)
)

# Táº£i thÆ° viá»‡n ggplot2 náº¿u chÆ°a cÃ³
library(ggplot2)

# Váº½ biá»ƒu Ä‘á»“ trÃ²n
ggplot(pie_data, aes(x = "", y = count, fill = category)) +
  geom_bar(stat = "identity", width = 1, color = "white") +
  coord_polar("y", start = 0) +
  labs(title = "Ti le nhieu trong ket qua phan cum DBSCAN") +
  theme_void() +
  scale_fill_manual(values = c("Nhieu" = "lightpink", "Phan cum" = "lightblue"))
```

**Nháº­n xÃ©t biá»ƒu Ä‘á»“ trÃ²n: Tá»· lá»‡ nhiá»…u trong káº¿t quáº£ phÃ¢n cá»¥m DBSCAN**

- Biá»ƒu Ä‘á»“ trÃ²n trÃªn thá»ƒ hiá»‡n sá»± phÃ¢n chia giá»¯a:

  - Äiá»ƒm nhiá»…u (Nhiá»…u - mÃ u há»“ng nháº¡t)

  - Äiá»ƒm thuá»™c cá»¥m (PhÃ¢n cá»¥m - mÃ u xanh nháº¡t)

**Nháº­n xÃ©t:**

- **Tá»· lá»‡ nhiá»…u cá»±c tháº¥p**, chiáº¿m má»™t pháº§n ráº¥t nhá» trong tá»•ng thá»ƒ dá»¯ liá»‡u.

- Háº§u háº¿t cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u Ä‘á»u Ä‘Æ°á»£c **DBSCAN gÃ¡n vÃ o má»™t cá»¥m cá»¥ thá»ƒ**, chá»©ng tá»:

  - MÃ´ hÃ¬nh Ä‘Ã£ **phÃ¢n cá»¥m tá»‘t**, khÃ´ng bá»‹ bá» sÃ³t dá»¯ liá»‡u Ä‘Ã¡ng ká»ƒ.

  - CÃ¡c thÃ´ng sá»‘ `eps = 0.4` vÃ  `MinPts = 4` lÃ  phÃ¹ há»£p vá»›i phÃ¢n bá»‘ dá»¯ liá»‡u hiá»‡n táº¡i.

```{r}
# TÃ­nh Calinski-Harabasz Index (chá»‰ cho cÃ¡c Ä‘iá»ƒm khÃ´ng pháº£i nhiá»…u)
if (length(unique(db_result$cluster[non_noise])) > 1) {
  ch_index <- calinhara(scaled_data[non_noise, ], 
                        db_result$cluster[non_noise])
  cat("Calinski-Harabasz Index:", ch_index, "\n")
} else {
  cat("Khong the tinh CH Index: chi tim thay 1 cum (khong tinh nhieu)\n")
}
```

**Nháº­n xÃ©t chá»‰ sá»‘ Calinski-Harabasz (CH Index) trong DBSCAN**

- **GiÃ¡ trá»‹ Calinski-Harabasz Index** Ä‘o Ä‘Æ°á»£c lÃ  593.7985.

- Chá»‰ sá»‘ nÃ y Ä‘Æ°á»£c tÃ­nh **trÃªn cÃ¡c Ä‘iá»ƒm khÃ´ng bá»‹ Ä‘Ã¡nh dáº¥u lÃ  nhiá»…u** trong káº¿t quáº£ DBSCAN.

**Ã nghÄ©a cá»§a CH Index:**

- **CH Index cÃ ng cao â†’ cÃ¡c cá»¥m cÃ ng rÃµ rÃ ng vÃ  tÃ¡ch biá»‡t tá»‘t** vá»›i nhau.

- Vá»›i giÃ¡ trá»‹ ~593.8, Ä‘Ã¢y lÃ  má»™t **chá»‰ sá»‘ khÃ¡ cao**, cho tháº¥y:

  - **DBSCAN Ä‘Ã£ phÃ¢n cá»¥m hiá»‡u quáº£,** cÃ¡c cá»¥m Ä‘Æ°á»£c táº¡o ra cÃ³ sá»± phÃ¢n tÃ¡ch tá»‘t.

  - **Äá»™ cháº·t trong cá»¥m cao vÃ  khoáº£ng cÃ¡ch giá»¯a cÃ¡c cá»¥m lá»›n ** Ä‘iá»u nÃ y ráº¥t tá»‘t trong bá»‘i cáº£nh phÃ¢n tÃ­ch hÃ nh vi khÃ¡ch hÃ ng.

```{r}
library(umap)
# Giáº£m chiá»u báº±ng UMAP
set.seed(42)  # Giá»¯ káº¿t quáº£ á»•n Ä‘á»‹nh
umap_result <- umap(scaled_data_DB)

# Táº¡o dataframe 2D tá»« káº¿t quáº£ UMAP
umap_df <- as.data.frame(umap_result$layout)
colnames(umap_df) <- c("UMAP1", "UMAP2")

# GÃ¡n nhÃ£n cá»¥m tá»« DBSCAN (náº¿u cÃ³)
umap_df$cluster <- factor(db_result$cluster)  # Báº¡n Ä‘Ã£ cháº¡y db_result á»Ÿ bÆ°á»›c trÆ°á»›c rá»“i

# Váº½ biá»ƒu Ä‘á»“ trá»±c quan cá»¥m
ggplot(umap_df, aes(x = UMAP1, y = UMAP2, color = cluster)) +
  geom_point(alpha = 0.7, size = 2) +
  labs(title = "Truc quan hoa phan cum DBSCAN bang UMAP",
       x = "UMAP1", y = "UMAP2") +
  scale_color_brewer(palette = "Set1") +
  theme_minimal()
```

 **Nháº­n xÃ©t biá»ƒu Ä‘á»“ UMAP trá»±c quan hÃ³a phÃ¢n cá»¥m DBSCAN**
 
- DBSCAN Ä‘Ã£ phÃ¢n chia táº­p dá»¯ liá»‡u thÃ nh **nhiá»u cá»¥m riÃªng biá»‡t **(tá»« 0 Ä‘áº¿n 10).

- Dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c giáº£m chiá»u báº±ng **UMAP** Ä‘á»ƒ trá»±c quan hÃ³a trÃªn máº·t pháº³ng 2D.

- Má»—i cá»¥m cÃ³ mÃ u sáº¯c riÃªng biá»‡t giÃºp dá»… nháº­n biáº¿

**Nháº­n xÃ©t chi tiáº¿t:**

- **PhÃ¢n tÃ¡ch cá»¥m rÃµ rÃ ng:**

  - Biá»ƒu Ä‘á»“ cho tháº¥y cÃ¡c cá»¥m Ä‘Æ°á»£c phÃ¢n tÃ¡ch khÃ¡ rÃµ, khÃ´ng chá»“ng láº¥n nhau quÃ¡ nhiá»u.

  - Äiá»u nÃ y kháº³ng Ä‘á»‹nh ráº±ng DBSCAN hoáº¡t Ä‘á»™ng hiá»‡u quáº£ khi Ä‘Æ°á»£c Ã¡p dá»¥ng lÃªn dá»¯ liá»‡u Ä‘Ã£ chuáº©n hÃ³a vÃ  giáº£m chiá»u.

- **Cá»¥m nhiá»…u (Cluster 0):**

  - NhÃ³m mÃ u Ä‘á» (cluster 0) lÃ  cÃ¡c Ä‘iá»ƒm bá»‹ coi lÃ  nhiá»…u (khÃ´ng thuá»™c báº¥t ká»³ cá»¥m nÃ o).

  - Sá»‘ lÆ°á»£ng Ä‘iá»ƒm nhiá»…u nhá», phÃ¹ há»£p vá»›i tá»· lá»‡ Ä‘Ã£ tÃ­nh trÆ°á»›c Ä‘Ã³ (~2%).

- **Cáº£nh bÃ¡o palette Set1:**

  - CÃ³ thÃ´ng bÃ¡o ráº±ng DBSCAN Ä‘Ã£ táº¡o ra hÆ¡n 9 cá»¥m, nhÆ°ng palette = "Set1" trong ggplot2 chá»‰ há»— trá»£ tá»‘i Ä‘a 9 mÃ u.

  - Do Ä‘Ã³ cÃ³ thá»ƒ má»™t vÃ i cá»¥m bá»‹ trÃ¹ng mÃ u â†’ cáº§n Ä‘á»•i sang palette lá»›n hÆ¡n nhÆ° "Paired", "Dark2" hoáº·c scale_color_manual().

- **Cáº£nh bÃ¡o loáº¡i bá» Ä‘iá»ƒm:**

  - `geom_point()` Ä‘Ã£ loáº¡i bá» 124 dÃ²ng chá»©a giÃ¡ trá»‹ thiáº¿u hoáº·c náº±m ngoÃ i vÃ¹ng hiá»ƒn thá»‹ â†’ cÃ³ thá»ƒ do UMAP sinh ra giÃ¡ trá»‹ ngoáº¡i lai.

  - Äiá»u nÃ y khÃ´ng áº£nh hÆ°á»Ÿng quÃ¡ nhiá»u Ä‘áº¿n cháº¥t lÆ°á»£ng phÃ¢n cá»¥m.

## **3.6  So sÃ¡nh káº¿Ìt quáº£ phÃ¢n cÌ£um K-Means vÃ  DDBSCAN**

Trong má»¥c nÃ y, chÃºng tÃ´i tiáº¿n hÃ nh so sÃ¡nh hai thuáº­t toÃ¡n K-Means vÃ  DBSCAN Ä‘Æ°á»£c Ã¡p dá»¥ng trÃªn cÃ¹ng táº­p dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½ vÃ  chuáº©n hÃ³a tá»« phÃ¢n tÃ­ch RFM.

**1. Sá»‘ lÆ°á»£ng cá»¥m**

- **K-Means:** yÃªu cáº§u chá»‰ Ä‘á»‹nh sá»‘ cá»¥m trÆ°á»›c. Dá»±a vÃ o phÆ°Æ¡ng phÃ¡p Elbow vÃ  chá»‰ sá»‘ Silhouette, sá»‘ cá»¥m tá»‘i Æ°u Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh lÃ  4 cá»¥m.
khÃ´ng yÃªu cáº§u sá»‘ cá»¥m Ä‘áº§u vÃ o mÃ  dá»±a trÃªn máº­t Ä‘á»™ Ä‘iá»ƒm vÃ  hai tham sá»‘ eps, minPts. Káº¿t quáº£ phÃ¢n cá»¥m thu Ä‘Æ°á»£c 11 cá»¥m, trong Ä‘Ã³ bao gá»“m cáº£ cá»¥m nhiá»…u (noise.

**2. ÄÃ¡nh giÃ¡ cháº¥t lÆ°á»£ng cá»¥m**


| Chá»‰ sá»‘               | K-Means | DBSCAN        |
|----------------------|---------|---------------|
| Silhouette trung bÃ¬nh | ~0.40   | ~0.05         |
| CH Index             | KhÃ´ng tÃ­nh | 593.8      |
| Tá»· lá»‡ nhiá»…u          | KhÃ´ng cÃ³ | 2.1% (0.02096)|


- **Silhouette:** K-Means Ä‘áº¡t giÃ¡ trá»‹ cao hÆ¡n Ä‘Ã¡ng ká»ƒ, cho tháº¥y cÃ¡c cá»¥m Ä‘Æ°á»£c táº¡o ra cÃ³ Ä‘á»™ phÃ¢n tÃ¡ch rÃµ rÃ ng hÆ¡n.

- **CH Index:** DBSCAN cho tháº¥y cá»¥m phÃ¢n chia khÃ¡ rÃµ vá» máº·t khÃ´ng gian, máº·c dÃ¹ Silhouette tháº¥p do cÃ³ nhiá»u cá»¥m nhá» hoáº·c nhiá»…u.

- **Tá»· lá»‡ nhiá»…u:** DBSCAN cÃ³ thá»ƒ phÃ¡t hiá»‡n Ä‘iá»ƒm nhiá»…u (~2.1%), trong khi K-Means khÃ´ng cÃ³ cÆ¡ cháº¿ xá»­ lÃ½ nhiá»…u.

**3. Äáº·c Ä‘iá»ƒm cá»¥m vÃ  tÃ­nh linh hoáº¡t**

  - **K-Means** hoáº¡t Ä‘á»™ng tá»‘t khi dá»¯ liá»‡u phÃ¢n bá»‘ Ä‘á»u, cá»¥m cÃ³ hÃ¬nh cáº§u vÃ  kÃ­ch thÆ°á»›c tÆ°Æ¡ng Ä‘Æ°Æ¡ng. Tuy nhiÃªn, dá»… bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi outliers vÃ  khÃ³ xá»­ lÃ½ dá»¯ liá»‡u phÃ¢n bá»‘ phá»©c táº¡p.

- **DBSCAN** phÃ¹ há»£p vá»›i dá»¯ liá»‡u cÃ³ cáº¥u trÃºc phá»©c táº¡p, cá»¥m cÃ³ hÃ¬nh dáº¡ng báº¥t ká»³. Äá»“ng thá»i phÃ¡t hiá»‡n Ä‘Æ°á»£c outlier. Tuy nhiÃªn, viá»‡c chá»n eps phÃ¹ há»£p khÃ¡ nháº¡y cáº£m vÃ  áº£nh hÆ°á»Ÿng lá»›n Ä‘áº¿n káº¿t quáº£.


**4. Hiá»ƒn thá»‹ káº¿t quáº£ trá»±c quan**
Cáº£ hai thuáº­t toÃ¡n Ä‘á»u Ä‘Æ°á»£c trá»±c quan hÃ³a báº±ng:

  - **Biá»ƒu Ä‘á»“ 3D Scatter Plot** vá»›i 3 trá»¥c: Monetary, Frequency vÃ  Recency.

  - **Biá»ƒu Ä‘á»“ UMAP 2D** Ä‘á»ƒ quan sÃ¡t cáº¥u trÃºc dá»¯ liá»‡u sau khi giáº£m chiá»u.

**DBSCAN xuáº¥t hiá»‡n cáº£nh bÃ¡o khi sá»‘ cá»¥m lá»›n hÆ¡n 9 vá»›i palette** `Set1`, cÃ³ thá»ƒ Ä‘iá»u chá»‰nh báº±ng palette khÃ¡c nhÆ° "Dark2" Ä‘á»ƒ trá»±c quan hÆ¡n.


**5. Tá»•ng káº¿t**


| TiÃªu chÃ­                                     | K-Means               | DBSCAN                                             |
|---------------------------------------------|------------------------|----------------------------------------------------|
| Dá»¯ liá»‡u rÃµ rÃ ng, Ã­t nhiá»…u                   |  Ráº¥t phÃ¹ há»£p         | CÃ³ thá»ƒ gÃ¢y nhiá»…u giáº£ do nháº¡y cáº£m vá»›i `eps`     |
| Cáº§n phÃ¡t hiá»‡n hÃ nh vi báº¥t thÆ°á»ng           | KhÃ´ng há»— trá»£        |  PhÃ¡t hiá»‡n nhiá»…u ráº¥t tá»‘t                         |
| Cáº§n Ä‘áº·t nhÃ£n cá»¥m rÃµ rÃ ng cho marketing     | Dá»… phÃ¢n loáº¡i         |  NhÃ£n khÃ´ng Ä‘á»u, khÃ³ Ä‘á»‹nh nghÄ©a cá»¥m nhá»         |
| Dá»… triá»ƒn khai vÃ  mÃ´ táº£                     |  Dá»… hiá»ƒu, phá»• biáº¿n    |  Cáº§n chá»n `eps` phÃ¹ há»£p, khÃ³ tÃ¡i hiá»‡n            |
| Kháº£ nÄƒng má»Ÿ rá»™ng vá»›i dá»¯ liá»‡u lá»›n           |  Cao                 |  Giá»›i háº¡n náº¿u dá»¯ liá»‡u quÃ¡ phÃ¢n máº£nh             |


**Khuyáº¿n nghá»‹ Ã¡p dá»¥ng**

- **Sá»­ dá»¥ng K-Means** náº¿u má»¥c tiÃªu lÃ  phÃ¢n nhÃ³m khÃ¡ch hÃ ng theo hÃ nh vi mua hÃ ng cá»¥ thá»ƒ Ä‘á»ƒ thá»±c hiá»‡n cÃ¡c chiáº¿n dá»‹ch chÄƒm sÃ³c, giá»¯ chÃ¢n vÃ  Æ°u Ä‘Ã£i phÃ¹ há»£p.

- **Sá»­ dá»¥ng DBSCAN** náº¿u bÃ i toÃ¡n yÃªu cáº§u phÃ¡t hiá»‡n khÃ¡ch hÃ ng báº¥t thÆ°á»ng, khÃ´ng cÃ³ hÃ nh vi mua rÃµ rÃ ng hoáº·c kiá»ƒm tra dá»¯ liá»‡u nhiá»…u.

# **CHÆ¯Æ NG 4: Káº¾T LUáº¬N VÃ€ KIáº¾N NGHá»Š**

## **4.1 Káº¿t luáº­n**

Trong bÃ¡o cÃ¡o nÃ y, chÃºng tÃ´i Ä‘Ã£ tiáº¿n hÃ nh phÃ¢n khÃºc khÃ¡ch hÃ ng dá»±a trÃªn mÃ´ hÃ¬nh RFM (Recency - Frequency - Monetary) káº¿t há»£p vá»›i cÃ¡c thuáº­t toÃ¡n phÃ¢n cá»¥m K-Means vÃ  DBSCAN. Sau quÃ¡ trÃ¬nh tiá»n xá»­ lÃ½, lÃ m sáº¡ch dá»¯ liá»‡u vÃ  giáº£m chiá»u dá»¯ liá»‡u báº±ng PCA, cÃ¡c mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c Ã¡p dá»¥ng thÃ nh cÃ´ng Ä‘á»ƒ xÃ¡c Ä‘á»‹nh cÃ¡c nhÃ³m khÃ¡ch hÃ ng cÃ³ hÃ nh vi mua sáº¯m tÆ°Æ¡ng Ä‘á»“ng.

Káº¿t quáº£ cho tháº¥y:

- **MÃ´ hÃ¬nh K-Means** cho káº¿t quáº£ phÃ¢n cá»¥m rÃµ rÃ ng, Ä‘áº·c biá»‡t khi sá»­ dá»¥ng sá»‘ cá»¥m Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi phÆ°Æ¡ng phÃ¡p Elbow vÃ  Ä‘Ã¡nh giÃ¡ qua Silhouette Score. CÃ¡c cá»¥m phÃ¢n biá»‡t rÃµ rÃ ng vá» Ä‘áº·c Ä‘iá»ƒm chi tiÃªu, táº§n suáº¥t vÃ  thá»i gian mua hÃ ng gáº§n nháº¥t.

- **MÃ´ hÃ¬nh DBSCAN** sau khi Ã¡p dá»¥ng giáº£m chiá»u báº±ng UMAP, cÅ©ng phÃ¢n cá»¥m Ä‘Æ°á»£c dá»¯ liá»‡u nhÆ°ng cÃ³ xu hÆ°á»›ng táº¡o ra Ã­t cá»¥m hÆ¡n vÃ  má»™t pháº§n dá»¯ liá»‡u bá»‹ xem lÃ  nhiá»…u (noise). Tuy nhiÃªn, DBSCAN cÃ³ Æ°u Ä‘iá»ƒm lÃ  khÃ´ng cáº§n xÃ¡c Ä‘á»‹nh sá»‘ cá»¥m tá»« trÆ°á»›c vÃ  phÃ¡t hiá»‡n Ä‘Æ°á»£c cÃ¡c Ä‘iá»ƒm ngoáº¡i lá»‡.

Tá»•ng thá»ƒ, cáº£ hai mÃ´ hÃ¬nh Ä‘á»u cho tháº¥y hiá»‡u quáº£ trong viá»‡c phÃ¢n nhÃ³m khÃ¡ch hÃ ng. MÃ´ hÃ¬nh K-Means tá» ra phÃ¹ há»£p hÆ¡n trong trÆ°á»ng há»£p dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c chuáº©n hÃ³a vÃ  khÃ´ng chá»©a quÃ¡ nhiá»u nhiá»…u, trong khi DBSCAN cÃ³ thá»ƒ Ã¡p dá»¥ng tá»‘t vá»›i dá»¯ liá»‡u cÃ³ hÃ¬nh dáº¡ng phÃ¢n bá»‘ phá»©c táº¡p.

##  **4.2 Kiáº¿n nghá»‹**

Tá»« káº¿t quáº£ phÃ¢n cá»¥m, chÃºng tÃ´i Ä‘á» xuáº¥t má»™t sá»‘ chiáº¿n lÆ°á»£c tiáº¿p thá»‹ nhÆ° sau:

- **KhÃ¡ch hÃ ng cÃ³ R cao, F tháº¥p, M tháº¥p:** NhÃ³m khÃ¡ch hÃ ng má»›i hoáº·c khÃ´ng thÆ°á»ng xuyÃªn. Cáº§n Ä‘Æ°á»£c tiáº¿p cáº­n qua cÃ¡c chÆ°Æ¡ng trÃ¬nh khuyáº¿n mÃ£i hoáº·c giá»›i thiá»‡u sáº£n pháº©m má»›i Ä‘á»ƒ tÄƒng táº§n suáº¥t mua sáº¯m.

- **KhÃ¡ch hÃ ng cÃ³ F vÃ  M cao, R tháº¥p:** NhÃ³m khÃ¡ch hÃ ng trung thÃ nh vÃ  cÃ³ giÃ¡ trá»‹ cao. NÃªn cÃ³ cÃ¡c chÆ°Æ¡ng trÃ¬nh tri Ã¢n, Æ°u Ä‘Ã£i Ä‘áº·c biá»‡t Ä‘á»ƒ giá»¯ chÃ¢n nhÃ³m nÃ y.

- **KhÃ¡ch hÃ ng cÃ³ R cao, F vÃ  M tháº¥p:** NhÃ³m khÃ¡ch hÃ ng Ä‘ang cÃ³ dáº¥u hiá»‡u rá»i bá». Doanh nghiá»‡p nÃªn cÃ¢n nháº¯c cÃ¡c chÆ°Æ¡ng trÃ¬nh kÃ­ch hoáº¡t láº¡i khÃ¡ch hÃ ng cÅ© nhÆ° gá»­i email nháº¯c nhá»Ÿ hoáº·c mÃ£ giáº£m giÃ¡ quay láº¡i.

- NgoÃ i ra, cÃ¡c Ä‘iá»ƒm nhiá»…u Ä‘Æ°á»£c DBSCAN xÃ¡c Ä‘á»‹nh cÃ³ thá»ƒ lÃ  khÃ¡ch hÃ ng ngoáº¡i lá»‡, nÃªn Ä‘Æ°á»£c xem xÃ©t ká»¹ lÆ°á»¡ng Ä‘á»ƒ loáº¡i bá» hoáº·c phÃ¢n tÃ­ch riÃªng biá»‡t nháº±m hiá»ƒu rÃµ hÆ¡n hÃ nh vi báº¥t thÆ°á»ng.











# References














